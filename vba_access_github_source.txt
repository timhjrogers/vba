
Attribute VB_Name = "xbutton01"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub button01()
xto = "XZXZXZ@XZXZXZ.com"
xcc = "XZXZXZ@XZXZXZ.com"
xbody = "XZXZXZ@XZXZXZ.com"
xbody = [Forms].[XZXZXZ_HRdBase]![Name]
xbody = Forms!XZXZXZ_HRdBase!name
xsubject = "XZXZXZ@XZXZXZ.com"
Call access2outlook(xto, xcc, xbody, xsubject)
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function access2outlook(xto, xcc, xbody, xsubject)
outlook from excel
Dim olApp As Outlook.Application
Dim olMail As MailItem
Dim CurrFile As String
Set olApp = New Outlook.Application
Set olMail = olApp.CreateItem(olMailItem)
ActiveWorkbook.Save
CurrFile = ActiveWorkbook.Path & "\" & ActiveWorkbook.Name
With olMail
.To = xto
.CC = xcc
.Subject = xsubject
.Body = xbody
.Attachments.Add CurrFile
.Attachments.Add "c:\My Documents\book.doc"
.Display '.Send
End With
Set olMail = Nothing
Set olApp = Nothing
End Function
Attribute VB_Name = "button_adddate"
Option Compare Database
Private Sub Commandxx_Click()
screen.activeForm.recordset.fields(myFieldname).value
Screen.ActiveForm.Controls(myControl).Value
Screen.ActiveForm.name
value = Forms![NameOfForm]![NameOfTextbox]
x = Forms![NameOfForm]![NameOfTextbox]
x = Forms![workstreamstabs]![Memo]
x = Me.Memo.Value
x = InputBox(x, x, x)
XDATE = Format(Now, "ddd dd/mmm/yy")
Me.Memo.Value = XDATE & vbCrLf & x
End Sub
Attribute VB_Name = "Confluencex"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub Confluence()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
newline = vbCrLf & "<br/>"
tx = tx & vbCrLf & "<html><head><style>"
tx = tx & vbCrLf & "BODY { color: BLACK; margin-left: 300px; margin-right: 300px; text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "table { border-collapse: collapse; border: 1px solid black;}"
tx = tx & vbCrLf & "</style></head><body>"
tx = tx & "<a name=TOC>Contents</a>"
tx = tx & sub_routine_header
X = X & newline
X = X & newline
arr = array_part("part1")
X = X & arr(1)
xi = xi & arr(2)
X = X & newline & confuence_table("people")
X = X & newline & "<a href=#TOC>Go Top</a>"
X = X & sub_routine_gap '##########################################################
arr = array_part("part2")
X = X & arr(1)
xi = xi & arr(2)
X = X & newline & confuence_blog("webpages")
X = X & newline & "<a href=#TOC>Go Top</a>"
X = X & sub_routine_gap '##########################################################
arr = array_part("part3")
X = X & arr(1)
xi = xi & arr(2)
X = X & newline & confuence_report("people")
X = X & newline & "<a href=#TOC>Go Top</a>"
X = X & sub_routine_gap '##########################################################
arr = array_part("part4")
X = X & arr(1)
xi = xi & arr(2)
X = X & newline & confuence_report("webpages")
X = X & newline & "<a href=#TOC>Go Top</a>"
X = X & sub_routine_gap '##########################################################
##############################
composite_text = tx & xi & X
##############################
XDATE = Format(Now, "DDD-DD-MMM-YYYY")
fname = CurrentProject.path & "\PROJECT_SKY_CONFLUENCE_" & XDATE & ".html"
Call PRINT_INFO(composite_text, fname)
ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub test1()
arr = array_partx("part1", "part2")
Debug.Print arr(1)
Debug.Print arr(2)
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub test2()
arr = array_part("part1")
Debug.Print arr(1)
Debug.Print arr(2)
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function array_partx(part1, part2)
Dim arraytest(10)
arraytest(1) = part1 & "newtext"
arraytest(2) = part2 & "newtext"
array_part = arraytest
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function array_part(part1)
Dim arraytest(10)
arraytest(1) = "<a name=" & part1 & ">" & part1 & "</a>"
arraytest(2) = "<a href=#" & part1 & ">" & part1 & "</a> | "
array_part = arraytest
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function sub_routine_header()
X = " <h1> Welcome to XZXZXZ </h1>"
sub_routine_header = X
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function sub_routine_gap()
For q = 1 To 100
        X = X & "<br/> " & vbCrLf
        Next
        sub_routine_gap = X
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function RAG(X)
If InStr(1, UCase(X), "#GREY") Then RAG = UCase("<b style='background-color:  #669999;'>" & X & "</b>")
        If InStr(1, UCase(X), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & X & "</b>")
                If InStr(1, UCase(X), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & X & "</b>")
                        If InStr(1, UCase(X), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & X & "</b>")
                                
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function confuence_report(xsql1)
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
newline = vbCrLf & "<br/>"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
rs1.MoveFirst
For X = 0 To rs1.Fields.Count - 1
        Debug.Print X, rs1.Fields(X).name, rs1.Fields(X).Value
Next X
Do While Not rs1.EOF
        For X = 0 To rs1.Fields.Count - 1
                xtext = xtext & newline & UCase(rs1.Fields(X).name) & ": " & rs1.Fields(X).Value
                
        Next X
        xtext = xtext & newline
        
        rs1.MoveNext
        Loop
        rs1.Close
        Set rs1 = Nothing
        db.Close
        Set db = Nothing
        confuence_report = xtext
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function confuence_blog(xsql1)
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
newline = vbCrLf & "<br/>"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
rs1.MoveFirst
For X = 0 To rs1.Fields.Count - 1
        Debug.Print X, rs1.Fields(X).name, rs1.Fields(X).Value
Next X
Do While Not rs1.EOF
        For X = 0 To rs1.Fields.Count - 1
                If Not IsNull(rs1.Fields(X).Value) Then
                        xcontent = Replace(rs1.Fields(X).Value, vbCrLf, "<br/>")
                        xtext = xtext & newline & xcontent
                End If
                
        Next X
        xtext = xtext & newline
        
        rs1.MoveNext
        Loop
        rs1.Close
        Set rs1 = Nothing
        db.Close
        Set db = Nothing
        confuence_blog = xtext
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function confuence_table(xsql1)
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
newline = vbCrLf & "<br/>"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
rs1.MoveFirst
For X = 0 To rs1.Fields.Count - 1
        Debug.Print X, rs1.Fields(X).name, rs1.Fields(X).Value
Next X
xtext = xtext & "<table border>"
xtext = xtext & "<tr>"
For X = 0 To rs1.Fields.Count - 1
        xtext = xtext & "<td>" & UCase(rs1.Fields(X).name) & "</td> "
Next X
xtext = xtext & "</tr>"
xtext = xtext & "<tr>"
Do While Not rs1.EOF
        For X = 0 To rs1.Fields.Count - 1
                xtext = xtext & "<td>" & UCase(rs1.Fields(X).Value) & "</td> "
        Next X
        xtext = xtext & "</tr>"
        
        rs1.MoveNext
        Loop
        
        xtext = xtext & "</table>"
        
        rs1.Close
        Set rs1 = Nothing
        db.Close
        Set db = Nothing
        confuence_table = xtext
End Function
Attribute VB_Name = "db_backup"
Option Compare Database
Public Function db_backup()
Dim sourceFile As String, destinationFile As String
Dim aFSO As Variant
Dim path As String, name As String
sourceFile = CurrentProject.FullName
path = CurrentProject.path
name = CurrentProject.name
xname_without_suffix = Left(name, Len(name) - 6)
xtime = xf(Hour(Now)) & xf(Minute(Now)) '& xf(Second(Now))
xdate = Year(Now) & "" & Format(Month(Now), "00") & "" & Format(Day(Now), "00")
destinationFile = path & "\" & xname_without_suffix & "_bkup" & xdate & "-" & xtime & ".accdb"
Debug.Print path
this removes a file created on the same day
If Dir(destinationFile) <> "" Then
        Kill destinationFile
End If
this creates a backup into destination path
If Dir(destinationFile) = "" Then
        
        Set aFSO = CreateObject("Scripting.FileSystemObject")
        aFSO.CopyFile sourceFile, destinationFile, True
        
        MsgBox "A database backup has been stored under " & destinationFile
        
        x = destinationFile
        x = InputBox(x, x, x)
End If
End Function
Attribute VB_Name = "db_backup"
Option Compare Database
Public Function db_backup()
Dim sourceFile As String, destinationFile As String
Dim aFSO As Variant
Dim path As String, name As String
sourceFile = CurrentProject.FullName
path = CurrentProject.path
name = CurrentProject.name
xname_without_suffix = Left(name, Len(name) - 6)
xtime = xf(Hour(Now)) & xf(Minute(Now)) '& xf(Second(Now))
XDATE = Year(Now) & "" & Format(Month(Now), "00") & "" & Format(Day(Now), "00")
destinationFile = path & "\" & xname_without_suffix & "_bkup" & XDATE & "-" & xtime & ".accdb"
Debug.Print path
this removes a file created on the same day
If Dir(destinationFile) <> "" Then
        Kill destinationFile
End If
this creates a backup into destination path
If Dir(destinationFile) = "" Then
        
        Set aFSO = CreateObject("Scripting.FileSystemObject")
        aFSO.CopyFile sourceFile, destinationFile, True
        
        MsgBox "A database backup has been stored under " & destinationFile
        
        x = destinationFile
        x = InputBox(x, x, x)
End If
End Function
Attribute VB_Name = "dowhile_deliver"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_loop()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "deliverables"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        
        xtext = rs1!ShortName
        
        If InStr(1, xtext, "Legal") Then
                
                rs1.Edit
                ' rs1!STATUS = "#GREY"
                rs1!PHASE = "P2-Aquisition"
                rs1.Update
                
        End If
        
        
        rs1.MoveNext
        Loop
        
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "dowhile_deliver"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_loop()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "deliverables"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        
        xtext = rs1!ShortName
        
        If InStr(1, xtext, "Legal") Then
                
                rs1.Edit
                ' rs1!STATUS = "#GREY"
                rs1!PHASE = "P2-Aquisition"
                rs1.Update
                
        End If
        
        
        rs1.MoveNext
        Loop
        
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "dowhile_update"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_loop2017()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "eventcalendar"
xsql1 = "WORKSTREAMS"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
xtext = rs1!Actions
Do While Not rs1.EOF
        X = X + 1
        
        rs1.Edit
        
        'rs1!info3 = svgadata
        'rs1!Image = svgadata
        
        rs1!Actions = xtext
        
        rs1.Update
        
        
        rs1.MoveNext
        Loop
        
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "dowhile_ws"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_loop2017()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "workstreams"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        If IsNull(rs1!Memo) Then
                skip
                Else
                xtext = rs1!Memo
                xtext = Replace(xtext, vbCrLf, "//")
                
                rs1.Edit
                rs1!Memo = xtext
                
                rs1.Update
        End If
        
        
        rs1.MoveNext
        Loop
        
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "dowhile_ws"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_loop2017()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "workstreams"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        If IsNull(rs1!Memo) Then
                skip
                Else
                xtext = rs1!Memo
                xtext = Replace(xtext, vbCrLf, "//")
                
                rs1.Edit
                rs1!Memo = xtext
                
                rs1.Update
        End If
        
        
        rs1.MoveNext
        Loop
        
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "GETTABLE_2HTMLmod"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub test01()
TABLENAME = "HTML_DELIVERABLES"
FIRSTCOLUMNMATCH = "Legal&Contracts"
x = GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
Debug.Print x
xtext = x
FNAME = CurrentProject.path & "\TEMP.html"
Call PRINT_INFO(xtext, FNAME)
ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = TABLENAME
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "" '"<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
rs1.MoveFirst
xtext = xtext & "<TABLE BORDER=2 WIDTH=900>"
############################### table headers
xtext = xtext & "<tr>"
For x = 0 To rs1.Fields.Count - 1
        xtext = xtext & "<TD VALIGN=TOP><b>"
        xtext = xtext & xnewline & UCase(rs1.Fields(x).name)
        xtext = xtext & "</b></TD>"
Next x
xtext = xtext & "</tr>"
######################################### table details
Do While Not rs1.EOF
        
        xtext = xtext & xnewline
        If rs1.Fields(0).Value = FIRSTCOLUMNMATCH Then
                xtext = xtext & "<tr>"
                
                
                For x = 0 To rs1.Fields.Count - 1
                        xtext = xtext & "<TD VALIGN=TOP>"
                        If InStr(1, rs1.Fields(x).Value, "#") Then
                                xtext = xtext & xnewline & RAG(rs1.Fields(x).Value)
                                Else
                                
                                xtext = xtext & xnewline & (rs1.Fields(x).Value)
                        End If
                        xtext = xtext & "</TD>"
                Next x
                
                xtext = xtext & "</tr>"
                
        End If
        rs1.MoveNext
        Loop
        xtext = xtext & "</TABLE>"
        
        
        GETTABLE_2HTML = xtext
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "                                                                                                                ", x) & vbTab
End Function
Attribute VB_Name = "GETTABLE_2HTMLmod"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub test01()
TABLENAME = "HTML_DELIVERABLES"
FIRSTCOLUMNMATCH = "Legal&Contracts"
x = GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
Debug.Print x
xtext = x
fname = CurrentProject.path & "\TEMP.html"
Call PRINT_INFO(xtext, fname)
ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = TABLENAME
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "" '"<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
rs1.MoveFirst
xtext = xtext & "<TABLE BORDER=2 WIDTH=900>"
############################### table headers
xtext = xtext & "<tr>"
xtext = xtext & "<TD VALIGN=TOP>No.</td>"
For x = 0 To rs1.Fields.Count - 1
        xtext = xtext & "<TD VALIGN=TOP><b>"
        xtext = xtext & xnewline & UCase(rs1.Fields(x).name)
        xtext = xtext & "</b></TD>"
Next x
xtext = xtext & "</tr>"
######################################### table details
lineno = 0
Do While Not rs1.EOF
        
        xtext = xtext & xnewline
        If rs1.Fields(0).Value = FIRSTCOLUMNMATCH Then
                lineno = lineno + 1
                xtext = xtext & "<tr> <td VALIGN=TOP>" & Format(lineno, "00") & "  </td>"
                
                
                For x = 0 To rs1.Fields.Count - 1
                        xtext = xtext & "<TD VALIGN=TOP>"
                        If InStr(1, rs1.Fields(x).Value, "#") Then
                                xtext = xtext & xnewline & RAG(rs1.Fields(x).Value)
                                Else
                                
                                xtext = xtext & xnewline & (rs1.Fields(x).Value)
                        End If
                        xtext = xtext & "</TD>"
                Next x
                
                xtext = xtext & "</tr>"
                
        End If
        rs1.MoveNext
        Loop
        xtext = xtext & "</TABLE>"
        
        
        GETTABLE_2HTML = xtext
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "                                                                                                                ", x) & vbTab
End Function
Attribute VB_Name = "IanGoddardReportS"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub IanGoddardReport()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "IanGoddardReport"
xnewline = "<br/>" & vbCrLf
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
X = X & vbCrLf & "<html><head><style>"
X = X & vbCrLf & "BODY {  color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial; position: absolute; z-index: -1; }"
X = X & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "TD {   z-index: 0; text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "table { z-index: 0; border-collapse: collapse; border: 1px solid black;}"
X = X & vbCrLf & "table.timclass td {  width: 350;  }"
X = X & vbCrLf & ".newbutton:link { background-color: black; color: white;  text-decoration: none; font-size: 8pt; }"
X = X & vbCrLf & "#DivForHoverItem {"
X = X & vbCrLf & "    /*just so we can see it*/"
x = x & vbCrLf & "    height: 1px;"
x = x & vbCrLf & "    width: 1px;"
x = x & vbCrLf & "    background-color: red;"
X = X & vbCrLf & "}"
X = X & vbCrLf & ""
X = X & vbCrLf & "#HiddenText {"
X = X & vbCrLf & "    display: none;"
x = x & vbCrLf & "    z-index: 1;"
x = x & vbCrLf & "    position: absolute;"
x = x & vbCrLf & "    width: 100%;"
X = X & vbCrLf & "}"
X = X & vbCrLf & ""
X = X & vbCrLf & "#DivForHoverItem:hover #HiddenText {"
x = x & vbCrLf & "    display:block;"
X = X & vbCrLf & "    display:inline;"
X = X & vbCrLf & "    background-color: yellow;"
x = x & vbCrLf & "    background-color: black;"
X = X & vbCrLf & "    color: black;"
X = X & vbCrLf & "    position: absolute;"
x = x & vbCrLf & "    position: relative;"
X = X & vbCrLf & "    width: 250;"
X = X & vbCrLf & "    margin: 20;"
X = X & vbCrLf & "    height: 250;"
X = X & vbCrLf & "    z-index: 100;"
X = X & vbCrLf & "}"
X = X & vbCrLf & "</style></head><body>"
X = X & vbCrLf & "<script>"
X = X & vbCrLf & "function myFunction(param) {"
X = X & vbCrLf & "    var w = window.open('yourpage.htm','pagename','resizable,height=260,width=370');"
X = X & vbCrLf & "    w.document.open();"
X = X & vbCrLf & "    w.document.write(  param );"
X = X & vbCrLf & "    w.document.close();"
X = X & vbCrLf & "}"
X = X & vbCrLf & "</script>"
###loop 1 get index
rs1.MoveFirst
xprevious = "x"
zdelim = "<li>"
X = X & "<P/>Andrew Wicks <Andrew.Wicks@XZXZXZ.cloud>; Matthew Planterose <Matthew.Planterose@XZXZXZ.cloud>; Mark Herridge <Mark.Herridge@XZXZXZ.cloud>; Tania Letts <Tania.Letts@XZXZXZ.cloud>; Donal Duff <Donal.Duff@XZXZXZ.cloud>; Lydia Lamy <Lydia.Lamy@XZXZXZ.cloud>; Tom Hacquoil <Tom.Hacquoil@XZXZXZ.cloud>; Carl Huelin <carl.huelin@XZXZXZ.cloud>; Ian Goddard <Ian.Goddard@XZXZXZ.cloud>; "
X = X & "<P/>Ian Goddard Report - Prototype/Pilot " & Format(Now, "dd/mmm/yy")
helpinfo = "XZXZXZXZXZXZ, 2017"
x = x & "<p><button onclick=myFunction('" & helpinfo & "')>Info</button>"
FLAG = "Xusethis"
If FLAG = "Xusethis" Then
        X = X & xnewline & ""
        X = X & xnewline & "LEGEND"
        X = X & xnewline & "   Purple - done/complete and finished"
        X = X & xnewline & "   Green - done, pending agreement or sign-off"
        X = X & xnewline & "   Amber - in progress, not yet complete - the comment will explain why"
        X = X & xnewline & "   Red - late, missing or a concern - the comment will explain why"
        X = X & xnewline & "   Blue - not due yet, to be agreed or future task/action"
End If
FLAG = ""
If FLAG = "usethis" Then
        https://stackoverflow.com/questions/19246995/using-class-in-td-element-styling
        X = X & xnewline
        X = X & xnewline
        X = X & "<TABLE border >"
        X = X & "<TR><TD valign=top>Month0 (BEFORE)</TD><TD valign=top>"
        X = X & "P0-Planning Understand the over-arching strategy - what are we trying to achieve. We will examine how we achieve it in the detailed implementation plan"
        X = X & "P1-Pre-Acquisition  Gather all the information necessary to hit the ground running for 100 day plan (eg people, process, technology, issues etc.) and be ready with communications plan to explain the intended approach"
        X = X & "</TD></TR>"
        
        
        X = X & "<TR><TD valign=top>Month1</TD><TD valign=top>"
        X = X & "P2-Acquisition  Review the due diligence, contract and pre-acquisition material to ensure early warning of issues which 1) affect the deal or 2) affect implementation (risks to be flagged at project/XZXZXZ level)"
        X = X & "P3-Arrive&Announce  Arrive on site and introduce XZXZXZ, our mission, vision, values, processes etc., and understand about them, their products, processes, services and clients"
        X = X & "</TD></TR>"
        
        X = X & "<TR><TD valign=top>Month2</TD><TD valign=top>"
        X = X & "P4-Understand&Plan  Devise an integration/transition plan (people, process, technology, products, customers) based to achieve the 100 day plan, and alignment to be able to achieve the over-arching strategy"
        X = X & "</TD></TR>"
        
        X = X & "<TR><TD valign=top>Month3</TD><TD valign=top>"
        X = X & "P5-Implement    Implement integration/transition plan"
        X = X & "P6-Handover&Close   Conclude 100 day plan and draft XZXZXZ Plan and Capex Plan for hand-over from integration/transition Month to operational XZXZXZ-as-usual"
        X = X & "</TD></TR>"
        
        X = X & "<TR><TD valign=top>Month4 (AFTER)</TD><TD valign=top>"
        X = X & "P7-XZXZXZ-as-Usual    Post-Project XZXZXZ-as-usual Month, under management of General Manager /Regional Managing Director"
        X = X & "</TD></TR>"
        X = X & "</TABLE>"
        
        
        
End If
x = x & "<table border valign=top>"
Do While Not rs1.EOF
        
        If rs1!ShortName <> xprevious Then ' new set so end old table and start new table
                
                If Len(xprevious) > 1 Then
                        X = X & "<tr><td valign=top>" & xcol1 & "</td><td valign=top>" & xcol2 & "</td><td valign=top>" & xcol3 & "</td><td valign=top>" & xcol4 & "</td><td valign=top>" & xcol5 & "</td><tr>"
                        X = X & "</table border>"
                End If
                xprevious = rs1!ShortName ' if there has been a previous record, close it
                X = X & "<h2>" & rs1!ShortName & "</h2>" ' xnewline
                
                '######################################################################
                'qfieldsarray = vlookup2array("workstreams", 8, rs1!ShortName)
                'For z = LBound(qfieldsarray) To UBound(qfieldsarray)
                'If Len(qfieldsarray(z)) > 1 Then
                'x = x & "<BR/>" & qfieldsarray(z)
                'End If
                'Next z
                
                answer = vlookup("Workstreams", 8, rs1!ShortName, 5)  '5th field in database table
                answer = Replace(answer, ";", "")
                ' x = x & "<p style='width: 1700;'><b>" & answer & ">>"
                X = X & "<p><b>" & answer & ">>"
                
                answer = vlookup("Workstreams", 8, rs1!ShortName, 3) ' 3rd field in database table
                answer = Replace(answer, ";", "")
                X = X & answer & "</b>"
                
                '######################################################################
                
                
                'x = x & "This needs to be reviwed with the work-stream owner" ' xnewline
                X = X & "<table border class='timclass' >"
                X = X & "<tr><td >Month 0 (BEFORE)</td><td >Month 1 (START)</td><td >Month 2 (MIDPOINT)</td><td >Month 3 (END)</td><td >Month(AFTER)</td></tr>"
                xuool = "<ul>"
                xcol1 = xuool
                xcol2 = xuool
                xcol3 = xuool
                xcol4 = xuool
                xcol5 = xuool
        End If
        xprod , XRAG, xcomment, xowner
        zprod = rs1!PRODUCT_DELIVERABLE
        zRAG = rs1!STATUS
        zcomment = rs1!COMMENT
        zowner = rs1!OWNER
        zdesc = rs1!DESCRIPTION
        zpmcomment = rs1!pmcomments
        zid = Format(rs1!ID, "000")
        
        If IsNull(rs1!PHASE) Then xcol1 = xcol1 & zdelim & raggit(zprod, zRAG, zcomment, zowner, zdesc, zpmcomment, zid) & xnewline
                If Left(rs1!PHASE, 1) = " " Then xcol1 = xcol1 & zdelim & raggit(zprod, zRAG, zcomment, zowner, zdesc, zpmcomment, zid) & xnewline
                        If Left(rs1!PHASE, 2) = "P1" Then xcol1 = xcol1 & zdelim & raggit(zprod, zRAG, zcomment, zowner, zdesc, zpmcomment, zid) & xnewline
                                If Left(rs1!PHASE, 2) = "P2" Then xcol2 = xcol2 & zdelim & raggit(zprod, zRAG, zcomment, zowner, zdesc, zpmcomment, zid) & xnewline
                                        If Left(rs1!PHASE, 2) = "P3" Then xcol2 = xcol2 & zdelim & raggit(zprod, zRAG, zcomment, zowner, zdesc, zpmcomment, zid) & xnewline
                                                If Left(rs1!PHASE, 2) = "P4" Then xcol3 = xcol3 & zdelim & raggit(zprod, zRAG, zcomment, zowner, zdesc, zpmcomment, zid) & xnewline
                                                        If Left(rs1!PHASE, 2) = "P5" Then xcol4 = xcol4 & zdelim & raggit(zprod, zRAG, zcomment, zowner, zdesc, zpmcomment, zid) & xnewline
                                                                If Left(rs1!PHASE, 2) = "P6" Then xcol4 = xcol4 & zdelim & raggit(zprod, zRAG, zcomment, zowner, zdesc, zpmcomment, zid) & xnewline
                                                                        If Left(rs1!PHASE, 2) = "P7" Then xcol5 = xcol5 & zdelim & raggit(zprod, zRAG, zcomment, zowner, zdesc, zpmcomment, zid) & xnewline
                                                                                
                                                                                If Left(rs1!PHASE, 2) = "M0" Then xcol1 = xcol1 & zdelim & raggit(zprod, zRAG, zcomment, zowner, zdesc, zpmcomment, zid) & xnewline
                                                                                        If Left(rs1!PHASE, 2) = "M1" Then xcol2 = xcol2 & zdelim & raggit(zprod, zRAG, zcomment, zowner, zdesc, zpmcomment, zid) & xnewline
                                                                                                If Left(rs1!PHASE, 2) = "M2" Then xcol3 = xcol3 & zdelim & raggit(zprod, zRAG, zcomment, zowner, zdesc, zpmcomment, zid) & xnewline
                                                                                                        If Left(rs1!PHASE, 2) = "M3" Then xcol4 = xcol4 & zdelim & raggit(zprod, zRAG, zcomment, zowner, zdesc, zpmcomment, zid) & xnewline
                                                                                                                If Left(rs1!PHASE, 2) = "M4" Then xcol5 = xcol5 & zdelim & raggit(zprod, zRAG, zcomment, zowner, zdesc, zpmcomment, zid) & xnewline
                                                                                                                        
                                                                                                                        
                                                                                                                        
                                                                                                                        rs1.MoveNext
                                                                                                                        Loop
                                                                                                                        
                                                                                                                        X = X & "<tr><td valign=top>" & xcol1 & "</td><td valign=top>" & xcol2 & "</td><td valign=top>" & xcol3 & "</td><td valign=top>" & xcol4 & "</td><td valign=top>" & xcol5 & "</td></tr>"
                                                                                                                        X = X & "</table border>"
                                                                                                                        X = X & xnewline
                                                                                                                        
                                                                                                                        
                                                                                                                        xfilename = "Ian Goddard Report.html"
                                                                                                                        xfilename = Replace(xfilename, " ", "")
                                                                                                                        xfilename = Replace(xfilename, "\", "")
                                                                                                                        xfilename = Replace(xfilename, "&", "")
                                                                                                                        xfilename = Replace(xfilename, ")", "")
                                                                                                                        xfilename = Replace(xfilename, "(", "")
                                                                                                                        
                                                                                                                        Call PRINT_INFO(X, xfilename)
                                                                                                                        ReturnValue = Shell("explorer.EXE " & xfilename, 1)  ' Run Calculator.
                                                                                                                        
                                                                                                                        
                                                                                                                        
                                                                                                                        rs1.Close
                                                                                                                        rs2.Close
                                                                                                                        rs3.Close
                                                                                                                        Set rs1 = Nothing
                                                                                                                        Set rs2 = Nothing
                                                                                                                        Set rs3 = Nothing
                                                                                                                        
                                                                                                                        db.Close
                                                                                                                        Set db = Nothing
                                                                                                                        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function raggit(qprod, RAG, COMMENT, OWNER, zdesc, zpmcomment, qid)
prod = qid & "-" & qprod
prod = qprod
xcomment = "<div style='font-size: 9;'><b>Item: " & prod & "</b><p/>Comment: " & COMMENT & "<p/>Owner: " & OWNER & "<p/>Desc: " & zdesc & "<p/>Tim'sNote:" & zpmcomment & "</div>"
xtext = "TaskN0:" & qid & " Update on " & qprod
xtext = Replace(xtext, " ", "_")
xtext = Replace(xtext, "<", "_")
xtext = Replace(xtext, "-", "_")
xtext = Replace(xtext, ">", "_")
xtext = Replace(xtext, "&", "_")
xtext = Replace(xtext, ",", "_")
qid = "<A class=newbutton HREF=MAILTO:XZXZXZ@XZXZXZ.CLOUD?SUBJECT=" & xtext & "&BODY=" & xtext & ">" & qid & "</A>"
raggit = (prod & " " & rag & " " & comment)
If InStr(2, RAG, "DKGREEN") Then
        ' raggit = "<span style='color: green;'>" & prod & "</span>"
        '  raggit = "<span style='color: green;'>" & prod & "</span>" & "<button onclick=myFunction('" & comment & "')>Info</button>"
        raggit = "<span id='DivForHoverItem'>  <span style='color: #007238;' >" & qid & prod & "</span>" & "<div id='HiddenText'>" & xcomment & "</div></div>"
        ElseIf InStr(2, RAG, "RED") Then
        'raggit = "<span style='color: RED;'>" & prod & "</span>" ' & comment
        raggit = "<span id='DivForHoverItem'>  <span style='color: red;' >" & qid & prod & "</span>" & "<div id='HiddenText'>" & xcomment & "</div></div>"
        ElseIf InStr(2, RAG, "AMBER") Then
        'raggit = "<span style='color: ORANGE;'>" & prod & "</span>"
        raggit = "<span id='DivForHoverItem'>  <span style='color: #C28800;'>" & qid & prod & "</span>" & "<div id='HiddenText'>" & xcomment & "</div></div>"
        ElseIf InStr(2, RAG, "GREEN") Then
        'raggit = "<span style='color: ORANGE;'>" & prod & "</span>"
        raggit = "<span id='DivForHoverItem'>  <span style='color: GREEN;'>" & qid & prod & "</span>" & "<div id='HiddenText'>" & xcomment & "</div></div>"
        Else
        ' raggit = "<span style='color: blue;'>" & prod & "</span>"
        raggit = "<span id='DivForHoverItem'>  <span style='color: blue;' >" & qid & prod & "</span>" & "<div id='HiddenText'>" & xcomment & "</div></div>"
End If
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, X)
padd = Left(xtext & "...............................................................", x) & vbTab
padd = xtext
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function tCase(X)
tCase = UCase("<b style='color:  #1ac6ff;'>" & X & "</b>")
tCase = UCase("<b style='color:  blue;'>" & X & "</b>")
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function RAG(X)
If InStr(1, UCase(X), "#GREY") Then RAG = UCase("<b style='background-color:  #669999;'>" & X & "</b>")
        If InStr(1, UCase(X), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & X & "</b>")
                If InStr(1, UCase(X), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & X & "</b>")
                        If InStr(1, UCase(X), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & X & "</b>")
                                
End Function
Attribute VB_Name = "INTRANET"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub INTRANET01()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
xnewline = "<br/>" & vbCrLf
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
x = x & vbCrLf & "<html><head><style>"
x = x & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "table { border-collapse: collapse; border: 1px solid black;}"
x = x & vbCrLf & "</style></head><body>"
###looop 1 get index
rs1.MoveFirst
x = x & vbCrLf & "<h1>PROJECT SKY ONE PAGE INTRANET</h1>"
x = x & vbCrLf & "<P> " & Format(Now, "DD/MMM/YYYY")
x = x & vbCrLf & "<BR/> Commercial and Confidential"
x = x & vbCrLf & "<BR/> If there are any errors, omissions or necessary update or changes please contact <a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud>Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051"
x = x & vbCrLf & "<BR/> "
x = x & vbCrLf & "<h1>TABLE OF CONTENTS <a name=TOC></h1>"
x = x & "<table BORDER=1>"
Do While Not rs1.EOF
        
        
        INDEXF = 2 ' E2ND FIELD IS THE INDEX
        
        xtext = xtext & xnewline & UCase(rs1.Fields(INDEXF).name) & ": " & rs1.Fields(INDEXF).Value
        xaname = UCase(rs1.Fields(INDEXF).Value)
        xtitle = UCase(rs1.Fields(INDEXF).Value)
        xc = xc + 1
        x = x & "<tr><td>" & Format(xc, " 00 ") & "<a href=#" & xaname & ">" & xtitle & "</a></td><td>" & RAG(UCase(rs1.Fields(7).Value)) & "</td><td>" & (rs1.Fields(8).Value) & "</td></tr>"
        
        
        
        
        rs1.MoveNext
        Loop
        x = x & "</table>"
        x = x & xnewline
        x = x & xnewline
        ###loop 2 get data
        
        
        rs1.MoveFirst
        
        For x = 0 To rs1.Fields.Count - 1
                Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
        Next x
        
        prev_xtext1 = ""
        prev_xtext2 = ""
        
        topheaderdata = x ' hold this in a variable that we will call later to add to the top
        
        Do While Not rs1.EOF
                x = "" ' now start blank for each work-stream
                xaname = UCase(rs1.Fields(INDEXF).Value)
                xtitle = UCase(rs1.Fields(INDEXF).Value)
                x = x & vbCrLf & "<p/><a name=" & xaname & ">"
                
                
                xshortname = rs1!ShortName
                xtext1 = rs1!OWNER
                xtext2 = rs1!WORKSTREAM
                xContents = rs1!Contents
                xapproach = rs1!Approach
                xmemo = rs1!Memo
                xrisksummary = rs1!RiskSummary
                
                
                
                
                x = x & xnewline & "<h1>" & tCase("WORK-STREAM " & xtext2) & "</h1>" & xnewline
                ' x = x & "=============================================================================== " & xnewline
                x = x & xnewline & tCase("Work-Stream Owner: ") & (xtext1) & xnewline
                x = x & xnewline & tCase("Contents: ") & (xContents) & xnewline
                x = x & xnewline & tCase("Approach: ") & (xapproach) & xnewline
                x = x & xnewline & tCase("Memo: ") & (xmemo) & xnewline
                x = x & xnewline & tCase("Risk Summary: ") & (xrisksummary) & xnewline
                
                x = x & xnewline & tCase("RAG: ") & RAG(UCase(rs1.Fields(7).Value)) & " " & rs1.Fields(8).Value & xnewline
                
                
                
                
                
                
                
                flag_listbudgets = "YES"
                If flag_listbudgets = "YES" Then '#########################
                        TABLENAME = "HTML_Budgets"
                        FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                        x = x & xnewline & tCase("BUDGETS") & xnewline
                        x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
                End If 'flag_listbudgets = "YES" Then '#########################
                
                
                
                flagxDeliverables = "YES"
                If flagxDeliverables = "YES" Then  '#########################
                        TABLENAME = "HTML_DELIVERABLES"
                        FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                        x = x & xnewline & tCase("DELIVERABLES") & xnewline
                        x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
                End If 'flag = Deliverables = "YES" Then '#########################
                
                
                flag_listsky = "YES"
                If flag_listsky = "YES" Then '#########################
                        TABLENAME = "HTML_progress"
                        FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                        x = x & xnewline & tCase("PROGRESS") & xnewline
                        x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
                End If ''################################################
                
                
                x = x & xnewline
                x = x & "<br/><a href=#TOC>Go Top Table of Contents</a><HR/>"
                
                
                ################################
                
                wscount = wscount + 1
                xfilename = xshortname
                xfilename = Replace(xfilename, " ", "")
                xfilename = Replace(xfilename, "\", "")
                xfilename = Replace(xfilename, "&", "")
                xfilename = Replace(xfilename, ")", "")
                xfilename = Replace(xfilename, "(", "")
                If xflag = "ws" Then
                        FNAME = CurrentProject.path & "\WORK-STREAM " & xfilename & ".html"
                        Call PRINT_INFO(xtext, FNAME)
                        ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
                End If
                
                fulltext = fulltext & x
                x = ""
                ################################
                
                
                
                rs1.MoveNext
                Loop
                
                fulltext = topheaderdata & fulltext ' add header data to the front!
                
                FNAME = CurrentProject.path & "\PROJECTSKYINTRANET.html"
                Call PRINT_INFO(fulltext, FNAME)
                
                
                ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "...............................................................", x) & vbTab
padd = xtext
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function tCase(x)
tCase = UCase("<b style='color:  #1ac6ff;'>" & x & "</b>")
tCase = UCase("<b style='color:  blue;'>" & x & "</b>")
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function RAG(x)
If InStr(1, UCase(x), "#GREY") Then RAG = UCase("<b style='background-color:  #669999;'>" & x & "</b>")
        If InStr(1, UCase(x), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & x & "</b>")
                If InStr(1, UCase(x), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & x & "</b>")
                        If InStr(1, UCase(x), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & x & "</b>")
                                
End Function
Attribute VB_Name = "INTRANET_LONG"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub INTRANET01()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
xnewline = "<br/>" & vbCrLf
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
x = x & vbCrLf & "<html><head><style>"
x = x & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H1 { color: BROWN;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H2 { color: BROWN;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H3 { color: BROWN;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H4 { background-color: red; color: BROWN;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "table { border-collapse: collapse; border: 1px solid black;}"
x = x & vbCrLf & "@media print {"
x = x & vbCrLf & "    h1 {page-break-before: always;}"
x = x & vbCrLf & "}"
x = x & vbCrLf & "</style></head><body>"
###looop 1 get index
rs1.MoveFirst
x = x & vbCrLf & "<h1>PROJECT LOGAN ONE PAGE INTRANET</h1>"
x = x & vbCrLf & "<P> " & Format(Now, "DD/MMM/YYYY")
x = x & vbCrLf & "<BR/> Commercial and Confidential"
x = x & vbCrLf & "<BR/> If there are any errors, omissions or necessary update or changes please contact <a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud>Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051"
x = x & vbCrLf & "<BR/> "
x = x & vbCrLf & "<h1>TABLE OF CONTENTS <a name=TOC></h1>"
x = x & "<table BORDER=1>"
Do While Not rs1.EOF
        
        
        INDEXF = 2 ' E2ND FIELD IS THE INDEX
        
        xtext = xtext & xnewline & UCase(rs1.Fields(INDEXF).name) & ": " & rs1.Fields(INDEXF).Value
        xaname = UCase(rs1.Fields(INDEXF).Value)
        xtitle = UCase(rs1.Fields(INDEXF).Value)
        xc = xc + 1
        x = x & "<tr><td>" & Format(xc, " 00 ") & "<a href=#" & xaname & ">" & xtitle & "</a></td><td>" & rs1.Fields(1).Value & "</td><td>" & RAG(UCase(rs1.Fields(7).Value)) & "</td><td>" & (rs1.Fields(8).Value) & "</td></tr>"
        
        
        
        
        rs1.MoveNext
        Loop
        x = x & "</table>"
        x = x & xnewline
        x = x & xnewline
        ###loop 2 get data
        
        
        rs1.MoveFirst
        
        For x = 0 To rs1.Fields.Count - 1
                Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
        Next x
        
        prev_xtext1 = ""
        prev_xtext2 = ""
        
        topheaderdata = x ' hold this in a variable that we will call later to add to the top
        
        Do While Not rs1.EOF
                x = "" ' now start blank for each work-stream
                xaname = UCase(rs1.Fields(INDEXF).Value)
                xtitle = UCase(rs1.Fields(INDEXF).Value)
                x = x & vbCrLf & "<p/><a name=" & xaname & ">"
                
                
                xshortname = rs1!ShortName
                xtext1 = rs1!OWNER
                xtext2 = rs1!WORKSTREAM
                xContents = rs1!Contents
                xapproach = rs1!Approach
                xmemo = rs1!Memo
                xrisksummary = rs1!RiskSummary
                
                
                
                
                x = x & xnewline & "<h1>" & tCase("WORK-STREAM " & xtext2) & "</h1>" & xnewline
                ' x = x & "=============================================================================== " & xnewline
                x = x & xnewline & tCase("Work-Stream Owner: ") & (xtext1) & xnewline
                x = x & xnewline & tCase("Contents: ") & (xContents) & xnewline
                x = x & xnewline & tCase("Approach: ") & (xapproach) & xnewline
                x = x & xnewline & tCase("Memo: ") & (xmemo) & xnewline
                x = x & xnewline & tCase("Risk Summary: ") & (xrisksummary) & xnewline
                
                x = x & xnewline & tCase("RAG: ") & RAG(UCase(rs1.Fields(7).Value)) & " " & rs1.Fields(8).Value & xnewline
                
                
                If FLAG_SEEKFEEDBACK = "NO" Then
                        
                        x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
                        xlink = xshortname
                        xlink = Replace(xlink, "&", "_")
                        xlink = Replace(xlink, " ", "_")
                        xlink = Replace(xlink, " ", "%20")
                        x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                        
                End If
                
                
                
                
                flag_listbudgets = "YES"
                If flag_listbudgets = "YES" Then '#########################
                        TABLENAME = "HTML_Budgets"
                        FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                        x = x & xnewline & tCase("BUDGETS") & xnewline
                        
                        x = x & xnewline & "With the various acquisition streams ongoing, this is just a reminder to advise that various invoices for professional services, travel, accommodation etc should be coded to nominal code 7740 for now, at least until such time as we own any new XZXZXZ and, from there, separate cost centres/nominal codes will be opened in due course."
                        x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
                End If 'flag_listbudgets = "YES" Then '#########################
                
                
                
                flagxDeliverables = "YES"
                If flagxDeliverables = "YES" Then  '#########################
                        TABLENAME = "HTML_DELIVERABLES"
                        FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                        x = x & xnewline & tCase("DELIVERABLES") & xnewline
                        x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
                End If 'flag = Deliverables = "YES" Then '#########################
                
                
                flag_listsky = "no"
                If flag_listsky = "YES" Then '#########################
                        TABLENAME = "HTML_progress"
                        FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                        x = x & xnewline & tCase("PROGRESS") & xnewline
                        x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
                End If ''################################################
                
                '   x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
                xlink = xshortname
                xlink = Replace(xlink, "&", "_")
                xlink = Replace(xlink, " ", "_")
                xlink = Replace(xlink, " ", "%20")
                ' x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                
                
                
                x = x & xnewline
                '  x = x & "<br/><a href=#TOC>Go Top Table of Contents</a><HR/>"
                
                
                ################################
                
                wscount = wscount + 1
                xfilename = xshortname
                xfilename = Replace(xfilename, " ", "")
                xfilename = Replace(xfilename, "\", "")
                xfilename = Replace(xfilename, "&", "")
                xfilename = Replace(xfilename, ")", "")
                xfilename = Replace(xfilename, "(", "")
                If xflag = "ws" Then
                        fname = CurrentProject.path & "\WORK-STREAM " & xfilename & ".html"
                        Call PRINT_INFO(xtext, fname)
                        ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
                End If
                
                fulltext = fulltext & x
                x = ""
                ################################
                
                
                
                rs1.MoveNext
                Loop
                
                fulltext = topheaderdata & fulltext ' add header data to the front!
                
                
                XDATE = Format(Now, "DDD-DD-MMM-YYYY")
                fname = CurrentProject.path & "\PROJECT_LOGAN_LONG_" & XDATE & ".html"
                Call PRINT_INFO(fulltext, fname)
                
                
                ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "...............................................................", x) & vbTab
padd = xtext
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function tCase(x)
tCase = UCase("<b style='color:  #1ac6ff;'>" & x & "</b>")
tCase = UCase("<b style='color: BROWN;'>" & x & "</b>")
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function XRAG(x)
If InStr(1, UCase(x), "#GREY") Then RAG = UCase("<b style='background-color:  #669999;'>" & x & "</b>")
        If InStr(1, UCase(x), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & x & "</b>")
                If InStr(1, UCase(x), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & x & "</b>")
                        If InStr(1, UCase(x), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & x & "</b>")
                                
End Function
Attribute VB_Name = "INTRANET_SHORT"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub INTRANET02()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
xnewline = "<br/>" & vbCrLf
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
x = x & vbCrLf & "<html><head><style>"
x = x & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H1 { color: BROWN;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H2 { color: BROWN;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H3 { color: BROWN;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H4 { background-color: red; color: BROWN;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "table { border-collapse: collapse; border: 1px solid black;}"
x = x & vbCrLf & "@media print {"
x = x & vbCrLf & "    h1 {page-break-before: always;}"
x = x & vbCrLf & "}"
x = x & vbCrLf & "</style></head><body>"
###looop 1 get index
rs1.MoveFirst
x = x & vbCrLf & "<h1>PROJECT LOGAN ONE PAGE INTRANET</h1>"
x = x & vbCrLf & "<P> " & Format(Now, "DD/MMM/YYYY")
x = x & vbCrLf & "<BR/> Commercial and Confidential"
x = x & vbCrLf & "<BR/> If there are any errors, omissions or necessary update or changes please contact <a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud>Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051"
x = x & vbCrLf & "<BR/> "
x = x & vbCrLf & "<h1>TABLE OF CONTENTS <a name=TOC></h1>"
x = x & "<table BORDER=1>"
Do While Not rs1.EOF
        
        
        INDEXF = 2 ' E2ND FIELD IS THE INDEX
        
        xtext = xtext & xnewline & UCase(rs1.Fields(INDEXF).name) & ": " & rs1.Fields(INDEXF).Value
        xaname = UCase(rs1.Fields(INDEXF).Value)
        xtitle = UCase(rs1.Fields(INDEXF).Value)
        xc = xc + 1
        x = x & "<tr><td>" & Format(xc, " 00 ") & "<a href=#" & xaname & ">" & xtitle & "</a></td><td>" & rs1.Fields(1).Value & "</td><td>" & RAG(UCase(rs1.Fields(7).Value)) & "</td><td>" & (rs1.Fields(8).Value) & "</td></tr>"
        
        
        
        
        rs1.MoveNext
        Loop
        x = x & "</table>"
        x = x & xnewline
        x = x & xnewline
        ###loop 2 get data
        
        
        rs1.MoveFirst
        
        For x = 0 To rs1.Fields.Count - 1
                Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
        Next x
        
        prev_xtext1 = ""
        prev_xtext2 = ""
        
        topheaderdata = x ' hold this in a variable that we will call later to add to the top
        
        Do While Not rs1.EOF
                x = "" ' now start blank for each work-stream
                xaname = UCase(rs1.Fields(INDEXF).Value)
                xtitle = UCase(rs1.Fields(INDEXF).Value)
                x = x & vbCrLf & "<p/><a name=" & xaname & ">"
                
                
                xshortname = rs1!ShortName
                xtext1 = rs1!OWNER
                xtext2 = rs1!WORKSTREAM
                xContents = rs1!Contents
                xapproach = rs1!Approach
                xmemo = rs1!Memo
                xrisksummary = rs1!RiskSummary
                
                
                
                
                x = x & xnewline & "<h1>" & tCase("WORK-STREAM " & xtext2) & "</h1>" & xnewline
                ' x = x & "=============================================================================== " & xnewline
                x = x & xnewline & tCase("Work-Stream Owner: ") & (xtext1) & xnewline
                x = x & xnewline & tCase("Contents: ") & (xContents) & xnewline
                x = x & xnewline & tCase("Approach: ") & (xapproach) & xnewline
                x = x & xnewline & tCase("Memo: ") & (xmemo) & xnewline
                x = x & xnewline & tCase("Risk Summary: ") & (xrisksummary) & xnewline
                
                x = x & xnewline & tCase("RAG: ") & RAG(UCase(rs1.Fields(7).Value)) & " " & rs1.Fields(8).Value & xnewline
                
                
                If FLAG_SEEKFEEDBACK = "NO" Then
                        x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
                        xlink = xshortname
                        xlink = Replace(xlink, "&", "_")
                        xlink = Replace(xlink, " ", "_")
                        xlink = Replace(xlink, " ", "%20")
                        x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                End If
                
                
                
                
                
                flag_listbudgets = "NO"
                If flag_listbudgets = "YES" Then '#########################
                        TABLENAME = "HTML_Budgets"
                        FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                        x = x & xnewline & tCase("BUDGETS") & xnewline
                        
                        x = x & xnewline & "With the various acquisition streams ongoing, this is just a reminder to advise that various invoices for professional services, travel, accommodation etc should be coded to nominal code 7740 for now, at least until such time as we own any new XZXZXZ and, from there, separate cost centres/nominal codes will be opened in due course."
                        x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
                End If 'flag_listbudgets = "YES" Then '#########################
                
                
                
                flagxDeliverables = "NO"
                If flagxDeliverables = "YES" Then  '#########################
                        TABLENAME = "HTML_DELIVERABLES"
                        FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                        x = x & xnewline & tCase("DELIVERABLES") & xnewline
                        x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
                End If 'flag = Deliverables = "YES" Then '#########################
                
                
                flag_listsky = "no"
                If flag_listsky = "YES" Then '#########################
                        TABLENAME = "HTML_progress"
                        FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                        x = x & xnewline & tCase("PROGRESS") & xnewline
                        x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
                End If ''################################################
                
                '   x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
                xlink = xshortname
                xlink = Replace(xlink, "&", "_")
                xlink = Replace(xlink, " ", "_")
                xlink = Replace(xlink, " ", "%20")
                ' x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                
                
                
                x = x & xnewline
                ' x = x & "<br/><a href=#TOC>Go Top Table of Contents</a><HR/>"
                
                
                ################################
                
                wscount = wscount + 1
                xfilename = xshortname
                xfilename = Replace(xfilename, " ", "")
                xfilename = Replace(xfilename, "\", "")
                xfilename = Replace(xfilename, "&", "")
                xfilename = Replace(xfilename, ")", "")
                xfilename = Replace(xfilename, "(", "")
                If xflag = "ws" Then
                        fname = CurrentProject.path & "\WORK-STREAM " & xfilename & ".html"
                        Call PRINT_INFO(xtext, fname)
                        ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
                End If
                
                fulltext = fulltext & x
                x = ""
                ################################
                
                
                
                rs1.MoveNext
                Loop
                
                fulltext = topheaderdata & fulltext ' add header data to the front!
                
                
                XDATE = Format(Now, "DDD-DD-MMM-YYYY")
                fname = CurrentProject.path & "\PROJECT_LOGAN_SHORT_" & XDATE & ".html"
                Call PRINT_INFO(fulltext, fname)
                
                
                ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "...............................................................", x) & vbTab
padd = xtext
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function tCase(x)
tCase = UCase("<b style='color:  #1ac6ff;'>" & x & "</b>")
tCase = UCase("<b style='color: BROWN;'>" & x & "</b>")
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function RAG(x)
If InStr(1, UCase(x), "#GREY") Then RAG = UCase("<b style='background-color:  #669999;'>" & x & "</b>")
        If InStr(1, UCase(x), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & x & "</b>")
                If InStr(1, UCase(x), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & x & "</b>")
                        If InStr(1, UCase(x), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & x & "</b>")
                                
End Function
Attribute VB_Name = "keycomms_indexHTMLx"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub keycomms_indexHTML()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "keycommsq"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
X = X & vbCrLf & "<html><head><style>"
X = X & vbCrLf & "BODY {  color: black;  text-align: left; font-size: 12pt; font-family: verdana; arial; position: absolute; z-index: -1; }"
X = X & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H3 { background-color: cyan;  color: cyan; width=100% text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "TD {   z-index: 0; text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "table { z-index: 0; border-collapse: collapse; border: 1px solid black;}"
X = X & vbCrLf & "table.timclass td {  width: 350;  }"
X = X & vbCrLf & ".newbutton:link { background-color: black; color: white;  text-decoration: none; font-size: 8pt; }"
X = X & vbCrLf & "a.newbutton { background-color: red; color: white;  text-decoration: none; font-size: 8pt; }"
X = X & vbCrLf & ".banner { background-color: red; color: white;  text-decoration: none; font-size: 8pt; }"
X = X & vbCrLf & "</style></head>"
xtext = X
rs1.MoveFirst
For X = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next X
For z = 0 To rs1.Fields.Count - 1
        Debug.Print z, rs1.Fields(z).name, rs1.Fields(z).Value
Next z
xtext = xtext & "<p/><A NAME=TOC> TABLE OF CONTENTS </a>"
xfieldstoinclude = ",0,1,2,3," '<-------------------------------------
##### INDEX hEADINGS LOOP ###########################################################
rs1.MoveFirst
xtext = xtext & vbCrLf & "<TABLE BORDER >"
xtext = xtext & vbCrLf & "<TR>"
xtext = xtext & "<TD> GoTo Link </TD>"
For X = 0 To rs1.Fields.Count - 1
        
        If InStr(1, xfieldstoinclude, "," & X & ",") Then
                xtext = xtext & "<TD>" & (rs1.Fields(X).name) & "</TD>" '& rs1.Fields(x).Value
        End If
        
Next X
xtext = xtext & vbCrLf & "</TR>"
##### INDEX LOOP ###########################################################
rs1.MoveFirst
xindexno = 0
Do While Not rs1.EOF
        xindexno = xindexno + 1
        xtext = xtext & vbCrLf & "<TR>"
        xtext = xtext & "<TD><A class=newbutton HREF=#" & xindexno & "> CLICK </a></TD>"
        
        For X = 0 To rs1.Fields.Count - 1
                
                If InStr(1, xfieldstoinclude, "," & X & ",") Then
                        xtext = xtext & "<TD>" & (rs1.Fields(X).Value) & "</TD>" '& rs1.Fields(x).Value
                End If
                
        Next X
        xtext = xtext & vbCrLf & "</TR>"
        rs1.MoveNext
        Loop
        xtext = xtext & vbCrLf & "</TABLE BORDER>"
        xtext = xtext & vbCrLf & "<HR/>"
        ########## DATA LOOP ######################################################
        rs1.MoveFirst
        xfieldstoinclude = "0,1,2,4,5,6,7,8,9,10," '<-------------------------------------
        xindexno = 0
        Do While Not rs1.EOF
                xindexno = xindexno + 1
                
                xtext = xtext & vbCrLf
                xtext = xtext & "<BR><A NAME=" & xindexno & "> " & " </a>"
                xtext = xtext & "<h3> x </h3>"  ' banner
                xtext = xtext & getsvg()
                For X = 0 To rs1.Fields.Count - 1
                        If InStr(1, xfieldstoinclude, "," & X & ",") Then
                                xtext = xtext & vbCrLf & "<P/><B>" & UCase(rs1.Fields(X).name) & ": </B>" & ASCII2HTML(rs1.Fields(X).Value)
                        End If
                        
                Next X
                xtext = xtext & "<p/><A HREF=#TOC> GO TO TABLE OF CONTENTS </a>"
                rs1.MoveNext
                Loop
                
                
                Debug.Print X
                fname = CurrentProject.path & "\TEMP.HTML"
                Call PRINT_INFO(xtext, fname)
                ReturnValue = Shell("EXPLORER.EXE " & fname, 1)  ' Run Calculator.
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function ASCII2HTML(X)
If Not IsNull(X) Then
        X = Replace(X, vbCrLf, "<BR>")
        Else
        X = " "
End If
ASCII2HTML = X
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function getsvg()
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "svg"
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
rs1.MoveFirst
For X = 0 To rs1.Fields.Count - 1
        Debug.Print X, rs1.Fields(X).name, rs1.Fields(X).Value
Next X
svgdata = rs1!svg ' second field value
svgdata = Replace(svgdata, "Information", " ")
svgdata = Replace(svgdata, "Weekly", " ")
svgdata = Replace(svgdata, "cyan", "yellow")
xtext = xtext & "<center><svg width=100 height=100 " & svgdata & " viewBox='900 0 99 99'> </center>"
getsvg = xtext
End Function
Attribute VB_Name = "list_databasefields"
Option Compare Database
Public Sub showtdf()
Dim db As Database
Dim tdf As TableDef
Dim x As Integer
Set db = CurrentDb
For Each tdf In db.TableDefs
        Debug.Print tdf.name,
        
        If InStr(1, tdf.name, "List") Then
                Debug.Print tdf.Fields.Count
                For x = 0 To tdf.Fields.Count - 1
                        Debug.Print tdf.Fields(x).name
                Next x
        End If
Next tdf
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub dbasedoc()
Call listQueryFields("Summary List for Exec")
Call listQueryFields("List of Projects")
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function listQueryFields(strQryName As String) As String
On Error GoTo listQueryFields_Error
Dim db As DAO.Database
Dim qryfld As DAO.QueryDef
Dim fld As Field
Set db = CurrentDb()
Set qryfld = db.QueryDefs(strQryName)
For Each fld In qryfld.Fields    'loop through all the fields of the Query
        Debug.Print fld.name
        Next
        
        Error_Handler_Exit:
        Set qryfld = Nothing
        Set db = Nothing
        Exit Function
        
        listQueryFields_Error:
        MsgBox "MS Access has generated the following error" & vbCrLf & vbCrLf & "Error Number: " & _
        Err.Number & vbCrLf & "Error Source: listQueryFields" & vbCrLf & _
        "Error Description: " & Err.DESCRIPTION, vbCritical, "An Error has Occured!"
        Resume Error_Handler_Exit
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub test01()
Dim z As Long
Dim y As Long
While Err.Number = 0
        On Error Resume Next
        While Err.Number = 0
                On Error Resume Next
                Debug.Print DBEngine(0)(0)(z)(y).name
                y = y + 1
                Wend
                If y > 1 Then
                        Err.Number = 0
                        y = 0
                        z = z + 1
                End If
                Wend
End Sub
Attribute VB_Name = "list_databasefields"
Option Compare Database
Public Sub showtdf()
Dim db As Database
Dim tdf As TableDef
Dim x As Integer
Set db = CurrentDb
For Each tdf In db.TableDefs
        Debug.Print tdf.name,
        
        If InStr(1, tdf.name, "List") Then
                Debug.Print tdf.Fields.Count
                For x = 0 To tdf.Fields.Count - 1
                        Debug.Print tdf.Fields(x).name
                Next x
        End If
Next tdf
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub dbasedoc()
Call listQueryFields("Summary List for Exec")
Call listQueryFields("List of Projects")
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function listQueryFields(strQryName As String) As String
On Error GoTo listQueryFields_Error
Dim db As DAO.Database
Dim qryfld As DAO.QueryDef
Dim fld As Field
Set db = CurrentDb()
Set qryfld = db.QueryDefs(strQryName)
For Each fld In qryfld.Fields    'loop through all the fields of the Query
        Debug.Print fld.name
        Next
        
        Error_Handler_Exit:
        Set qryfld = Nothing
        Set db = Nothing
        Exit Function
        
        listQueryFields_Error:
        MsgBox "MS Access has generated the following error" & vbCrLf & vbCrLf & "Error Number: " & _
        Err.Number & vbCrLf & "Error Source: listQueryFields" & vbCrLf & _
        "Error Description: " & Err.DESCRIPTION, vbCritical, "An Error has Occured!"
        Resume Error_Handler_Exit
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub test01()
Dim z As Long
Dim y As Long
While Err.Number = 0
        On Error Resume Next
        While Err.Number = 0
                On Error Resume Next
                Debug.Print DBEngine(0)(0)(z)(y).name
                y = y + 1
                Wend
                If y > 1 Then
                        Err.Number = 0
                        y = 0
                        z = z + 1
                End If
                Wend
End Sub
Attribute VB_Name = "list_databasefields"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_loop()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "projectrisks"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For X = 0 To rs1.Fields.Count - 1
        Debug.Print X, rs1.Fields(X).name, rs1.Fields(X).Value
        xtext = xtext & rs1.Fields(X).name & "; "
        
Next X
Debug.Print xtext
rs1.Close
Set rs1 = Nothing
rs2.Close
Set rs2 = Nothing
db.Close
Set db = Nothing
End Sub
Public Sub showtdf()
Dim db As Database
Dim tdf As TableDef
Dim X As Integer
Set db = CurrentDb
For Each tdf In db.TableDefs
        Debug.Print tdf.name,
        
        If InStr(1, tdf.name, "List") Then
                Debug.Print tdf.Fields.Count
                For X = 0 To tdf.Fields.Count - 1
                        Debug.Print tdf.Fields(X).name
                Next X
        End If
Next tdf
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub dbasedoc()
Call listQueryFields("Summary List for Exec")
Call listQueryFields("List of Projects")
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function listQueryFields(strQryName As String) As String
On Error GoTo listQueryFields_Error
Dim db As DAO.Database
Dim qryfld As DAO.QueryDef
Dim fld As Field
Set db = CurrentDb()
Set qryfld = db.QueryDefs(strQryName)
For Each fld In qryfld.Fields    'loop through all the fields of the Query
        Debug.Print fld.name
        Next
        
        Error_Handler_Exit:
        Set qryfld = Nothing
        Set db = Nothing
        Exit Function
        
        listQueryFields_Error:
        MsgBox "MS Access has generated the following error" & vbCrLf & vbCrLf & "Error Number: " & _
        Err.Number & vbCrLf & "Error Source: listQueryFields" & vbCrLf & _
        "Error Description: " & Err.DESCRIPTION, vbCritical, "An Error has Occured!"
        Resume Error_Handler_Exit
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub test01()
Dim z As Long
Dim y As Long
While Err.Number = 0
        On Error Resume Next
        While Err.Number = 0
                On Error Resume Next
                Debug.Print DBEngine(0)(0)(z)(y).name
                y = y + 1
                Wend
                If y > 1 Then
                        Err.Number = 0
                        y = 0
                        z = z + 1
                End If
                Wend
End Sub
Attribute VB_Name = "Module_various"
Attribute VB_Name = "Module_various"
Attribute VB_Name = "outlook2access"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub STEP2_TEST()
Dim myOlApp As New Outlook.Application
Dim myOlExp As Outlook.Explorer
Dim myOlSel As Outlook.Selection
Dim MsgTxt As String
Dim x As Integer
Set myOlExp = myOlApp.ActiveExplorer
Set myOlSel = myOlExp.Selection
On Error Resume Next
r = 2
for all items do...
For Each currentItem In myOlSel
        
        r = r + 1
        
        X1 = currentItem.SenderName
        X2 = currentItem.To
        x3 = currentItem.ReceivedTime
        X4 = currentItem.Subject
        'x5 = sieve(currentItem.Body)
        x5 = (currentItem.Body)
        X6 = ztext
        
        XATTACH_LIST = ""
        For Each objAtt In currentItem.Attachments
                XATTACH_LIST = XATTACH_LIST & objAtt.DisplayName & vbCrLf
                
                Next
                X7 = XATTACH_LIST
                
                Debug.Print X1, X2, x3, X4, x5
                
                Next
                '  ztext = sieve(xtext)
                Debug.Print ztext
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub STEP1_GET_SELECTED_EMAILS()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "Table1"
xsql2 = "Query2"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
Do While Not rs1.EOF
        
        
        Dim myOlApp As New Outlook.Application
        Dim myOlExp As Outlook.Explorer
        Dim myOlSel As Outlook.Selection
        Dim MsgTxt As String
        
        Set myOlExp = myOlApp.ActiveExplorer
        Set myOlSel = myOlExp.Selection
        On Error Resume Next
        
        rs1.MoveLast
        '##############################################################################
        For Each currentItem In myOlSel
                X1 = currentItem.SenderName
                X2 = currentItem.To
                x3 = currentItem.ReceivedTime
                X4 = currentItem.Subject
                'x5 = sieve(currentItem.Body)
                x5 = "BLANK"
                x5 = (currentItem.Body)
                X6 = ztext
                
                XATTACH_LIST = ""
                For Each objAtt In currentItem.Attachments
                        XATTACH_LIST = XATTACH_LIST & objAtt.DisplayName & vbCrLf
                        
                        Next
                        X7 = XATTACH_LIST
                        
                        
                        ###################################
                        xc = xc + 1
                        Debug.Print xc, x3, X4
                        'rs1.Delete
                        rs1.AddNew
                        
                        rs1!F1 = X1
                        rs1!F2 = X2
                        rs1!F3 = x3
                        rs1!F4 = X4
                        rs1!F5 = x5
                        rs1!F6 = X6
                        rs1!F7 = X7
                        rs1.Update
                        
                        
                        
                        '###################################
                        
                        Next
                        
                        
                        
                        rs1.MoveNext
                        Loop
                        
                        
                        rs1.Close
                        Set rs1 = Nothing
                        rs2.Close
                        Set rs2 = Nothing
                        db.Close
                        Set db = Nothing
                        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function xf(x)
xf = Format(x, "00")
End Function
Attribute VB_Name = "PMO_web_table"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub web_table_pmo()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "query1"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
#############################
xtext = xtext & "<h1> List of Projects </h1>"
#############################
###loop 2 get data
xtext = xtext & "<table border>"
rs1.MoveFirst
xtext = xtext & "<tr>"
For X = 0 To rs1.Fields.Count - 1
        xtext = xtext & "<td>" & UCase(rs1.Fields(X).name) & "</td>"
        xtext = xtext
Next X
xtext = xtext & "</tr>"
Do While Not rs1.EOF
        
        
        
        
        
        xtext = xtext & "<tr>"
        For X = 0 To rs1.Fields.Count - 1
                xtext = xtext & "<td>" & RAG(rs1.Fields(X).Value) & "</td>"
                xtext = xtext
        Next X
        xtext = xtext & "</tr>"
        
        
        rs1.MoveNext
        Loop
        
        xtext = xtext & "</table>"
        Debug.Print X
        FNAME = CurrentProject.path & "\TEMP.html"
        Call PRINT_INFO(xtext, FNAME)
        
        
        ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function RAG(X)
RAG = X
If InStr(1, UCase(X), "#GREY") Then RAG = UCase("<b style='background-color:  #669999;'>" & X & "</b>")
        If InStr(1, UCase(X), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & X & "</b>")
                If InStr(1, UCase(X), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & X & "</b>")
                        If InStr(1, UCase(X), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & X & "</b>")
                                
End Function
Attribute VB_Name = "print_infox"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function PRINT_INFO(ByVal PARAM_TEXT As String, ByVal xoutput As String) 'vba_excel report cells, create file, print file, notepad
Dim FILENUMBER1 As Integer
Dim xpath As String
Dim xfilename As String
xpath = ActiveWorkbook.Path & "\"
xfilename = "TEMP" & Format(Now(), "yymmdd") & "-" & Format(Now(), "HHMM") & ".txt"
xfilename = xoutput
FILENUMBER1 = FreeFile
Open xpath & xfilename For Output As #FILENUMBER1 '
Print #FILENUMBER1, PARAM_TEXT
Close #FILENUMBER1
Call open_file(xpath & xfilename)
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function open_file(xfilename As String)
vba_excel report cells, create file, print file, notepad
Dim ReturnValue, I
ReturnValue = Shell("notepad.EXE " & xfilename, 1)  ' Run Calculator.
AppActivate ReturnValue
End Function
Attribute VB_Name = "report"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_reports()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "query2"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
Do While Not rs1.EOF
        
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        If xtext1 <> prev_xtext1 Then
                x = x & vbCrLf & "Work-Stream Owner: " & (xtext1) & vbCrLf
                xc = 0
                prev_xtext1 = xtext1
        End If
        xc = xc + 1
        x = x & " " & xc & " " & xtext2 & vbCrLf
        
        
        
        rs1.MoveNext
        Loop
        
        Debug.Print x
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_reports2wkly()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
Do While Not rs1.EOF
        
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        xContents = rs1!Contents
        xapproach = rs1!Approach
        xmemo = rs1!Memo
        lprogress = rs1!wsProgress
        lrisk = rs1!wsRisks
        lnext = rs1!wsnext
        
        gprogress = rs1!gprogress
        grisk = rs1!grisk
        gnext = rs1!gnext
        
        
        
        If xtext1 <> prev_xtext1 Then
                x = x & vbCrLf & UCase(xtext2) & vbCrLf
                x = x & vbCrLf & "Work-Stream Owner: " & (xtext1) & vbCrLf
                x = x & vbCrLf & "Contents: " & (xContents) & vbCrLf
                x = x & vbCrLf & "Approach: " & (xapproach) & vbCrLf
                x = x & vbCrLf & "Memo: " & (xmemo) & vbCrLf
                
                xc = 0
                prev_xtext1 = xtext1
        End If
        xc = xc + 1
        x = x & vbCrLf & "PROJECT SKY WORK" & vbCrLf
        
        x = x & vbCrLf & "Progress: " & (lprogress) & vbCrLf
        x = x & vbCrLf & "Risk: " & (lrisk) & vbCrLf
        x = x & vbCrLf & "Next: " & (lnext) & vbCrLf
        
        x = x & vbCrLf & "PROJECT GREENHOUSE WORK " & vbCrLf
        
        x = x & vbCrLf & "Progress: " & (gprogress) & vbCrLf
        x = x & vbCrLf & "Risk: " & (grisk) & vbCrLf
        x = x & vbCrLf & "Next: " & (grisk) & vbCrLf
        
        
        rs1.MoveNext
        Loop
        
        Debug.Print x
        FNAME = CurrentProject.path & "\TEMP.TXT"
        Call PRINT_INFO(x, FNAME)
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "report"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_reports()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "query2"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
Do While Not rs1.EOF
        
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        If xtext1 <> prev_xtext1 Then
                x = x & vbCrLf & "Work-Stream Owner: " & (xtext1) & vbCrLf
                xc = 0
                prev_xtext1 = xtext1
        End If
        xc = xc + 1
        x = x & " " & xc & " " & xtext2 & vbCrLf
        
        
        
        rs1.MoveNext
        Loop
        
        Debug.Print x
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_reports2wkly()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
Do While Not rs1.EOF
        
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        xContents = rs1!Contents
        xapproach = rs1!Approach
        xmemo = rs1!Memo
        lprogress = rs1!wsProgress
        lrisk = rs1!wsRisks
        lnext = rs1!wsnext
        
        gprogress = rs1!gprogress
        grisk = rs1!grisk
        gnext = rs1!gnext
        
        
        
        If xtext1 <> prev_xtext1 Then
                x = x & vbCrLf & UCase(xtext2) & vbCrLf
                x = x & vbCrLf & "Work-Stream Owner: " & (xtext1) & vbCrLf
                x = x & vbCrLf & "Contents: " & (xContents) & vbCrLf
                x = x & vbCrLf & "Approach: " & (xapproach) & vbCrLf
                x = x & vbCrLf & "Memo: " & (xmemo) & vbCrLf
                
                xc = 0
                prev_xtext1 = xtext1
        End If
        xc = xc + 1
        x = x & vbCrLf & "PROJECT SKY WORK" & vbCrLf
        
        x = x & vbCrLf & "Progress: " & (lprogress) & vbCrLf
        x = x & vbCrLf & "Risk: " & (lrisk) & vbCrLf
        x = x & vbCrLf & "Next: " & (lnext) & vbCrLf
        
        x = x & vbCrLf & "PROJECT GREENHOUSE WORK " & vbCrLf
        
        x = x & vbCrLf & "Progress: " & (gprogress) & vbCrLf
        x = x & vbCrLf & "Risk: " & (grisk) & vbCrLf
        x = x & vbCrLf & "Next: " & (grisk) & vbCrLf
        
        
        rs1.MoveNext
        Loop
        
        Debug.Print x
        fname = CurrentProject.path & "\TEMP.TXT"
        Call PRINT_INFO(x, fname)
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "reports_2notepad"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub reports02_2wkly2()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
Do While Not rs1.EOF
        
        
        xshortname = rs1!ShortName
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        xContents = rs1!Contents
        xapproach = rs1!Approach
        xmemo = rs1!Memo
        xrisksummary = rs1!RiskSummary
        lprogress = rs1!wsProgress
        lrisk = rs1!wsRisks
        lnext = rs1!wsnext
        
        gprogress = rs1!gprogress
        grisk = rs1!grisk
        gnext = rs1!gnext
        
        
        
        If xtext1 <> prev_xtext1 Then
                x = x & vbCrLf & "WORK-STREAM " & UCase(xtext2) & vbCrLf
                x = x & "=============================================================================== " & vbCrLf
                x = x & vbCrLf & UCase("Work-Stream Owner: ") & (xtext1) & vbCrLf
                x = x & vbCrLf & UCase("Contents: ") & (xContents) & vbCrLf
                x = x & vbCrLf & UCase("Approach: ") & (xapproach) & vbCrLf
                x = x & vbCrLf & UCase("Memo: ") & (xmemo) & vbCrLf
                x = x & vbCrLf & UCase("Risk Summary: ") & (xrisksummary) & vbCrLf
                
                prev_xtext1 = xtext1
        End If
        
        
        
        
        
        
        
        If flag_listsky = "YES" Then '#########################
                xc = 0
                xc = xc + 1
                x = x & vbCrLf & "PROJECT SKY WORK" & vbCrLf
                
                x = x & vbCrLf & "Progress: " & (lprogress) & vbCrLf
                x = x & vbCrLf & "Risk: " & (lrisk) & vbCrLf
                x = x & vbCrLf & "Next: " & (lnext) & vbCrLf
                
        End If ''################################################
        
        
        
        ' flag_listbudgets = "YES"
        If flag_listbudgets = "YES" Then '#########################
                
                '### budgets ######
                rs2.MoveFirst
                xd = vbTab
                XSUM = 0
                x = x & vbCrLf & "BUDGETS" & vbCrLf
                Do While Not rs2.EOF
                        
                        zshortname = rs2!ShortName
                        If zshortname = xshortname Then
                                x = x & vbCrLf & padd(rs2!Item, 10) & padd(rs2!desc, 20) & padd(rs2!capex, 10) & padd(rs2!notes, 20)
                                '  x = x & vbCrLf & rs2!Item & xd & rs2!desc & xd & rs2!capex & xd & rs2!revex & xd & rs2!notes
                                XSUM = XSUM + rs2!capex
                        End If
                        
                        rs2.MoveNext
                        Loop
                        x = x & vbCrLf & "TOTAL  " & Format(XSUM, "0,000.00") & vbCrLf
                        
                End If 'flag_listbudgets = "YES" Then '#########################
                
                
                
                
                If flag = Deliverables = "YES" Then '#########################
                        '### deliverables ######
                        rs3.MoveFirst
                        xd = vbTab
                        xc = 0
                        x = x & vbCrLf & "DELIVERABLES (Tasks to do or documents to draft/approve)" & vbCrLf
                        Do While Not rs3.EOF
                                Dshortname = rs3!ShortName
                                XDELIVERABLE = rs3!PRODUCT_DELIVERABLE
                                XDESCRIPTION = rs3!DESCRIPTION
                                If Dshortname = xshortname Then
                                        xc = xc + 1
                                        x = x & vbCrLf & Format(xc, " 00 ") & XDELIVERABLE
                                        '  x = x & vbCrLf & rs2!Item & xd & rs2!desc & xd & rs2!capex & xd & rs2!revex & xd & rs2!notes
                                        
                                End If
                                
                                rs3.MoveNext
                                Loop
                                x = x & vbCrLf & vbCrLf
                                
                        End If 'flag = Deliverables = "YES" Then '#########################
                        
                        
                        
                        
                        If flag_listgreenhouse = "YES" Then '========================================================
                                x = x & vbCrLf & "PROJECT GREENHOUSE WORK " & vbCrLf
                                x = x & vbCrLf & "Progress: " & (gprogress) & vbCrLf
                                x = x & vbCrLf & "Risk: " & (grisk) & vbCrLf
                                x = x & vbCrLf & "Next: " & (grisk) & vbCrLf
                        End If '========================================================
                        
                        
                        
                        rs1.MoveNext
                        Loop
                        
                        Debug.Print x
                        FNAME = CurrentProject.path & "\TEMP.TXT"
                        Call PRINT_INFO(x, FNAME)
                        
                        rs1.Close
                        rs2.Close
                        rs3.Close
                        Set rs1 = Nothing
                        Set rs2 = Nothing
                        Set rs3 = Nothing
                        
                        db.Close
                        Set db = Nothing
                        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "                                                                                                                ", x) & vbTab
End Function
Attribute VB_Name = "reports_2notepad"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub reports02_2wkly2()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
Do While Not rs1.EOF
        
        
        xshortname = rs1!ShortName
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        xContents = rs1!Contents
        xapproach = rs1!Approach
        xmemo = rs1!Memo
        xrisksummary = rs1!RiskSummary
        lprogress = rs1!wsProgress
        lrisk = rs1!wsRisks
        lnext = rs1!wsnext
        
        gprogress = rs1!gprogress
        grisk = rs1!grisk
        gnext = rs1!gnext
        
        
        
        If xtext1 <> prev_xtext1 Then
                x = x & vbCrLf & "WORK-STREAM " & UCase(xtext2) & vbCrLf
                x = x & "=============================================================================== " & vbCrLf
                x = x & vbCrLf & UCase("Work-Stream Owner: ") & (xtext1) & vbCrLf
                x = x & vbCrLf & UCase("Contents: ") & (xContents) & vbCrLf
                x = x & vbCrLf & UCase("Approach: ") & (xapproach) & vbCrLf
                x = x & vbCrLf & UCase("Memo: ") & (xmemo) & vbCrLf
                x = x & vbCrLf & UCase("Risk Summary: ") & (xrisksummary) & vbCrLf
                
                prev_xtext1 = xtext1
        End If
        
        
        
        
        
        
        
        If flag_listsky = "YES" Then '#########################
                xc = 0
                xc = xc + 1
                x = x & vbCrLf & "PROJECT SKY WORK" & vbCrLf
                
                x = x & vbCrLf & "Progress: " & (lprogress) & vbCrLf
                x = x & vbCrLf & "Risk: " & (lrisk) & vbCrLf
                x = x & vbCrLf & "Next: " & (lnext) & vbCrLf
                
        End If ''################################################
        
        
        
        ' flag_listbudgets = "YES"
        If flag_listbudgets = "YES" Then '#########################
                
                '### budgets ######
                rs2.MoveFirst
                xd = vbTab
                XSUM = 0
                x = x & vbCrLf & "BUDGETS" & vbCrLf
                Do While Not rs2.EOF
                        
                        zshortname = rs2!ShortName
                        If zshortname = xshortname Then
                                x = x & vbCrLf & padd(rs2!Item, 10) & padd(rs2!desc, 20) & padd(rs2!capex, 10) & padd(rs2!notes, 20)
                                '  x = x & vbCrLf & rs2!Item & xd & rs2!desc & xd & rs2!capex & xd & rs2!revex & xd & rs2!notes
                                XSUM = XSUM + rs2!capex
                        End If
                        
                        rs2.MoveNext
                        Loop
                        x = x & vbCrLf & "TOTAL  " & Format(XSUM, "0,000.00") & vbCrLf
                        
                End If 'flag_listbudgets = "YES" Then '#########################
                
                
                
                
                If flag = Deliverables = "YES" Then '#########################
                        '### deliverables ######
                        rs3.MoveFirst
                        xd = vbTab
                        xc = 0
                        x = x & vbCrLf & "DELIVERABLES (Tasks to do or documents to draft/approve)" & vbCrLf
                        Do While Not rs3.EOF
                                Dshortname = rs3!ShortName
                                XDELIVERABLE = rs3!PRODUCT_DELIVERABLE
                                XDESCRIPTION = rs3!DESCRIPTION
                                If Dshortname = xshortname Then
                                        xc = xc + 1
                                        x = x & vbCrLf & Format(xc, " 00 ") & XDELIVERABLE
                                        '  x = x & vbCrLf & rs2!Item & xd & rs2!desc & xd & rs2!capex & xd & rs2!revex & xd & rs2!notes
                                        
                                End If
                                
                                rs3.MoveNext
                                Loop
                                x = x & vbCrLf & vbCrLf
                                
                        End If 'flag = Deliverables = "YES" Then '#########################
                        
                        
                        
                        
                        If flag_listgreenhouse = "YES" Then '========================================================
                                x = x & vbCrLf & "PROJECT GREENHOUSE WORK " & vbCrLf
                                x = x & vbCrLf & "Progress: " & (gprogress) & vbCrLf
                                x = x & vbCrLf & "Risk: " & (grisk) & vbCrLf
                                x = x & vbCrLf & "Next: " & (grisk) & vbCrLf
                        End If '========================================================
                        
                        
                        
                        rs1.MoveNext
                        Loop
                        
                        Debug.Print x
                        fname = CurrentProject.path & "\TEMP.TXT"
                        Call PRINT_INFO(x, fname)
                        
                        rs1.Close
                        rs2.Close
                        rs3.Close
                        Set rs1 = Nothing
                        Set rs2 = Nothing
                        Set rs3 = Nothing
                        
                        db.Close
                        Set db = Nothing
                        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "                                                                                                                ", x) & vbTab
End Function
Attribute VB_Name = "table2html_notocxx"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2html_notoc()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "query1"
xsql1 = "projecthandbook"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
###loop 2 get data
xtext = xtext & "<table border>"
rs1.MoveFirst
xtext = xtext & "<tr>"
For x = 0 To rs1.Fields.Count - 1
        xtext = xtext & "<td valign=top><b>" & UCase(rs1.Fields(x).name) & "</b></td>"
        xtext = xtext
Next x
xtext = xtext & "</tr>"
Do While Not rs1.EOF
        
        
        
        
        
        xtext = xtext & "<tr>"
        For x = 0 To rs1.Fields.Count - 1
                xtext = xtext & "<td valign=top>" & rs1.Fields(x).Value & "</td>"
                xtext = xtext
        Next x
        xtext = xtext & "</tr>"
        
        
        rs1.MoveNext
        Loop
        
        xtext = xtext & "</table>"
        Debug.Print x
        fname = CurrentProject.path & "\TEMP.html"
        Call PRINT_INFO(xtext, fname)
        
        
        ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "table2html_riskrept"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2html_notoc()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "HTML_REPORT"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
###loop 2 get data
xtext = xtext & "<table border>"
rs1.MoveFirst
xtext = xtext & "<tr>"
For x = 0 To rs1.Fields.Count - 1
        xtext = xtext & "<td>" & UCase(rs1.Fields(x).name) & "</td>"
        xtext = xtext
Next x
xtext = xtext & "</tr>"
Do While Not rs1.EOF
        
        
        
        
        
        xtext = xtext & "<tr>"
        For x = 0 To rs1.Fields.Count - 1
                xtext = xtext & "<td>" & rs1.Fields(x).Value & "</td>"
                xtext = xtext
        Next x
        xtext = xtext & "</tr>"
        
        
        rs1.MoveNext
        Loop
        
        xtext = xtext & "</table>"
        Debug.Print x
        FNAME = CurrentProject.path & "\TEMP.html"
        Call PRINT_INFO(xtext, FNAME)
        
        
        ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "table2html_withtocxx"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2html_withtoc()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "query1"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
###looop 1 get index
rs1.MoveFirst
xtext = xtext & vbCrLf & "<p/>TABLE OF CONTENTS <a name=TOC></P>"
Do While Not rs1.EOF
        
        
        INDEXF = 0 ' E2ND FIELD IS THE INDEX
        
        xtext = xtext & xnewline & UCase(rs1.Fields(INDEXF).name) & ": " & rs1.Fields(INDEXF).Value
        xaname = UCase(rs1.Fields(INDEXF).Value)
        xtitle = UCase(rs1.Fields(INDEXF).Value)
        xc = xc + 1
        xtext = xtext & Format(xc, " 000 ") & "<a href=#" & xaname & ">" & xtitle & "</a>"
        xtext = xtext & xnewline
        
        
        
        rs1.MoveNext
        Loop
        xtext = xtext & xnewline
        xtext = xtext & xnewline
        ###loop 2 get data
        
        rs1.MoveFirst
        
        
        
        For x = 0 To rs1.Fields.Count - 1
                Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
        Next x
        
        xnewline = "<br/>" & vbCrLf
        
        Do While Not rs1.EOF
                xaname = UCase(rs1.Fields(INDEXF).Value)
                xtitle = UCase(rs1.Fields(INDEXF).Value)
                xtext = xtext & vbCrLf & "<p/><a name=" & xaname & ">"
                
                
                
                
                xtext = xtext & xnewline
                xtext = xtext & "<hr/>"
                
                xtext = xtext & xnewline & "<h1/>" & rs1.Fields(0).Value & "</h1>"
                
                For x = 1 To rs1.Fields.Count - 1
                        xtext = xtext & xnewline & UCase(rs1.Fields(x).name) & ": " & rs1.Fields(x).Value
                        xtext = xtext & xnewline
                Next x
                
                xtext = xtext & xnewline
                xtext = xtext & "<br/><a href=#TOC>Go Top Table of Contents</a>"
                
                
                'rs1.Edit
                'rs1!Detail = xtext
                'rs1.Update
                
                
                
                
                rs1.MoveNext
                Loop
                
                
                Debug.Print x
                fname = CurrentProject.path & "\TEMP.html"
                Call PRINT_INFO(xtext, fname)
                
                
                ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "                                                                                                                ", x) & vbTab
End Function
Attribute VB_Name = "table2html_wssummary"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2html()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "HTML_REPORT"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
###looop 1 get index
rs1.MoveFirst
xtext = xtext & vbCrLf & "<p/>TABLE OF CONTENTS <a name=TOC></P>"
Do While Not rs1.EOF
        
        
        INDEXF = 1 ' E2ND FIELD IS THE INDEX
        
        xtext = xtext & xnewline & UCase(rs1.Fields(INDEXF).name) & ": " & rs1.Fields(INDEXF).Value
        xaname = UCase(rs1.Fields(INDEXF).Value)
        xtitle = UCase(rs1.Fields(INDEXF).Value)
        xc = xc + 1
        xtext = xtext & Format(xc, " 000 ") & "<a href=#" & xaname & ">" & xtitle & "</a>"
        xtext = xtext & xnewline
        
        
        
        rs1.MoveNext
        Loop
        xtext = xtext & xnewline
        xtext = xtext & xnewline
        ###loop 2 get data
        
        rs1.MoveFirst
        
        
        
        For x = 0 To rs1.Fields.Count - 1
                Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
        Next x
        
        xnewline = "<br/>" & vbCrLf
        
        Do While Not rs1.EOF
                xaname = UCase(rs1.Fields(INDEXF).Value)
                xtitle = UCase(rs1.Fields(INDEXF).Value)
                xtext = xtext & vbCrLf & "<p/><a name=" & xaname & ">"
                
                
                
                
                xtext = xtext & xnewline
                xtext = xtext & "<hr/>"
                For x = 0 To rs1.Fields.Count - 1
                        xtext = xtext & xnewline & UCase(rs1.Fields(x).name) & ": " & rs1.Fields(x).Value
                        xtext = xtext & xnewline
                Next x
                
                xtext = xtext & xnewline
                xtext = xtext & "<br/><a href=#TOC>Go Top Table of Contents</a>"
                
                
                'rs1.Edit
                'rs1!Detail = xtext
                'rs1.Update
                
                
                
                
                rs1.MoveNext
                Loop
                
                
                Debug.Print x
                FNAME = CurrentProject.path & "\TEMP.html"
                Call PRINT_INFO(xtext, FNAME)
                
                
                ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "                                                                                                                ", x) & vbTab
End Function
Attribute VB_Name = "table2html_wssummary"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2html()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "HTML_REPORT"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
###looop 1 get index
rs1.MoveFirst
xtext = xtext & vbCrLf & "<p/>TABLE OF CONTENTS <a name=TOC></P>"
Do While Not rs1.EOF
        
        
        INDEXF = 1 ' E2ND FIELD IS THE INDEX
        
        xtext = xtext & xnewline & UCase(rs1.Fields(INDEXF).name) & ": " & rs1.Fields(INDEXF).Value
        xaname = UCase(rs1.Fields(INDEXF).Value)
        xtitle = UCase(rs1.Fields(INDEXF).Value)
        xc = xc + 1
        xtext = xtext & Format(xc, " 000 ") & "<a href=#" & xaname & ">" & xtitle & "</a>"
        xtext = xtext & xnewline
        
        
        
        rs1.MoveNext
        Loop
        xtext = xtext & xnewline
        xtext = xtext & xnewline
        ###loop 2 get data
        
        rs1.MoveFirst
        
        
        
        For x = 0 To rs1.Fields.Count - 1
                Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
        Next x
        
        xnewline = "<br/>" & vbCrLf
        
        Do While Not rs1.EOF
                xaname = UCase(rs1.Fields(INDEXF).Value)
                xtitle = UCase(rs1.Fields(INDEXF).Value)
                xtext = xtext & vbCrLf & "<p/><a name=" & xaname & ">"
                
                
                
                
                xtext = xtext & xnewline
                xtext = xtext & "<hr/>"
                For x = 0 To rs1.Fields.Count - 1
                        xtext = xtext & xnewline & UCase(rs1.Fields(x).name) & ": " & rs1.Fields(x).Value
                        xtext = xtext & xnewline
                Next x
                
                xtext = xtext & xnewline
                xtext = xtext & "<br/><a href=#TOC>Go Top Table of Contents</a>"
                
                
                'rs1.Edit
                'rs1!Detail = xtext
                'rs1.Update
                
                
                
                
                rs1.MoveNext
                Loop
                
                
                Debug.Print x
                fname = CurrentProject.path & "\TEMP.html"
                Call PRINT_INFO(xtext, fname)
                
                
                ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "                                                                                                                ", x) & vbTab
End Function
Attribute VB_Name = "table2html_wssummary"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2html()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "HTML_REPORT"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
###looop 1 get index
rs1.MoveFirst
xtext = xtext & vbCrLf & "<p/>TABLE OF CONTENTS <a name=TOC></P>"
Do While Not rs1.EOF
        
        
        INDEXF = 1 ' E2ND FIELD IS THE INDEX
        
        xtext = xtext & xnewline & UCase(rs1.Fields(INDEXF).name) & ": " & rs1.Fields(INDEXF).Value
        xaname = UCase(rs1.Fields(INDEXF).Value)
        xtitle = UCase(rs1.Fields(INDEXF).Value)
        xc = xc + 1
        xtext = xtext & Format(xc, " 000 ") & "<a href=#" & xaname & ">" & xtitle & "</a>"
        xtext = xtext & xnewline
        
        
        
        rs1.MoveNext
        Loop
        xtext = xtext & xnewline
        xtext = xtext & xnewline
        ###loop 2 get data
        
        rs1.MoveFirst
        
        
        
        For X = 0 To rs1.Fields.Count - 1
                Debug.Print X, rs1.Fields(X).name, rs1.Fields(X).Value
        Next X
        
        xnewline = "<br/>" & vbCrLf
        
        Do While Not rs1.EOF
                xaname = UCase(rs1.Fields(INDEXF).Value)
                xtitle = UCase(rs1.Fields(INDEXF).Value)
                xtext = xtext & vbCrLf & "<p/><a name=" & xaname & ">"
                
                
                
                
                xtext = xtext & xnewline
                xtext = xtext & "<hr/>"
                For X = 0 To rs1.Fields.Count - 1
                        xtext = xtext & xnewline & UCase(rs1.Fields(X).name) & ": " & rs1.Fields(X).Value
                        xtext = xtext & xnewline
                Next X
                
                xtext = xtext & xnewline
                xtext = xtext & "<br/><a href=#TOC>Go Top Table of Contents</a>"
                
                
                'rs1.Edit
                'rs1!Detail = xtext
                'rs1.Update
                
                
                
                
                rs1.MoveNext
                Loop
                
                
                Debug.Print X
                fname = CurrentProject.path & "\TEMP.html"
                Call PRINT_INFO(xtext, fname)
                
                
                ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, X)
padd = Left(xtext & "                                                                                                                ", X) & vbTab
End Function
Attribute VB_Name = "table2report"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2report()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        
        
        xtext = xtext & vbCrLf
        xtext = xtext & "=============================="
        For x = 0 To rs1.Fields.Count - 1
                xtext = xtext & vbCrLf & UCase(rs1.Fields(x).name) & ": " & rs1.Fields(x).Value
                xtext = xtext & vbCrLf
        Next x
        
        
        
        
        'rs1.Edit
        'rs1!Detail = xtext
        'rs1.Update
        
        
        
        
        rs1.MoveNext
        Loop
        
        
        Debug.Print x
        FNAME = CurrentProject.path & "\TEMP.TXT"
        Call PRINT_INFO(xtext, FNAME)
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "                                                                                                                ", x) & vbTab
End Function
Attribute VB_Name = "table2report"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2report()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        
        
        xtext = xtext & vbCrLf
        xtext = xtext & "=============================="
        For x = 0 To rs1.Fields.Count - 1
                xtext = xtext & vbCrLf & UCase(rs1.Fields(x).name) & ": " & rs1.Fields(x).Value
                xtext = xtext & vbCrLf
        Next x
        
        
        
        
        'rs1.Edit
        'rs1!Detail = xtext
        'rs1.Update
        
        
        
        
        rs1.MoveNext
        Loop
        
        
        Debug.Print x
        fname = CurrentProject.path & "\TEMP.TXT"
        Call PRINT_INFO(xtext, fname)
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "                                                                                                                ", x) & vbTab
End Function
Attribute VB_Name = "table2report_basic"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2report_basic()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "keycomms"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
rs1.MoveFirst
For X = 0 To rs1.Fields.Count - 1
        Debug.Print X, rs1.Fields(X).name, rs1.Fields(X).Value
Next X
Do While Not rs1.EOF
        
        
        xtext = xtext & vbCrLf
        xtext = xtext & "=============================="
        For X = 0 To rs1.Fields.Count - 1
                xtext = xtext & vbCrLf & UCase(rs1.Fields(X).name) & ": " & rs1.Fields(X).Value
                xtext = xtext & vbCrLf
        Next X
        
        
        
        
        'rs1.Edit
        'rs1!Detail = xtext
        'rs1.Update
        
        
        
        
        rs1.MoveNext
        Loop
        
        
        Debug.Print X
        fname = CurrentProject.path & "\TEMP.TXT"
        Call PRINT_INFO(xtext, fname)
        ReturnValue = Shell("notepad.EXE " & fname, 1)  ' Run Calculator.
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2report_index()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "query1"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
rs1.MoveFirst
For X = 0 To rs1.Fields.Count - 1
        Debug.Print X, rs1.Fields(X).name, rs1.Fields(X).Value
Next X
##### INDEX LOOP ###########################################################
rs1.MoveFirst
xfieldstoinclude = ",0,"
Do While Not rs1.EOF
        xtext = xtext & vbCrLf
        
        For X = 0 To rs1.Fields.Count - 1
                If InStr(1, xfieldstoinclude, X) Then
                        xtext = xtext & vbCrLf & UCase(rs1.Fields(X).name) & ": " & rs1.Fields(X).Value
                End If
        Next X
        rs1.MoveNext
        Loop
        
        xtext = xtext & vbCrLf & "=============================="
        ########## DATA LOOP ######################################################
        rs1.MoveFirst
        xfieldstoinclude = ",1,2,3,4,5,"
        Do While Not rs1.EOF
                xtext = xtext & vbCrLf
                For X = 0 To rs1.Fields.Count - 1
                        If InStr(1, xfieldstoinclude, X) Then
                                xtext = xtext & vbCrLf & UCase(rs1.Fields(X).name) & ": " & rs1.Fields(X).Value
                        End If
                        
                Next X
                rs1.MoveNext
                Loop
                
                
                Debug.Print X
                fname = CurrentProject.path & "\TEMP.TXT"
                Call PRINT_INFO(xtext, fname)
                ReturnValue = Shell("notepad.EXE " & fname, 1)  ' Run Calculator.
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2report_indexHTML()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "keycomms"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
X = X & vbCrLf & "<html><head><style>"
X = X & vbCrLf & "BODY {  color: black;  text-align: left; font-size: 10pt; font-family: verdana; arial; position: absolute; z-index: -1; }"
X = X & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H3 { background-color: cyan;  color: cyan; width=100% text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "TD {   z-index: 0; text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "table { z-index: 0; border-collapse: collapse; border: 1px solid black;}"
X = X & vbCrLf & "table.timclass td {  width: 350;  }"
X = X & vbCrLf & ".newbutton:link { background-color: black; color: white;  text-decoration: none; font-size: 8pt; }"
X = X & vbCrLf & "a.newbutton { background-color: red; color: white;  text-decoration: none; font-size: 8pt; }"
X = X & vbCrLf & ".banner { background-color: red; color: white;  text-decoration: none; font-size: 8pt; }"
X = X & vbCrLf & "</style></head>"
xtext = X
rs1.MoveFirst
For z = 0 To rs1.Fields.Count - 1
        Debug.Print z, rs1.Fields(z).name, rs1.Fields(z).Value
Next z
xtext = xtext & "<p/><A NAME=TOC> TABLE OF CONTENTS </a>"
xfieldstoinclude = ",0,1,2,3," '<-------------------------------------
##### INDEX hEADINGS LOOP ###########################################################
rs1.MoveFirst
xtext = xtext & vbCrLf & "<TABLE BORDER >"
xtext = xtext & vbCrLf & "<TR>"
xtext = xtext & "<TD> GoTo Link </TD>"
For X = 0 To rs1.Fields.Count - 1
        
        If InStr(1, xfieldstoinclude, "," & X & ",") Then
                xtext = xtext & "<TD>" & (rs1.Fields(X).name) & "</TD>" '& rs1.Fields(x).Value
        End If
        
Next X
xtext = xtext & vbCrLf & "</TR>"
##### INDEX LOOP ###########################################################
rs1.MoveFirst
xindexno = 0
Do While Not rs1.EOF
        xindexno = xindexno + 1
        xtext = xtext & vbCrLf & "<TR>"
        xtext = xtext & "<TD><A class=newbutton HREF=#" & xindexno & "> CLICK </a></TD>"
        
        For X = 0 To rs1.Fields.Count - 1
                
                If InStr(1, xfieldstoinclude, "," & X & ",") Then
                        xtext = xtext & "<TD>" & (rs1.Fields(X).Value) & "</TD>" '& rs1.Fields(x).Value
                End If
                
        Next X
        xtext = xtext & vbCrLf & "</TR>"
        rs1.MoveNext
        Loop
        xtext = xtext & vbCrLf & "</TABLE BORDER>"
        xtext = xtext & vbCrLf & "<HR/>"
        ########## DATA LOOP ######################################################
        rs1.MoveFirst
        xfieldstoinclude = "0,1,2,4,5," '<-------------------------------------
        xindexno = 0
        Do While Not rs1.EOF
                xindexno = xindexno + 1
                
                xtext = xtext & vbCrLf
                xtext = xtext & "<BR><A NAME=" & xindexno & "> " & " </a>"
                xtext = xtext & "<h3> x </h3>"  ' banner
                xtext = xtext & getsvg()
                For X = 0 To rs1.Fields.Count - 1
                        If InStr(1, xfieldstoinclude, "," & X & ",") Then
                                xtext = xtext & vbCrLf & "<P/><B>" & UCase(rs1.Fields(X).name) & ": </B>" & ASCII2HTML(rs1.Fields(X).Value)
                        End If
                        
                Next X
                xtext = xtext & "<p/><A HREF=#TOC> GO TO TABLE OF CONTENTS </a>"
                rs1.MoveNext
                Loop
                
                
                Debug.Print X
                fname = CurrentProject.path & "\TEMP.HTML"
                Call PRINT_INFO(xtext, fname)
                ReturnValue = Shell("EXPLORER.EXE " & fname, 1)  ' Run Calculator.
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function ASCII2HTML(X)
If Not IsNull(X) Then
        X = Replace(X, vbCrLf, "<BR>")
        Else
        X = " "
End If
ASCII2HTML = X
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function getsvg()
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "svg"
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
rs1.MoveFirst
For X = 0 To rs1.Fields.Count - 1
        Debug.Print X, rs1.Fields(X).name, rs1.Fields(X).Value
Next X
svgdata = rs1!svg ' second field value
svgdata = Replace(svgdata, "Information", " ")
svgdata = Replace(svgdata, "Weekly", " ")
svgdata = Replace(svgdata, "cyan", "yellow")
xtext = xtext & "<center><svg width=100 height=100 " & svgdata & " viewBox='900 0 99 99'> </center>"
getsvg = xtext
End Function
Attribute VB_Name = "tempx"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub web_form_pmo_backup()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "List of Projects Query"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
#############################
x = x & "<h1> List of Projects </h1>"
x = x & vbCrLf & "<P> " & Format(Now, "DD/MMM/YYYY")
x = x & vbCrLf & "<BR/> Commercial and Confidential"
x = x & vbCrLf & "<BR/> If there are any errors, omissions or necessary update or changes please contact <a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud>Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051"
x = x & vbCrLf & "<BR/> "
x = x & vbCrLf & "<h1>TABLE OF CONTENTS <a name=TOC></h1>"
#############################
xtext = xtext & x
rs1.MoveFirst
Do While Not rs1.EOF
        fieldnox = 0
        xtext = xtext & "<p/> " & UCase(rs1.Fields(fieldnox).Value)
        
        
        xtext = xtext & "<br/><a href=#" & UCase(rs1.Fields(fieldnox).Value) & "> " & UCase(rs1.Fields(fieldnox).Value) & " </a>"
        Debug.Print x
        
        rs1.MoveNext
        Loop
        
        xtext = xtext & "<br/>"
        xtext = xtext & "<hr/>"
        xtext = xtext & "<br/>"
        
        ###loop 2 get data
        
        rs1.MoveFirst
        
        Do While Not rs1.EOF
                fieldnox = 0
                xtext = xtext & "<h1> " & UCase(rs1.Fields(fieldnox).Value) & "</h1>"
                xtext = xtext & "<p/><a name=" & UCase(rs1.Fields(fieldnox).Value) & ">"
                
                
                xtext = xtext & "<table border width=900>"
                For x = 0 To rs1.Fields.Count - 1
                        xtext = xtext & "<tr><td width=100><b>" & UCase(rs1.Fields(x).name) & "</b></td><td>" & rag((rs1.Fields(x).Value)) & "</td> </tr>"
                        xtext = xtext
                Next x
                xtext = xtext & "</table><p/>"
                xtext = xtext & "<br/><a href=#TOC>Go Top Table of Contents</a><HR/>"
                
                Debug.Print x
                
                rs1.MoveNext
                Loop
                
                FNAME = CurrentProject.path & "\TEMP.html"
                Call PRINT_INFO(xtext, FNAME)
                
                
                ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function rag(x)
rag = x
If InStr(1, UCase(x), "#GREY") Then rag = UCase("<b style='background-color:  #669999;'>" & x & "</b>")
        If InStr(1, UCase(x), "#RED") Then rag = UCase("<b style='background-color:  RED;'>" & x & "</b>")
                If InStr(1, UCase(x), "#AMBER") Then rag = UCase("<b style='background-color:  #ff6600;'>" & x & "</b>")
                        If InStr(1, UCase(x), "#GREEN") Then rag = UCase("<b style='background-color:  GREEN;'>" & x & "</b>")
                                
End Function
Attribute VB_Name = "update_dowhile01"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub update_dowhile()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "workstreams"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        If IsNull(rs1!Memo) Then
                skip
                Else
                xtext = rs1!Memo
                xtext = Replace(xtext, vbCrLf, "//")
                
                rs1.Edit
                rs1!Memo = xtext
                
                rs1.Update
        End If
        
        
        rs1.MoveNext
        Loop
        
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "update_dowhile01"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub update_dowhile()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "List of Projects"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        
        rs1.Edit
        rs1!Priority = 3
        If IsNull(rs1!Cost) Then rs1!Cost = 5000
                If IsNull(rs1!Stakeholders) Then rs1!Stakeholders = "TBC"
                        
                        
                        rs1!OpenClosed = UCase(rs1!OpenClosed)
                        rs1!Status = UCase(rs1!Status)
                        rs1.Update
                        
                        
                        rs1.MoveNext
                        Loop
                        
                        
                        rs1.Close
                        Set rs1 = Nothing
                        rs2.Close
                        Set rs2 = Nothing
                        db.Close
                        Set db = Nothing
                        
End Sub
Attribute VB_Name = "update_dowhile_ZAP"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub update_dowhile_ZAP_workstreams()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "workstreams"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        
        
        
        xtext = "Initial draft will develop list of tasks, products, budgets etc., once we have a full understanding of target XZXZXZ, people, processes, systems etc. The aim being to bring together the best of both organisations as part of an integrated global strategy "
        
        rs1.Edit
        rs1!Memo = xtext
        rs1!RAG = "#GREEN"
        rs1!RAGComment = "Pre-Project Stage - tasks, outputs, budget, schedule to be confirmed"
        
        rs1.Update
        
        
        
        rs1.MoveNext
        Loop
        
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub update_dowhile_ZAP_deliverables()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "deliverables"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        
        
        xtext = "Initial draft - will develop list of tasks, products, budgets etc. "
        
        rs1.Edit
        rs1!duedate = #1/8/2017#
        rs1!donedate = Null
        
        rs1!COMMENT = "Project set-up, task to be defined, agreed, progressed etc. "
        rs1!STATUS = "#GREY"
        rs1!APPROVER = "Julian Box"
        rs1.Update
        
        
        
        rs1.MoveNext
        Loop
        
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "vba_export_modulex"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub vba_export_modules()
#http://www.cpearson.com/Excel/VBE.aspx
 reference to extensibility library
xprefix = "C:\Users\Tim\Documents\Data2017\VBA\VBAAccess\vba_"
Dim objMyProj As VBProject
Dim objVBComp As VBComponent
Set objMyProj = Application.VBE.ActiveVBProject
For Each objVBComp In objMyProj.VBComponents
        If objVBComp.Type = vbext_ct_StdModule Then
                Debug.Print "Exporting " & xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".txt"
                
                objVBComp.Export xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".bas"
                objVBComp.Export xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".txt"
                
        End If
        Next
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function PRINT_INFO1(ByVal PARAM_TEXT As String, ByVal xoutput As String) 'vba_excel report cells, create file, print file, notepad
Dim FILENUMBER1 As Integer
Dim xpath As String
Dim xfilename As String
xpath = ActiveWorkbook.Path & "\"
xfilename = "TEMP" & Format(Now(), "yymmdd") & "-" & Format(Now(), "HHMM") & ".txt"
xfilename = xoutput
FILENUMBER1 = FreeFile
Open xpath & xfilename For Output As #FILENUMBER1 '
Print #FILENUMBER1, PARAM_TEXT
Close #FILENUMBER1
Call open_file(xpath & xfilename)
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function open_file(xfilename As String)
vba_excel report cells, create file, print file, notepad
Dim ReturnValue, I
ReturnValue = Shell("notepad.EXE " & xfilename, 1)  ' Run Calculator.
AppActivate ReturnValue
End Function
Attribute VB_Name = "vba_export_modulx"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub vba_export_modules()
#http://www.cpearson.com/Excel/VBE.aspx
 reference to extensibility library
xprefix = "C:\Users\Tim\Documents\Data2017\VBA\VBAAccess\vba_"
Dim objMyProj As VBProject
Dim objVBComp As VBComponent
Set objMyProj = Application.VBE.ActiveVBProject
For Each objVBComp In objMyProj.VBComponents
        If objVBComp.Type = vbext_ct_StdModule Then
                Debug.Print "Exporting " & xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".txt"
                
                objVBComp.Export xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".bas"
                objVBComp.Export xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".txt"
                
        End If
        Next
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function PRINT_INFO1(ByVal PARAM_TEXT As String, ByVal xoutput As String) 'vba_excel report cells, create file, print file, notepad
Dim FILENUMBER1 As Integer
Dim xpath As String
Dim xfilename As String
xpath = ActiveWorkbook.Path & "\"
xfilename = "TEMP" & Format(Now(), "yymmdd") & "-" & Format(Now(), "HHMM") & ".txt"
xfilename = xoutput
FILENUMBER1 = FreeFile
Open xpath & xfilename For Output As #FILENUMBER1 '
Print #FILENUMBER1, PARAM_TEXT
Close #FILENUMBER1
Call open_file(xpath & xfilename)
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function open_file(xfilename As String)
vba_excel report cells, create file, print file, notepad
Dim ReturnValue, I
ReturnValue = Shell("notepad.EXE " & xfilename, 1)  ' Run Calculator.
AppActivate ReturnValue
End Function
Attribute VB_Name = "web_form_pmox"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub web_form_pmo()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "List of Projects Query"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 10pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
#############################
x = x & "<h1> " & UCase("List of Projects") & " </h1>"
x = x & vbCrLf & "<P> " & Format(Now, "DD/MMM/YYYY")
x = x & vbCrLf & "<BR/> Commercial and Confidential"
x = x & vbCrLf & "<BR/> If there are any errors, omissions or necessary update or changes please contact <a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud>Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051"
x = x & vbCrLf & "<BR/> "
x = x & vbCrLf & "<h3>TABLE OF CONTENTS <a name=TOC></h3>"
#############################
xtext = xtext & x
rs1.MoveFirst
xtext = xtext & "<table width=900>"
xtext = xtext & "<table>"
Do While Not rs1.EOF
        fieldnox = 0
        xc = xc + 1
        xtext = xtext & "<p/> " & UCase(rs1.Fields(fieldnox).Value)
        
        
        xtext = xtext & "<tr><td>" & Format(xc, "00") & " " & "<a href=#" & UCase(rs1.Fields(fieldnox).Value) & "> " & UCase(rs1.Fields(fieldnox).Value)
        
        
        xtext = xtext & " <td>  " & Left(rs1.Fields(2).Value, 50) & "  </td> "
        xtext = xtext & " </a></td><td>  [" & rag(rs1.Fields(4).Value) & "] </td>"
        xtext = xtext & " <td>  " & Left(rs1.Fields(5).Value, 50) & " ... </td> "
        
        xtext = xtext & " </tr>"
        Debug.Print x
        
        rs1.MoveNext
        Loop
        xtext = xtext & "</table>"
        
        xtext = xtext & "<br/>"
        xtext = xtext & "<hr/>"
        xtext = xtext & "<br/>"
        
        ###loop 2 get data
        
        rs1.MoveFirst
        
        Do While Not rs1.EOF
                fieldnox = 0
                xtext = xtext & "<h1> " & UCase(rs1.Fields(fieldnox).Value) & "</h1>"
                xtext = xtext & "<p/><a name=" & UCase(rs1.Fields(fieldnox).Value) & ">"
                
                
                xtext = xtext & "<table border width=900>"
                For x = 0 To rs1.Fields.Count - 1
                        xtext = xtext & "<tr><td width=100><b>" & UCase(rs1.Fields(x).name) & "</b></td><td>" & rag((rs1.Fields(x).Value)) & "</td> </tr>"
                        xtext = xtext
                Next x
                xtext = xtext & "</table>"
                xsubject = Replace(UCase(rs1.Fields(fieldnox).Value), " ", "%20")
                xtext = xtext & "<b><p style='color: red;'> Use this link to send an update to Project Manager... "
                
                xtext = xtext & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xsubject & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                
                xtext = xtext & "<P/><a href=#TOC>Go Top Table of Contents</a><HR/>"
                
                Debug.Print x
                
                rs1.MoveNext
                Loop
                
                FNAME = CurrentProject.path & "\XZXZXZ_PROJECT_LIST.html"
                Call PRINT_INFO(xtext, FNAME)
                
                
                ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function rag(x)
rag = x
If InStr(1, UCase(x), "#UNSURE") Then rag = UCase("<b style='background-color:  #669999;'>" & x & "</b>")
        If InStr(1, UCase(x), "#RED") Then rag = UCase("<b style='background-color:  RED;'>" & x & "</b>")
                If InStr(1, UCase(x), "#AMBER") Then rag = UCase("<b style='background-color:  #ff6600;'>" & x & "</b>")
                        If InStr(1, UCase(x), "#GREEN") Then rag = UCase("<b style='background-color:  GREEN;'>" & x & "</b>")
                                If InStr(1, UCase(x), "#PENDING") Then rag = UCase("<b style='background-color:  BLUE;'>" & x & "</b>")
                                        If InStr(1, UCase(x), "#OTHER") Then rag = UCase("<b style='background-color:  BLUE;'>" & x & "</b>")
                                                If InStr(1, UCase(x), "#GREEN") Then rag = UCase("<b style='background-color:  GREEN;'>" & x & "</b>")
End Function
Attribute VB_Name = "web_report_pmox"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub web_report_pmo()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "List of Projects Query"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
#############################
xtext = xtext & "<h1> List of Projects </h1>"
#############################
###loop 2 get data
xtext = xtext & "<table border>"
rs1.MoveFirst
xtext = xtext & "<tr>"
For x = 0 To rs1.Fields.Count - 1
        xtext = xtext & "<br/>" & UCase(rs1.Fields(x).name)  '"</td>"
        xtext = xtext
Next x
  xtext = xtext & "</tr>"
Do While Not rs1.EOF
        
        
        
        
        
        xtext = xtext & "<tr>"
        For x = 0 To rs1.Fields.Count - 1
                xtext = xtext & "<br/><b>" & rag(rs1.Fields(x).name) & " </b> " & rag(rs1.Fields(x).Value) '& "</td>"
                xtext = xtext
        Next x
        'xtext = xtext & "</tr>"
        xtext = xtext & "<p/><hr/>"
        
        rs1.MoveNext
        Loop
        
        xtext = xtext & "</table>"
        xtext = xtext & "<p/><hr/>"
        Debug.Print x
        FNAME = CurrentProject.path & "\TEMP.html"
        Call PRINT_INFO(xtext, FNAME)
        
        
        ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function rag(x)
rag = x
If InStr(1, UCase(x), "#GREY") Then rag = UCase("<b style='background-color:  #669999;'>" & x & "</b>")
        If InStr(1, UCase(x), "#RED") Then rag = UCase("<b style='background-color:  RED;'>" & x & "</b>")
                If InStr(1, UCase(x), "#AMBER") Then rag = UCase("<b style='background-color:  #ff6600;'>" & x & "</b>")
                        If InStr(1, UCase(x), "#GREEN") Then rag = UCase("<b style='background-color:  GREEN;'>" & x & "</b>")
                                
End Function
Attribute VB_Name = "web_table_pmox"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub web_table_pmo()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "List of Projects Query"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
#############################
xtext = xtext & "<h1> List of Projects </h1>"
#############################
###loop 2 get data
xtext = xtext & "<table border>"
rs1.MoveFirst
xtext = xtext & "<tr>"
For x = 0 To rs1.Fields.Count - 1
        xtext = xtext & "<td>" & UCase(rs1.Fields(x).name) & "</td>"
        xtext = xtext
Next x
xtext = xtext & "</tr>"
Do While Not rs1.EOF
        
        
        
        
        
        xtext = xtext & "<tr>"
        For x = 0 To rs1.Fields.Count - 1
                xtext = xtext & "<td>" & rag(rs1.Fields(x).Value) & "</td>"
                xtext = xtext
        Next x
        xtext = xtext & "</tr>"
        
        
        rs1.MoveNext
        Loop
        
        xtext = xtext & "</table>"
        Debug.Print x
        FNAME = CurrentProject.path & "\TEMP.html"
        Call PRINT_INFO(xtext, FNAME)
        
        
        ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function rag(x)
rag = x
If InStr(1, UCase(x), "#GREY") Then rag = UCase("<b style='background-color:  #669999;'>" & x & "</b>")
        If InStr(1, UCase(x), "#RED") Then rag = UCase("<b style='background-color:  RED;'>" & x & "</b>")
                If InStr(1, UCase(x), "#AMBER") Then rag = UCase("<b style='background-color:  #ff6600;'>" & x & "</b>")
                        If InStr(1, UCase(x), "#GREEN") Then rag = UCase("<b style='background-color:  GREEN;'>" & x & "</b>")
                                
End Function
Attribute VB_Name = "word_long_reportx"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub word_long_report()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
xnewline = "<br/>" & vbCrLf
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
x = x & vbCrLf & "<html><head><style>"
x = x & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H1 { color: BROWN;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H2 { color: BROWN;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H3 { color: BROWN;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H4 { background-color: red; color: BROWN;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "table { border-collapse: collapse; border: 1px solid black;}"
x = x & vbCrLf & "@media print {"
x = x & vbCrLf & "    h1 {page-break-before: always;}"
x = x & vbCrLf & "}"
x = x & vbCrLf & "</style></head><body>"
INDEXF = 2 ' E2ND FIELD IS THE INDEX
xaname = UCase(rs1.Fields(INDEXF).Value)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
topheaderdata = x ' hold this in a variable that we will call later to add to the top
Do While Not rs1.EOF
        x = "" ' now start blank for each work-stream
        xaname = UCase(rs1.Fields(INDEXF).Value)
        xtitle = UCase(rs1.Fields(INDEXF).Value)
        x = x & vbCrLf & "<p/><a name=" & xaname & ">"
        
        
        xshortname = rs1!ShortName
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        xContents = rs1!Contents
        xapproach = rs1!Approach
        xmemo = rs1!Memo
        xrisksummary = rs1!RiskSummary
        
        
        
        
        x = x & xnewline & "<h1>" & tCase("WORK-STREAM " & xtext2) & "</h1>" & xnewline
        ' x = x & "=============================================================================== " & xnewline
        x = x & xnewline & tCase("Work-Stream Owner: ") & (xtext1) & xnewline
        x = x & xnewline & tCase("Contents: ") & (xContents) & xnewline
        x = x & xnewline & tCase("Approach: ") & (xapproach) & xnewline
        x = x & xnewline & tCase("Memo: ") & (xmemo) & xnewline
        x = x & xnewline & tCase("Risk Summary: ") & (xrisksummary) & xnewline
        
        x = x & xnewline & tCase("RAG: ") & RAG(UCase(rs1.Fields(7).Value)) & " " & rs1.Fields(8).Value & xnewline
        
        
        If FLAG_SEEKFEEDBACK = "NO" Then
                
                x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
                xlink = xshortname
                xlink = Replace(xlink, "&", "_")
                xlink = Replace(xlink, " ", "_")
                xlink = Replace(xlink, " ", "%20")
                x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                
        End If
        
        
        
        
        flag_listbudgets = "YES"
        If flag_listbudgets = "YES" Then '#########################
                TABLENAME = "HTML_Budgets"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                x = x & xnewline & tCase("BUDGETS") & xnewline
                
                x = x & xnewline & "With the various acquisition streams ongoing, this is just a reminder to advise that various invoices for professional services, travel, accommodation etc should be coded to nominal code 7740 for now, at least until such time as we own any new XZXZXZ and, from there, separate cost centres/nominal codes will be opened in due course."
                x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If 'flag_listbudgets = "YES" Then '#########################
        
        
        
        flagxDeliverables = "YES"
        If flagxDeliverables = "YES" Then  '#########################
                TABLENAME = "HTML_DELIVERABLES"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                x = x & xnewline & tCase("DELIVERABLES") & xnewline
                x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If 'flag = Deliverables = "YES" Then '#########################
        
        
        flag_listsky = "no"
        If flag_listsky = "YES" Then '#########################
                TABLENAME = "HTML_progress"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                x = x & xnewline & tCase("PROGRESS") & xnewline
                x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If ''################################################
        
        '   x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
        xlink = xshortname
        xlink = Replace(xlink, "&", "_")
        xlink = Replace(xlink, " ", "_")
        xlink = Replace(xlink, " ", "%20")
        ' x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
        
        
        
        x = x & xnewline
        '  x = x & "<br/><a href=#TOC>Go Top Table of Contents</a><HR/>"
        
        
        ################################
        
        wscount = wscount + 1
        xfilename = xshortname
        xfilename = Replace(xfilename, " ", "")
        xfilename = Replace(xfilename, "\", "")
        xfilename = Replace(xfilename, "&", "")
        xfilename = Replace(xfilename, ")", "")
        xfilename = Replace(xfilename, "(", "")
        If xflag = "ws" Then
                fname = CurrentProject.path & "\WORK-STREAM " & xfilename & ".html"
                Call PRINT_INFO(xtext, fname)
                ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        End If
        
        fulltext = fulltext & x
        x = ""
        ################################
        
        
        
        rs1.MoveNext
        Loop
        
        fulltext = topheaderdata & fulltext ' add header data to the front!
        
        
        XDATE = Format(Now, "DDD-DD-MMM-YYYY")
        fname = CurrentProject.path & "\PROJECT_LOGAN_LONG_" & XDATE & ".html"
        Call PRINT_INFO(fulltext, fname)
        
        
        ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "...............................................................", x) & vbTab
padd = xtext
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function tCase(x)
tCase = UCase("<b style='color:  #1ac6ff;'>" & x & "</b>")
tCase = UCase("<b style='color: BROWN;'>" & x & "</b>")
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function XRAG(x)
If InStr(1, UCase(x), "#GREY") Then RAG = UCase("<b style='background-color:  #669999;'>" & x & "</b>")
        If InStr(1, UCase(x), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & x & "</b>")
                If InStr(1, UCase(x), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & x & "</b>")
                        If InStr(1, UCase(x), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & x & "</b>")
                                
End Function
Attribute VB_Name = "word_short_reportx"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub word_short_report()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
xnewline = "<br/>" & vbCrLf
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
x = x & vbCrLf & "<html><head><style>"
x = x & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H1 { color: BROWN;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H2 { color: BROWN;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H3 { color: BROWN;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H4 { background-color: red; color: BROWN;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "table { border-collapse: collapse; border: 1px solid black;}"
x = x & vbCrLf & "@media print {"
x = x & vbCrLf & "    h1 {page-break-before: always;}"
x = x & vbCrLf & "}"
x = x & vbCrLf & "</style></head><body>"
INDEXF = 2 ' E2ND FIELD IS THE INDEX
xaname = UCase(rs1.Fields(INDEXF).Value)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
topheaderdata = x ' hold this in a variable that we will call later to add to the top
Do While Not rs1.EOF
        x = "" ' now start blank for each work-stream
        xaname = UCase(rs1.Fields(INDEXF).Value)
        xtitle = UCase(rs1.Fields(INDEXF).Value)
        x = x & vbCrLf & "<p/><a name=" & xaname & ">"
        
        
        xshortname = rs1!ShortName
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        xContents = rs1!Contents
        xapproach = rs1!Approach
        xmemo = rs1!Memo
        xrisksummary = rs1!RiskSummary
        
        
        
        
        x = x & xnewline & "<h1>" & UCase("WORK-STREAM " & xtext2) & "</h1>" & xnewline
        ' x = x & "=============================================================================== " & xnewline
        x = x & xnewline & tCase("Work-Stream Owner: ") & (xtext1) & xnewline
        x = x & xnewline & tCase("Contents: ") & (xContents) & xnewline
        x = x & xnewline & tCase("Approach: ") & (xapproach) & xnewline
        x = x & xnewline & tCase("Memo: ") & (xmemo) & xnewline
        x = x & xnewline & tCase("Risk Summary: ") & (xrisksummary) & xnewline
        
        x = x & xnewline & tCase("RAG: ") & RAG(UCase(rs1.Fields(7).Value)) & " " & rs1.Fields(8).Value & xnewline
        
        
        If FLAG_SEEKFEEDBACK = "NO" Then
                
                x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
                xlink = xshortname
                xlink = Replace(xlink, "&", "_")
                xlink = Replace(xlink, " ", "_")
                xlink = Replace(xlink, " ", "%20")
                x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                
        End If
        
        
        
        
        flag_listbudgets = "no"
        If flag_listbudgets = "YES" Then '#########################
                TABLENAME = "HTML_Budgets"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                x = x & xnewline & tCase("BUDGETS") & xnewline
                
                x = x & xnewline & "With the various acquisition streams ongoing, this is just a reminder to advise that various invoices for professional services, travel, accommodation etc should be coded to nominal code 7740 for now, at least until such time as we own any new XZXZXZ and, from there, separate cost centres/nominal codes will be opened in due course."
                x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If 'flag_listbudgets = "YES" Then '#########################
        
        
        
        flagxDeliverables = "no"
        If flagxDeliverables = "YES" Then  '#########################
                TABLENAME = "HTML_DELIVERABLES"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                x = x & xnewline & tCase("DELIVERABLES") & xnewline
                x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If 'flag = Deliverables = "YES" Then '#########################
        
        
        flag_listsky = "no"
        If flag_listsky = "YES" Then '#########################
                TABLENAME = "HTML_progress"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                x = x & xnewline & tCase("PROGRESS") & xnewline
                x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If ''################################################
        
        '   x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
        xlink = xshortname
        xlink = Replace(xlink, "&", "_")
        xlink = Replace(xlink, " ", "_")
        xlink = Replace(xlink, " ", "%20")
        ' x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
        
        
        
        x = x & xnewline
        '  x = x & "<br/><a href=#TOC>Go Top Table of Contents</a><HR/>"
        
        
        ################################
        
        wscount = wscount + 1
        xfilename = xshortname
        xfilename = Replace(xfilename, " ", "")
        xfilename = Replace(xfilename, "\", "")
        xfilename = Replace(xfilename, "&", "")
        xfilename = Replace(xfilename, ")", "")
        xfilename = Replace(xfilename, "(", "")
        If xflag = "ws" Then
                fname = CurrentProject.path & "\WORK-STREAM " & xfilename & ".html"
                Call PRINT_INFO(xtext, fname)
                ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        End If
        
        fulltext = fulltext & x
        x = ""
        ################################
        
        
        
        rs1.MoveNext
        Loop
        
        fulltext = topheaderdata & fulltext ' add header data to the front!
        
        
        XDATE = Format(Now, "DDD-DD-MMM-YYYY")
        fname = CurrentProject.path & "\PROJECT_LOGAN_SHORT_" & XDATE & ".html"
        Call PRINT_INFO(fulltext, fname)
        
        
        ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function tCase(x)
tCase = UCase("<b style='color:  #1ac6ff;'>" & x & "</b>")
tCase = UCase("<b style='color: BROWN;'>" & x & "</b>")
End Function
Attribute VB_Name = "xbutton01"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub button01()
xto = "XZXZXZ@XZXZXZ.com"
xcc = "XZXZXZ@XZXZXZ.com"
xbody = "XZXZXZ@XZXZXZ.com"
xbody = [Forms].[XZXZXZ_HRdBase]![Name]
xbody = Forms!XZXZXZ_HRdBase!name
xsubject = "XZXZXZ@XZXZXZ.com"
Call access2outlook(xto, xcc, xbody, xsubject)
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function access2outlook(xto, xcc, xbody, xsubject)
outlook from excel
Dim olApp As Outlook.Application
Dim olMail As MailItem
Dim CurrFile As String
Set olApp = New Outlook.Application
Set olMail = olApp.CreateItem(olMailItem)
ActiveWorkbook.Save
CurrFile = ActiveWorkbook.Path & "\" & ActiveWorkbook.Name
With olMail
.To = xto
.CC = xcc
.Subject = xsubject
.Body = xbody
.Attachments.Add CurrFile
.Attachments.Add "c:\My Documents\book.doc"
.Display '.Send
End With
Set olMail = Nothing
Set olApp = Nothing
End Function
Attribute VB_Name = "xbutton01"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub button01()
xto = "XZXZXZ@XZXZXZ.com"
xcc = "XZXZXZ@XZXZXZ.com"
xbody = "XZXZXZ@XZXZXZ.com"
xbody = [Forms].[XZXZXZ_HRdBase]![Name]
xbody = Forms!XZXZXZ_HRdBase!name
xsubject = "XZXZXZ@XZXZXZ.com"
Call access2outlook(xto, xcc, xbody, xsubject)
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function access2outlook(xto, xcc, xbody, xsubject)
outlook from excel
Dim olApp As Outlook.Application
Dim olMail As MailItem
Dim CurrFile As String
Set olApp = New Outlook.Application
Set olMail = olApp.CreateItem(olMailItem)
ActiveWorkbook.Save
CurrFile = ActiveWorkbook.Path & "\" & ActiveWorkbook.Name
With olMail
.To = xto
.CC = xcc
.Subject = xsubject
.Body = xbody
.Attachments.Add CurrFile
.Attachments.Add "c:\My Documents\book.doc"
.Display '.Send
End With
Set olMail = Nothing
Set olApp = Nothing
End Function
Attribute VB_Name = "button_adddate"
Option Compare Database
Private Sub Commandxx_Click()
screen.activeForm.recordset.fields(myFieldname).value
Screen.ActiveForm.Controls(myControl).Value
Screen.ActiveForm.name
value = Forms![NameOfForm]![NameOfTextbox]
x = Forms![NameOfForm]![NameOfTextbox]
x = Forms![workstreamstabs]![Memo]
x = Me.Memo.Value
x = InputBox(x, x, x)
XDATE = Format(Now, "ddd dd/mmm/yy")
Me.Memo.Value = XDATE & vbCrLf & x
End Sub
Attribute VB_Name = "db_backup"
Option Compare Database
Public Function db_backup()
Dim sourceFile As String, destinationFile As String
Dim aFSO As Variant
Dim path As String, name As String
sourceFile = CurrentProject.FullName
path = CurrentProject.path
name = CurrentProject.name
xname_without_suffix = Left(name, Len(name) - 6)
xtime = xf(Hour(Now)) & xf(Minute(Now)) '& xf(Second(Now))
XDATE = Year(Now) & "" & Format(Month(Now), "00") & "" & Format(Day(Now), "00")
destinationFile = path & "\" & xname_without_suffix & "_bkup" & XDATE & "-" & xtime & ".accdb"
Debug.Print path
this removes a file created on the same day
If Dir(destinationFile) <> "" Then
        Kill destinationFile
End If
this creates a backup into destination path
If Dir(destinationFile) = "" Then
        
        Set aFSO = CreateObject("Scripting.FileSystemObject")
        aFSO.CopyFile sourceFile, destinationFile, True
        
        MsgBox "A database backup has been stored under " & destinationFile
        
        x = destinationFile
        x = InputBox(x, x, x)
End If
End Function
Attribute VB_Name = "dowhile_deliver"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_loop()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "deliverables"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        
        xtext = rs1!ShortName
        
        If InStr(1, xtext, "Legal") Then
                
                rs1.Edit
                ' rs1!STATUS = "#GREY"
                rs1!PHASE = "P2-Aquisition"
                rs1.Update
                
        End If
        
        
        rs1.MoveNext
        Loop
        
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "dowhile_documentdb"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_loop()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "TABLE1"
Dim db As DAO.Database
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
rs1.MoveFirst
Dim XARRAY(100)
For x = 0 To rs1.Fields.Count - 1
        XARRAY(x + 1) = rs1.Fields(x).Value ' x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
rs1.Close
Set rs1 = Nothing
db.Close
Set db = Nothing
###################################
Dim db As DAO.Database
Dim tbl As DAO.TableDef
Dim fld As DAO.Field
Dim n As Integer
Set db = CurrentDb
Set tbl = db.TableDefs("TABLE1")
On Error Resume Next
n = 0
For Each fld In tbl.Fields
        n = n + 1
        fld.name = XARRAY(n)
Next fld
Set fld = Nothing
Set tbl = Nothing
Set db = Nothing
rs1.Close
Set rs1 = Nothing
rs2.Close
Set rs2 = Nothing
db.Close
Set db = Nothing
End Sub
Attribute VB_Name = "dowhile_ws"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_loop2017()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "workstreams"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        If IsNull(rs1!Memo) Then
                skip
                Else
                xtext = rs1!Memo
                xtext = Replace(xtext, vbCrLf, "//")
                
                rs1.Edit
                rs1!Memo = xtext
                
                rs1.Update
        End If
        
        
        rs1.MoveNext
        Loop
        
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "GETTABLE_2HTMLmod"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub test01()
TABLENAME = "HTML_DELIVERABLES"
FIRSTCOLUMNMATCH = "Legal&Contracts"
x = GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
Debug.Print x
xtext = x
fname = CurrentProject.path & "\TEMP.html"
Call PRINT_INFO(xtext, fname)
ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = TABLENAME
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "" '"<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
rs1.MoveFirst
xtext = xtext & "<TABLE BORDER=2 WIDTH=900>"
############################### table headers
xtext = xtext & "<tr>"
xtext = xtext & "<TD VALIGN=TOP>No.</td>"
For x = 0 To rs1.Fields.Count - 1
        xtext = xtext & "<TD VALIGN=TOP><b>"
        xtext = xtext & xnewline & UCase(rs1.Fields(x).name)
        xtext = xtext & "</b></TD>"
Next x
xtext = xtext & "</tr>"
######################################### table details
lineno = 0
Do While Not rs1.EOF
        
        xtext = xtext & xnewline
        If rs1.Fields(0).Value = FIRSTCOLUMNMATCH Then
                lineno = lineno + 1
                xtext = xtext & "<tr> <td VALIGN=TOP>" & Format(lineno, "00") & "  </td>"
                
                
                For x = 0 To rs1.Fields.Count - 1
                        xtext = xtext & "<TD VALIGN=TOP>"
                        If InStr(1, rs1.Fields(x).Value, "#") Then
                                xtext = xtext & xnewline & RAG(rs1.Fields(x).Value)
                                Else
                                
                                xtext = xtext & xnewline & (rs1.Fields(x).Value)
                        End If
                        xtext = xtext & "</TD>"
                Next x
                
                xtext = xtext & "</tr>"
                
        End If
        rs1.MoveNext
        Loop
        xtext = xtext & "</TABLE>"
        
        
        GETTABLE_2HTML = xtext
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "                                                                                                                ", x) & vbTab
End Function
Attribute VB_Name = "INTRANET"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub INTRANET01()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
xnewline = "<br/>" & vbCrLf
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
x = x & vbCrLf & "<html><head><style>"
x = x & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "table { border-collapse: collapse; border: 1px solid black;}"
x = x & vbCrLf & "</style></head><body>"
###looop 1 get index
rs1.MoveFirst
x = x & vbCrLf & "<h1>PROJECT SKY ONE PAGE INTRANET</h1>"
x = x & vbCrLf & "<P> " & Format(Now, "DD/MMM/YYYY")
x = x & vbCrLf & "<BR/> Commercial and Confidential"
x = x & vbCrLf & "<BR/> If there are any errors, omissions or necessary update or changes please contact <a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud>Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051"
x = x & vbCrLf & "<BR/> "
x = x & vbCrLf & "<h1>TABLE OF CONTENTS <a name=TOC></h1>"
x = x & "<table BORDER=1>"
Do While Not rs1.EOF
        
        
        INDEXF = 2 ' E2ND FIELD IS THE INDEX
        
        xtext = xtext & xnewline & UCase(rs1.Fields(INDEXF).name) & ": " & rs1.Fields(INDEXF).Value
        xaname = UCase(rs1.Fields(INDEXF).Value)
        xtitle = UCase(rs1.Fields(INDEXF).Value)
        xc = xc + 1
        x = x & "<tr><td>" & Format(xc, " 00 ") & "<a href=#" & xaname & ">" & xtitle & "</a></td><td>" & rs1.Fields(1).Value & "</td><td>" & RAG(UCase(rs1.Fields(7).Value)) & "</td><td>" & (rs1.Fields(8).Value) & "</td></tr>"
        
        
        
        
        rs1.MoveNext
        Loop
        x = x & "</table>"
        x = x & xnewline
        x = x & xnewline
        ###loop 2 get data
        
        
        rs1.MoveFirst
        
        For x = 0 To rs1.Fields.Count - 1
                Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
        Next x
        
        prev_xtext1 = ""
        prev_xtext2 = ""
        
        topheaderdata = x ' hold this in a variable that we will call later to add to the top
        
        Do While Not rs1.EOF
                x = "" ' now start blank for each work-stream
                xaname = UCase(rs1.Fields(INDEXF).Value)
                xtitle = UCase(rs1.Fields(INDEXF).Value)
                x = x & vbCrLf & "<p/><a name=" & xaname & ">"
                
                
                xshortname = rs1!ShortName
                xtext1 = rs1!OWNER
                xtext2 = rs1!WORKSTREAM
                xContents = rs1!Contents
                xapproach = rs1!Approach
                xmemo = rs1!Memo
                xrisksummary = rs1!RiskSummary
                
                
                
                
                x = x & xnewline & "<h1>" & tCase("WORK-STREAM " & xtext2) & "</h1>" & xnewline
                ' x = x & "=============================================================================== " & xnewline
                x = x & xnewline & tCase("Work-Stream Owner: ") & (xtext1) & xnewline
                x = x & xnewline & tCase("Contents: ") & (xContents) & xnewline
                x = x & xnewline & tCase("Approach: ") & (xapproach) & xnewline
                x = x & xnewline & tCase("Memo: ") & (xmemo) & xnewline
                x = x & xnewline & tCase("Risk Summary: ") & (xrisksummary) & xnewline
                
                x = x & xnewline & tCase("RAG: ") & RAG(UCase(rs1.Fields(7).Value)) & " " & rs1.Fields(8).Value & xnewline
                
                
                x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
                xlink = xshortname
                xlink = Replace(xlink, "&", "_")
                xlink = Replace(xlink, " ", "_")
                xlink = Replace(xlink, " ", "%20")
                x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                
                
                
                
                
                
                flag_listbudgets = "YES"
                If flag_listbudgets = "YES" Then '#########################
                        TABLENAME = "HTML_Budgets"
                        FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                        x = x & xnewline & tCase("BUDGETS") & xnewline
                        
                        x = x & xnewline & "With the various acquisition streams ongoing, this is just a reminder to advise that various invoices for professional services, travel, accommodation etc should be coded to nominal code 7740 for now, at least until such time as we own any new XZXZXZ and, from there, separate cost centres/nominal codes will be opened in due course."
                        x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
                End If 'flag_listbudgets = "YES" Then '#########################
                
                
                
                flagxDeliverables = "YES"
                If flagxDeliverables = "YES" Then  '#########################
                        TABLENAME = "HTML_DELIVERABLES"
                        FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                        x = x & xnewline & tCase("DELIVERABLES") & xnewline
                        x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
                End If 'flag = Deliverables = "YES" Then '#########################
                
                
                flag_listsky = "no"
                If flag_listsky = "YES" Then '#########################
                        TABLENAME = "HTML_progress"
                        FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                        x = x & xnewline & tCase("PROGRESS") & xnewline
                        x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
                End If ''################################################
                
                '   x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
                xlink = xshortname
                xlink = Replace(xlink, "&", "_")
                xlink = Replace(xlink, " ", "_")
                xlink = Replace(xlink, " ", "%20")
                ' x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                
                
                
                x = x & xnewline
                x = x & "<br/><a href=#TOC>Go Top Table of Contents</a><HR/>"
                
                
                ################################
                
                wscount = wscount + 1
                xfilename = xshortname
                xfilename = Replace(xfilename, " ", "")
                xfilename = Replace(xfilename, "\", "")
                xfilename = Replace(xfilename, "&", "")
                xfilename = Replace(xfilename, ")", "")
                xfilename = Replace(xfilename, "(", "")
                If xflag = "ws" Then
                        fname = CurrentProject.path & "\WORK-STREAM " & xfilename & ".html"
                        Call PRINT_INFO(xtext, fname)
                        ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
                End If
                
                fulltext = fulltext & x
                x = ""
                ################################
                
                
                
                rs1.MoveNext
                Loop
                
                fulltext = topheaderdata & fulltext ' add header data to the front!
                
                
                XDATE = Format(Now, "DDD-DD-MMM-YYYY")
                fname = CurrentProject.path & "\PROJECT_SKY_PLANS_" & XDATE & ".html"
                Call PRINT_INFO(fulltext, fname)
                
                
                ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "...............................................................", x) & vbTab
padd = xtext
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function tCase(x)
tCase = UCase("<b style='color:  #1ac6ff;'>" & x & "</b>")
tCase = UCase("<b style='color:  blue;'>" & x & "</b>")
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function RAG(x)
If InStr(1, UCase(x), "#GREY") Then RAG = UCase("<b style='background-color:  #669999;'>" & x & "</b>")
        If InStr(1, UCase(x), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & x & "</b>")
                If InStr(1, UCase(x), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & x & "</b>")
                        If InStr(1, UCase(x), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & x & "</b>")
                                
End Function
Attribute VB_Name = "list_databasefields"
Option Compare Database
Public Sub showtdf()
Dim db As Database
Dim tdf As TableDef
Dim x As Integer
Set db = CurrentDb
For Each tdf In db.TableDefs
        Debug.Print tdf.name,
        
        If InStr(1, tdf.name, "List") Then
                Debug.Print tdf.Fields.Count
                For x = 0 To tdf.Fields.Count - 1
                        Debug.Print tdf.Fields(x).name
                Next x
        End If
Next tdf
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub dbasedoc()
Call listQueryFields("Summary List for Exec")
Call listQueryFields("List of Projects")
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function listQueryFields(strQryName As String) As String
On Error GoTo listQueryFields_Error
Dim db As DAO.Database
Dim qryfld As DAO.QueryDef
Dim fld As Field
Set db = CurrentDb()
Set qryfld = db.QueryDefs(strQryName)
For Each fld In qryfld.Fields    'loop through all the fields of the Query
        Debug.Print fld.name
        Next
        
        Error_Handler_Exit:
        Set qryfld = Nothing
        Set db = Nothing
        Exit Function
        
        listQueryFields_Error:
        MsgBox "MS Access has generated the following error" & vbCrLf & vbCrLf & "Error Number: " & _
        Err.Number & vbCrLf & "Error Source: listQueryFields" & vbCrLf & _
        "Error Description: " & Err.DESCRIPTION, vbCritical, "An Error has Occured!"
        Resume Error_Handler_Exit
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub test01()
Dim z As Long
Dim y As Long
While Err.Number = 0
        On Error Resume Next
        While Err.Number = 0
                On Error Resume Next
                Debug.Print DBEngine(0)(0)(z)(y).name
                y = y + 1
                Wend
                If y > 1 Then
                        Err.Number = 0
                        y = 0
                        z = z + 1
                End If
                Wend
End Sub
Attribute VB_Name = "Module_various"
Attribute VB_Name = "outlook2access"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub STEP2_TEST()
Dim myOlApp As New Outlook.Application
Dim myOlExp As Outlook.Explorer
Dim myOlSel As Outlook.Selection
Dim MsgTxt As String
Dim x As Integer
Set myOlExp = myOlApp.ActiveExplorer
Set myOlSel = myOlExp.Selection
On Error Resume Next
r = 2
for all items do...
For Each currentItem In myOlSel
        
        r = r + 1
        
        X1 = currentItem.SenderName
        X2 = currentItem.To
        x3 = currentItem.ReceivedTime
        X4 = currentItem.Subject
        'x5 = sieve(currentItem.Body)
        x5 = (currentItem.Body)
        X6 = ztext
        
        XATTACH_LIST = ""
        For Each objAtt In currentItem.Attachments
                XATTACH_LIST = XATTACH_LIST & objAtt.DisplayName & vbCrLf
                
                Next
                X7 = XATTACH_LIST
                
                Debug.Print X1, X2, x3, X4, x5
                
                Next
                '  ztext = sieve(xtext)
                Debug.Print ztext
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub STEP1_GET_SELECTED_EMAILS()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "Table1"
xsql2 = "Query2"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
Do While Not rs1.EOF
        
        
        Dim myOlApp As New Outlook.Application
        Dim myOlExp As Outlook.Explorer
        Dim myOlSel As Outlook.Selection
        Dim MsgTxt As String
        
        Set myOlExp = myOlApp.ActiveExplorer
        Set myOlSel = myOlExp.Selection
        On Error Resume Next
        
        rs1.MoveLast
        '##############################################################################
        For Each currentItem In myOlSel
                X1 = currentItem.SenderName
                X2 = currentItem.To
                x3 = currentItem.ReceivedTime
                X4 = currentItem.Subject
                'x5 = sieve(currentItem.Body)
                x5 = "BLANK"
                x5 = (currentItem.Body)
                X6 = ztext
                
                XATTACH_LIST = ""
                For Each objAtt In currentItem.Attachments
                        XATTACH_LIST = XATTACH_LIST & objAtt.DisplayName & vbCrLf
                        
                        Next
                        X7 = XATTACH_LIST
                        
                        
                        ###################################
                        xc = xc + 1
                        Debug.Print xc, x3, X4
                        'rs1.Delete
                        rs1.AddNew
                        
                        rs1!F1 = X1
                        rs1!F2 = X2
                        rs1!F3 = x3
                        rs1!F4 = X4
                        rs1!F5 = x5
                        rs1!F6 = X6
                        rs1!F7 = X7
                        rs1.Update
                        
                        
                        
                        '###################################
                        
                        Next
                        
                        
                        
                        rs1.MoveNext
                        Loop
                        
                        
                        rs1.Close
                        Set rs1 = Nothing
                        rs2.Close
                        Set rs2 = Nothing
                        db.Close
                        Set db = Nothing
                        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function xf(x)
xf = Format(x, "00")
End Function
Attribute VB_Name = "outlook2access"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub STEP2_TEST()
Dim myOlApp As New Outlook.Application
Dim myOlExp As Outlook.Explorer
Dim myOlSel As Outlook.Selection
Dim MsgTxt As String
Dim x As Integer
Set myOlExp = myOlApp.ActiveExplorer
Set myOlSel = myOlExp.Selection
On Error Resume Next
r = 2
for all items do...
For Each currentItem In myOlSel
        
        r = r + 1
        
        X1 = currentItem.SenderName
        X2 = currentItem.To
        x3 = currentItem.ReceivedTime
        X4 = currentItem.Subject
        'x5 = sieve(currentItem.Body)
        x5 = (currentItem.Body)
        X6 = ztext
        
        XATTACH_LIST = ""
        For Each objAtt In currentItem.Attachments
                XATTACH_LIST = XATTACH_LIST & objAtt.DisplayName & vbCrLf
                
                Next
                X7 = XATTACH_LIST
                
                Debug.Print X1, X2, x3, X4, x5
                
                Next
                '  ztext = sieve(xtext)
                Debug.Print ztext
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub STEP1_GET_SELECTED_EMAILS()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "Table1"
xsql2 = "Query2"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
Do While Not rs1.EOF
        
        
        Dim myOlApp As New Outlook.Application
        Dim myOlExp As Outlook.Explorer
        Dim myOlSel As Outlook.Selection
        Dim MsgTxt As String
        
        Set myOlExp = myOlApp.ActiveExplorer
        Set myOlSel = myOlExp.Selection
        On Error Resume Next
        
        rs1.MoveLast
        '##############################################################################
        For Each currentItem In myOlSel
                X1 = currentItem.SenderName
                X2 = currentItem.To
                x3 = currentItem.ReceivedTime
                X4 = currentItem.Subject
                'x5 = sieve(currentItem.Body)
                x5 = "BLANK"
                x5 = (currentItem.Body)
                X6 = ztext
                
                XATTACH_LIST = ""
                For Each objAtt In currentItem.Attachments
                        XATTACH_LIST = XATTACH_LIST & objAtt.DisplayName & vbCrLf
                        
                        Next
                        X7 = XATTACH_LIST
                        
                        
                        ###################################
                        xc = xc + 1
                        Debug.Print xc, x3, X4
                        'rs1.Delete
                        rs1.AddNew
                        
                        rs1!F1 = X1
                        rs1!F2 = X2
                        rs1!F3 = x3
                        rs1!F4 = X4
                        rs1!F5 = x5
                        rs1!F6 = X6
                        rs1!F7 = X7
                        rs1.Update
                        
                        
                        
                        '###################################
                        
                        Next
                        
                        
                        
                        rs1.MoveNext
                        Loop
                        
                        
                        rs1.Close
                        Set rs1 = Nothing
                        rs2.Close
                        Set rs2 = Nothing
                        db.Close
                        Set db = Nothing
                        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function xf(x)
xf = Format(x, "00")
End Function
Attribute VB_Name = "print_infox"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function PRINT_INFO(ByVal PARAM_TEXT As String, ByVal xoutput As String) 'vba_excel report cells, create file, print file, notepad
Dim FILENUMBER1 As Integer
Dim xpath As String
Dim xfilename As String
xpath = ActiveWorkbook.Path & "\"
xfilename = "TEMP" & Format(Now(), "yymmdd") & "-" & Format(Now(), "HHMM") & ".txt"
xfilename = xoutput
FILENUMBER1 = FreeFile
Open xpath & xfilename For Output As #FILENUMBER1 '
Print #FILENUMBER1, PARAM_TEXT
Close #FILENUMBER1
Call open_file(xpath & xfilename)
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function open_file(xfilename As String)
vba_excel report cells, create file, print file, notepad
Dim ReturnValue, I
ReturnValue = Shell("notepad.EXE " & xfilename, 1)  ' Run Calculator.
AppActivate ReturnValue
End Function
Attribute VB_Name = "report"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_reports()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "query2"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
Do While Not rs1.EOF
        
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        If xtext1 <> prev_xtext1 Then
                x = x & vbCrLf & "Work-Stream Owner: " & (xtext1) & vbCrLf
                xc = 0
                prev_xtext1 = xtext1
        End If
        xc = xc + 1
        x = x & " " & xc & " " & xtext2 & vbCrLf
        
        
        
        rs1.MoveNext
        Loop
        
        Debug.Print x
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_reports2wkly()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
Do While Not rs1.EOF
        
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        xContents = rs1!Contents
        xapproach = rs1!Approach
        xmemo = rs1!Memo
        lprogress = rs1!wsProgress
        lrisk = rs1!wsRisks
        lnext = rs1!wsnext
        
        gprogress = rs1!gprogress
        grisk = rs1!grisk
        gnext = rs1!gnext
        
        
        
        If xtext1 <> prev_xtext1 Then
                x = x & vbCrLf & UCase(xtext2) & vbCrLf
                x = x & vbCrLf & "Work-Stream Owner: " & (xtext1) & vbCrLf
                x = x & vbCrLf & "Contents: " & (xContents) & vbCrLf
                x = x & vbCrLf & "Approach: " & (xapproach) & vbCrLf
                x = x & vbCrLf & "Memo: " & (xmemo) & vbCrLf
                
                xc = 0
                prev_xtext1 = xtext1
        End If
        xc = xc + 1
        x = x & vbCrLf & "PROJECT SKY WORK" & vbCrLf
        
        x = x & vbCrLf & "Progress: " & (lprogress) & vbCrLf
        x = x & vbCrLf & "Risk: " & (lrisk) & vbCrLf
        x = x & vbCrLf & "Next: " & (lnext) & vbCrLf
        
        x = x & vbCrLf & "PROJECT GREENHOUSE WORK " & vbCrLf
        
        x = x & vbCrLf & "Progress: " & (gprogress) & vbCrLf
        x = x & vbCrLf & "Risk: " & (grisk) & vbCrLf
        x = x & vbCrLf & "Next: " & (grisk) & vbCrLf
        
        
        rs1.MoveNext
        Loop
        
        Debug.Print x
        fname = CurrentProject.path & "\TEMP.TXT"
        Call PRINT_INFO(x, fname)
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "reports_2notepad"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub reports02_2wkly2()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
Do While Not rs1.EOF
        
        
        xshortname = rs1!ShortName
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        xContents = rs1!Contents
        xapproach = rs1!Approach
        xmemo = rs1!Memo
        xrisksummary = rs1!RiskSummary
        lprogress = rs1!wsProgress
        lrisk = rs1!wsRisks
        lnext = rs1!wsnext
        
        gprogress = rs1!gprogress
        grisk = rs1!grisk
        gnext = rs1!gnext
        
        
        
        If xtext1 <> prev_xtext1 Then
                x = x & vbCrLf & "WORK-STREAM " & UCase(xtext2) & vbCrLf
                x = x & "=============================================================================== " & vbCrLf
                x = x & vbCrLf & UCase("Work-Stream Owner: ") & (xtext1) & vbCrLf
                x = x & vbCrLf & UCase("Contents: ") & (xContents) & vbCrLf
                x = x & vbCrLf & UCase("Approach: ") & (xapproach) & vbCrLf
                x = x & vbCrLf & UCase("Memo: ") & (xmemo) & vbCrLf
                x = x & vbCrLf & UCase("Risk Summary: ") & (xrisksummary) & vbCrLf
                
                prev_xtext1 = xtext1
        End If
        
        
        
        
        
        
        
        If flag_listsky = "YES" Then '#########################
                xc = 0
                xc = xc + 1
                x = x & vbCrLf & "PROJECT SKY WORK" & vbCrLf
                
                x = x & vbCrLf & "Progress: " & (lprogress) & vbCrLf
                x = x & vbCrLf & "Risk: " & (lrisk) & vbCrLf
                x = x & vbCrLf & "Next: " & (lnext) & vbCrLf
                
        End If ''################################################
        
        
        
        ' flag_listbudgets = "YES"
        If flag_listbudgets = "YES" Then '#########################
                
                '### budgets ######
                rs2.MoveFirst
                xd = vbTab
                XSUM = 0
                x = x & vbCrLf & "BUDGETS" & vbCrLf
                Do While Not rs2.EOF
                        
                        zshortname = rs2!ShortName
                        If zshortname = xshortname Then
                                x = x & vbCrLf & padd(rs2!Item, 10) & padd(rs2!desc, 20) & padd(rs2!capex, 10) & padd(rs2!notes, 20)
                                '  x = x & vbCrLf & rs2!Item & xd & rs2!desc & xd & rs2!capex & xd & rs2!revex & xd & rs2!notes
                                XSUM = XSUM + rs2!capex
                        End If
                        
                        rs2.MoveNext
                        Loop
                        x = x & vbCrLf & "TOTAL  " & Format(XSUM, "0,000.00") & vbCrLf
                        
                End If 'flag_listbudgets = "YES" Then '#########################
                
                
                
                
                If flag = deliverables = "YES" Then '#########################
                        '### deliverables ######
                        rs3.MoveFirst
                        xd = vbTab
                        xc = 0
                        x = x & vbCrLf & "DELIVERABLES (Tasks to do or documents to draft/approve)" & vbCrLf
                        Do While Not rs3.EOF
                                Dshortname = rs3!ShortName
                                XDELIVERABLE = rs3!PRODUCT_DELIVERABLE
                                XDESCRIPTION = rs3!DESCRIPTION
                                If Dshortname = xshortname Then
                                        xc = xc + 1
                                        x = x & vbCrLf & Format(xc, " 00 ") & XDELIVERABLE
                                        '  x = x & vbCrLf & rs2!Item & xd & rs2!desc & xd & rs2!capex & xd & rs2!revex & xd & rs2!notes
                                        
                                End If
                                
                                rs3.MoveNext
                                Loop
                                x = x & vbCrLf & vbCrLf
                                
                        End If 'flag = Deliverables = "YES" Then '#########################
                        
                        
                        
                        
                        If flag_listgreenhouse = "YES" Then '========================================================
                                x = x & vbCrLf & "PROJECT GREENHOUSE WORK " & vbCrLf
                                x = x & vbCrLf & "Progress: " & (gprogress) & vbCrLf
                                x = x & vbCrLf & "Risk: " & (grisk) & vbCrLf
                                x = x & vbCrLf & "Next: " & (grisk) & vbCrLf
                        End If '========================================================
                        
                        
                        
                        rs1.MoveNext
                        Loop
                        
                        Debug.Print x
                        fname = CurrentProject.path & "\TEMP.TXT"
                        Call PRINT_INFO(x, fname)
                        
                        rs1.Close
                        rs2.Close
                        rs3.Close
                        Set rs1 = Nothing
                        Set rs2 = Nothing
                        Set rs3 = Nothing
                        
                        db.Close
                        Set db = Nothing
                        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "                                                                                                                ", x) & vbTab
End Function
Attribute VB_Name = "table2html_riskrept"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2html_notoc()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "HTML_REPORT"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
###loop 2 get data
xtext = xtext & "<table border>"
rs1.MoveFirst
xtext = xtext & "<tr>"
For x = 0 To rs1.Fields.Count - 1
        xtext = xtext & "<td>" & UCase(rs1.Fields(x).name) & "</td>"
        xtext = xtext
Next x
xtext = xtext & "</tr>"
Do While Not rs1.EOF
        
        
        
        
        
        xtext = xtext & "<tr>"
        For x = 0 To rs1.Fields.Count - 1
                xtext = xtext & "<td>" & rs1.Fields(x).Value & "</td>"
                xtext = xtext
        Next x
        xtext = xtext & "</tr>"
        
        
        rs1.MoveNext
        Loop
        
        xtext = xtext & "</table>"
        Debug.Print x
        fname = CurrentProject.path & "\TEMP.html"
        Call PRINT_INFO(xtext, fname)
        
        
        ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "table2html_riskrept"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2html_notoc()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "HTML_REPORT"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
###loop 2 get data
xtext = xtext & "<table border>"
rs1.MoveFirst
xtext = xtext & "<tr>"
For X = 0 To rs1.Fields.Count - 1
        xtext = xtext & "<td>" & UCase(rs1.Fields(X).name) & "</td>"
        xtext = xtext
Next X
xtext = xtext & "</tr>"
Do While Not rs1.EOF
        
        
        
        
        
        xtext = xtext & "<tr>"
        For X = 0 To rs1.Fields.Count - 1
                xtext = xtext & "<td>" & rs1.Fields(X).Value & "</td>"
                xtext = xtext
        Next X
        xtext = xtext & "</tr>"
        
        
        rs1.MoveNext
        Loop
        
        xtext = xtext & "</table>"
        Debug.Print X
        fname = CurrentProject.path & "\TEMP.html"
        Call PRINT_INFO(xtext, fname)
        
        
        ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "table2report"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2report()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        
        
        xtext = xtext & vbCrLf
        xtext = xtext & "=============================="
        For x = 0 To rs1.Fields.Count - 1
                xtext = xtext & vbCrLf & UCase(rs1.Fields(x).name) & ": " & rs1.Fields(x).Value
                xtext = xtext & vbCrLf
        Next x
        
        
        
        
        'rs1.Edit
        'rs1!Detail = xtext
        'rs1.Update
        
        
        
        
        rs1.MoveNext
        Loop
        
        
        Debug.Print x
        fname = CurrentProject.path & "\TEMP.TXT"
        Call PRINT_INFO(xtext, fname)
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "                                                                                                                ", x) & vbTab
End Function
Attribute VB_Name = "update_dowhile01"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub update_dowhile()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "projecthandbook"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        
        
        rs1.Edit
        If IsNull(rs1!Internal) Then rs1!Internal = "For Internal Projects "
                If IsNull(rs1!XZXZXZ) Then rs1!XZXZXZ = "For XZXZXZ Projects "
                        If IsNull(rs1!Development) Then rs1!Development = "For Development Projects "
                                If IsNull(rs1!Acquisitions) Then rs1!Acquisitions = "For Acquisition Projects "
                                        
                                        rs1.Update
                                        
                                        
                                        
                                        rs1.MoveNext
                                        Loop
                                        
                                        
                                        rs1.Close
                                        Set rs1 = Nothing
                                        rs2.Close
                                        Set rs2 = Nothing
                                        db.Close
                                        Set db = Nothing
                                        
End Sub
Attribute VB_Name = "vba_export_modulx"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub vba_export_modules()
#http://www.cpearson.com/Excel/VBE.aspx
 reference to extensibility library
xprefix = "C:\Users\Tim\Documents\Data2017\VBA\VBAAccess\vba_"
Dim objMyProj As VBProject
Dim objVBComp As VBComponent
Set objMyProj = Application.VBE.ActiveVBProject
For Each objVBComp In objMyProj.VBComponents
        If objVBComp.Type = vbext_ct_StdModule Then
                Debug.Print "Exporting " & xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".txt"
                
                objVBComp.Export xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".bas"
                objVBComp.Export xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".txt"
                
        End If
        Next
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function PRINT_INFO1(ByVal PARAM_TEXT As String, ByVal xoutput As String) 'vba_excel report cells, create file, print file, notepad
Dim FILENUMBER1 As Integer
Dim xpath As String
Dim xfilename As String
xpath = ActiveWorkbook.Path & "\"
xfilename = "TEMP" & Format(Now(), "yymmdd") & "-" & Format(Now(), "HHMM") & ".txt"
xfilename = xoutput
FILENUMBER1 = FreeFile
Open xpath & xfilename For Output As #FILENUMBER1 '
Print #FILENUMBER1, PARAM_TEXT
Close #FILENUMBER1
Call open_file(xpath & xfilename)
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function open_file(xfilename As String)
vba_excel report cells, create file, print file, notepad
Dim ReturnValue, I
ReturnValue = Shell("notepad.EXE " & xfilename, 1)  ' Run Calculator.
AppActivate ReturnValue
End Function
Attribute VB_Name = "word_short_reportx"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub word_short_report()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
xnewline = "<br/>" & vbCrLf
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
x = x & vbCrLf & "<html><head><style>"
x = x & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H1 { color: BROWN;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H2 { color: BROWN;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H3 { color: BROWN;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H4 { background-color: red; color: BROWN;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "table { border-collapse: collapse; border: 1px solid black;}"
x = x & vbCrLf & "@media print {"
x = x & vbCrLf & "    h1 {page-break-before: always;}"
x = x & vbCrLf & "}"
x = x & vbCrLf & "</style></head><body>"
INDEXF = 2 ' E2ND FIELD IS THE INDEX
xaname = UCase(rs1.Fields(INDEXF).Value)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
topheaderdata = x ' hold this in a variable that we will call later to add to the top
Do While Not rs1.EOF
        x = "" ' now start blank for each work-stream
        xaname = UCase(rs1.Fields(INDEXF).Value)
        xtitle = UCase(rs1.Fields(INDEXF).Value)
        x = x & vbCrLf & "<p/><a name=" & xaname & ">"
        
        
        xshortname = rs1!ShortName
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        xContents = rs1!Contents
        xapproach = rs1!Approach
        xmemo = rs1!Memo
        xrisksummary = rs1!RiskSummary
        
        
        
        
        x = x & xnewline & "<h1>" & UCase("WORK-STREAM " & xtext2) & "</h1>" & xnewline
        ' x = x & "=============================================================================== " & xnewline
        x = x & xnewline & tCase("Work-Stream Owner: ") & (xtext1) & xnewline
        x = x & xnewline & tCase("Contents: ") & (xContents) & xnewline
        x = x & xnewline & tCase("Approach: ") & (xapproach) & xnewline
        x = x & xnewline & tCase("Memo: ") & (xmemo) & xnewline
        x = x & xnewline & tCase("Risk Summary: ") & (xrisksummary) & xnewline
        
        x = x & xnewline & tCase("RAG: ") & RAG(UCase(rs1.Fields(7).Value)) & " " & rs1.Fields(8).Value & xnewline
        
        
        If FLAG_SEEKFEEDBACK = "NO" Then
                
                x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
                xlink = xshortname
                xlink = Replace(xlink, "&", "_")
                xlink = Replace(xlink, " ", "_")
                xlink = Replace(xlink, " ", "%20")
                x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                
        End If
        
        
        
        
        flag_listbudgets = "no"
        If flag_listbudgets = "YES" Then '#########################
                TABLENAME = "HTML_Budgets"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                x = x & xnewline & tCase("BUDGETS") & xnewline
                
                x = x & xnewline & "With the various acquisition streams ongoing, this is just a reminder to advise that various invoices for professional services, travel, accommodation etc should be coded to nominal code 7740 for now, at least until such time as we own any new XZXZXZ and, from there, separate cost centres/nominal codes will be opened in due course."
                x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If 'flag_listbudgets = "YES" Then '#########################
        
        
        
        flagxDeliverables = "no"
        If flagxDeliverables = "YES" Then  '#########################
                TABLENAME = "HTML_DELIVERABLES"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                x = x & xnewline & tCase("DELIVERABLES") & xnewline
                x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If 'flag = Deliverables = "YES" Then '#########################
        
        
        flag_listsky = "no"
        If flag_listsky = "YES" Then '#########################
                TABLENAME = "HTML_progress"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                x = x & xnewline & tCase("PROGRESS") & xnewline
                x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If ''################################################
        
        '   x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
        xlink = xshortname
        xlink = Replace(xlink, "&", "_")
        xlink = Replace(xlink, " ", "_")
        xlink = Replace(xlink, " ", "%20")
        ' x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
        
        
        
        x = x & xnewline
        '  x = x & "<br/><a href=#TOC>Go Top Table of Contents</a><HR/>"
        
        
        ################################
        
        wscount = wscount + 1
        xfilename = xshortname
        xfilename = Replace(xfilename, " ", "")
        xfilename = Replace(xfilename, "\", "")
        xfilename = Replace(xfilename, "&", "")
        xfilename = Replace(xfilename, ")", "")
        xfilename = Replace(xfilename, "(", "")
        If xflag = "ws" Then
                fname = CurrentProject.path & "\WORK-STREAM " & xfilename & ".html"
                Call PRINT_INFO(xtext, fname)
                ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        End If
        
        fulltext = fulltext & x
        x = ""
        ################################
        
        
        
        rs1.MoveNext
        Loop
        
        fulltext = topheaderdata & fulltext ' add header data to the front!
        
        
        XDATE = Format(Now, "DDD-DD-MMM-YYYY")
        fname = CurrentProject.path & "\PROJECT_LOGAN_SHORT_" & XDATE & ".html"
        Call PRINT_INFO(fulltext, fname)
        
        
        ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function tCase(x)
tCase = UCase("<b style='color:  #1ac6ff;'>" & x & "</b>")
tCase = UCase("<b style='color: BROWN;'>" & x & "</b>")
End Function
Attribute VB_Name = "xbutton01"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub button01()
xto = "XZXZXZ@XZXZXZ.com"
xcc = "XZXZXZ@XZXZXZ.com"
xbody = "XZXZXZ@XZXZXZ.com"
xbody = [Forms].[XZXZXZ_HRdBase]![Name]
xbody = Forms!XZXZXZ_HRdBase!name
xsubject = "XZXZXZ@XZXZXZ.com"
Call access2outlook(xto, xcc, xbody, xsubject)
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function access2outlook(xto, xcc, xbody, xsubject)
outlook from excel
Dim olApp As Outlook.Application
Dim olMail As MailItem
Dim CurrFile As String
Set olApp = New Outlook.Application
Set olMail = olApp.CreateItem(olMailItem)
ActiveWorkbook.Save
CurrFile = ActiveWorkbook.Path & "\" & ActiveWorkbook.Name
With olMail
.To = xto
.CC = xcc
.Subject = xsubject
.Body = xbody
.Attachments.Add CurrFile
.Attachments.Add "c:\My Documents\book.doc"
.Display '.Send
End With
Set olMail = Nothing
Set olApp = Nothing
End Function
Attribute VB_Name = "db_backup"
Option Compare Database
Public Function db_backup()
Dim sourceFile As String, destinationFile As String
Dim aFSO As Variant
Dim path As String, name As String
sourceFile = CurrentProject.FullName
path = CurrentProject.path
name = CurrentProject.name
xname_without_suffix = Left(name, Len(name) - 6)
xtime = xf(Hour(Now)) & xf(Minute(Now)) '& xf(Second(Now))
xdate = Year(Now) & "" & Format(Month(Now), "00") & "" & Format(Day(Now), "00")
destinationFile = path & "\" & xname_without_suffix & "_bkup" & xdate & "-" & xtime & ".accdb"
Debug.Print path
this removes a file created on the same day
If Dir(destinationFile) <> "" Then
        Kill destinationFile
End If
this creates a backup into destination path
If Dir(destinationFile) = "" Then
        
        Set aFSO = CreateObject("Scripting.FileSystemObject")
        aFSO.CopyFile sourceFile, destinationFile, True
        
        MsgBox "A database backup has been stored under " & destinationFile
        
        X = destinationFile
        X = InputBox(X, X, X)
End If
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function xf(X)
xf = X
End Function
Attribute VB_Name = "dowhile_deliver"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_loop()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "deliverables"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        
        xtext = rs1!ShortName
        
        If InStr(1, xtext, "Legal") Then
                
                rs1.Edit
                ' rs1!STATUS = "#GREY"
                rs1!PHASE = "P2-Aquisition"
                rs1.Update
                
        End If
        
        
        rs1.MoveNext
        Loop
        
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "dowhile_ws"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_loop2017()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "workstreams"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        If IsNull(rs1!Memo) Then
                skip
                Else
                xtext = rs1!Memo
                xtext = Replace(xtext, vbCrLf, "//")
                
                rs1.Edit
                rs1!Memo = xtext
                
                rs1.Update
        End If
        
        
        rs1.MoveNext
        Loop
        
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "list_databasefields"
Option Compare Database
Public Sub showtdf()
Dim db As Database
Dim tdf As TableDef
Dim X As Integer
Set db = CurrentDb
For Each tdf In db.TableDefs
        Debug.Print tdf.name,
        
        If InStr(1, tdf.name, "List") Then
                Debug.Print tdf.Fields.Count
                For X = 0 To tdf.Fields.Count - 1
                        Debug.Print tdf.Fields(X).name
                Next X
        End If
Next tdf
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub dbasedoc()
Call listQueryFields("Summary List for Exec")
Call listQueryFields("List of Projects")
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function listQueryFields(strQryName As String) As String
On Error GoTo listQueryFields_Error
Dim db As DAO.Database
Dim qryfld As DAO.QueryDef
Dim fld As Field
Set db = CurrentDb()
Set qryfld = db.QueryDefs(strQryName)
For Each fld In qryfld.Fields    'loop through all the fields of the Query
        Debug.Print fld.name
        Next
        
        Error_Handler_Exit:
        Set qryfld = Nothing
        Set db = Nothing
        Exit Function
        
        listQueryFields_Error:
        MsgBox "MS Access has generated the following error" & vbCrLf & vbCrLf & "Error Number: " & _
        Err.Number & vbCrLf & "Error Source: listQueryFields" & vbCrLf & _
        "Error Description: " & Err.DESCRIPTION, vbCritical, "An Error has Occured!"
        Resume Error_Handler_Exit
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub test01()
Dim z As Long
Dim y As Long
While Err.Number = 0
        On Error Resume Next
        While Err.Number = 0
                On Error Resume Next
                Debug.Print DBEngine(0)(0)(z)(y).name
                y = y + 1
                Wend
                If y > 1 Then
                        Err.Number = 0
                        y = 0
                        z = z + 1
                End If
                Wend
End Sub
Attribute VB_Name = "outlook2access"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub STEP2_TEST()
Dim myOlApp As New Outlook.Application
Dim myOlExp As Outlook.Explorer
Dim myOlSel As Outlook.Selection
Dim MsgTxt As String
Dim X As Integer
Set myOlExp = myOlApp.ActiveExplorer
Set myOlSel = myOlExp.Selection
On Error Resume Next
r = 2
for all items do...
For Each currentItem In myOlSel
        
        r = r + 1
        
        X1 = currentItem.SenderName
        X2 = currentItem.To
        x3 = currentItem.ReceivedTime
        X4 = currentItem.Subject
        'x5 = sieve(currentItem.Body)
        x5 = (currentItem.Body)
        X6 = ztext
        
        XATTACH_LIST = ""
        For Each objAtt In currentItem.Attachments
                XATTACH_LIST = XATTACH_LIST & objAtt.DisplayName & vbCrLf
                
                Next
                X7 = XATTACH_LIST
                
                Debug.Print X1, X2, x3, X4, x5
                
                Next
                '  ztext = sieve(xtext)
                Debug.Print ztext
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub STEP1_GET_SELECTED_EMAILS()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "Table1"
xsql2 = "Query2"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
Do While Not rs1.EOF
        
        
        Dim myOlApp As New Outlook.Application
        Dim myOlExp As Outlook.Explorer
        Dim myOlSel As Outlook.Selection
        Dim MsgTxt As String
        
        Set myOlExp = myOlApp.ActiveExplorer
        Set myOlSel = myOlExp.Selection
        On Error Resume Next
        
        rs1.MoveLast
        '##############################################################################
        For Each currentItem In myOlSel
                X1 = currentItem.SenderName
                X2 = currentItem.To
                x3 = currentItem.ReceivedTime
                X4 = currentItem.Subject
                'x5 = sieve(currentItem.Body)
                x5 = "BLANK"
                x5 = (currentItem.Body)
                X6 = ztext
                
                XATTACH_LIST = ""
                For Each objAtt In currentItem.Attachments
                        XATTACH_LIST = XATTACH_LIST & objAtt.DisplayName & vbCrLf
                        
                        Next
                        X7 = XATTACH_LIST
                        
                        
                        ###################################
                        xc = xc + 1
                        Debug.Print xc, x3, X4
                        'rs1.Delete
                        rs1.AddNew
                        
                        rs1!F1 = X1
                        rs1!F2 = X2
                        rs1!F3 = x3
                        rs1!F4 = X4
                        rs1!F5 = x5
                        rs1!F6 = X6
                        rs1!F7 = X7
                        rs1.Update
                        
                        
                        
                        '###################################
                        
                        Next
                        
                        
                        
                        rs1.MoveNext
                        Loop
                        
                        
                        rs1.Close
                        Set rs1 = Nothing
                        rs2.Close
                        Set rs2 = Nothing
                        db.Close
                        Set db = Nothing
                        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function xf(X)
xf = Format(X, "00")
End Function
Attribute VB_Name = "PMO_report"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub word_report_pmo()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "List of Projects Query"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 10pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
#############################
X = X & "<h1> " & UCase("List of Projects") & " </h1>"
X = X & vbCrLf & "<P> " & Format(Now, "DD/MMM/YYYY")
X = X & " Commercial and Confidential"
X = X & vbCrLf & "<BR/> "
X = X & vbCrLf & "<h3>TABLE OF CONTENTS <a name=TOC></h3>"
#############################
xtext = xtext & X
rs1.MoveFirst
xtext = xtext & "<table width=900>"
xtext = xtext & "<table>"
Do While Not rs1.EOF
        fieldnox = 0
        xc = xc + 1
        xtext = xtext & "<p/> " & UCase(rs1.Fields(fieldnox).Value)
        
        
        xtext = xtext & "<tr><td>" & Format(xc, "00") & " " & "<a href=#" & UCase(rs1.Fields(fieldnox).Value) & "> " & UCase(rs1.Fields(fieldnox).Value)
        
        
        xtext = xtext & " <td>  " & Left(rs1.Fields(2).Value, 50) & "  </td> "
        xtext = xtext & " </a></td><td>  [" & RAG(rs1.Fields(4).Value) & "] </td>"
        xtext = xtext & " <td>  " & Left(rs1.Fields(5).Value, 50) & " ... </td> "
        xtext = xtext & " <td>  " & (rs1.Fields(11).Value) & "  </td> "
        xtext = xtext & " <td>  " & (rs1.Fields(12).Value) & "  </td> "
        xtext = xtext & " <td>  " & (rs1.Fields(13).Value) & "  </td> "
        
        xtext = xtext & " </tr>"
        Debug.Print X
        
        rs1.MoveNext
        Loop
        xtext = xtext & "</table>"
        
        xtext = xtext & "<br/>"
        xtext = xtext & "<BR/> If there are any errors, omissions or necessary update or changes please contact <a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud>Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051"
        xtext = xtext & "<hr/>"
        xtext = xtext & "<br/>"
        
        ###loop 2 get data
        
        rs1.MoveFirst
        xc = 0
        Do While Not rs1.EOF
                fieldnox = 0
                xc = xc + 1
                xtext = xtext & "<h1> " & Format(xc, "00") & " " & UCase(rs1.Fields(fieldnox).Value) & "</h1>"
                xtext = xtext & "<p/><a name=" & UCase(rs1.Fields(fieldnox).Value) & ">"
                
                
                xtext = xtext & "<table border width=900>"
                For X = 0 To rs1.Fields.Count - 1
                        xtext = xtext & "<tr><td width=100><b>" & UCase(rs1.Fields(X).name) & "</b></td><td>" & RAG((rs1.Fields(X).Value)) & "</td> </tr>"
                        xtext = xtext
                Next X
                xtext = xtext & "</table>"
                xsubject = Replace(UCase(rs1.Fields(fieldnox).Value), " ", "%20")
                
                '  xtext = xtext & "<b><p style='color: red;'> Use this link to send an update to Project Manager... "
                
                ' xtext = xtext & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xsubject & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                
                'xtext = xtext & "<P/><a href=#TOC>Go Top Table of Contents</a><HR/>"
                
                Debug.Print X
                
                rs1.MoveNext
                Loop
                
                FNAME = CurrentProject.path & "\XZXZXZ_PROJECT_LIST.html"
                Call PRINT_INFO(xtext, FNAME)
                
                
                ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function RAG(X)
RAG = X
If InStr(1, UCase(X), "#UNSURE") Then RAG = UCase("<b style='background-color:  #669999;'>" & X & "</b>")
        If InStr(1, UCase(X), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & X & "</b>")
                If InStr(1, UCase(X), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & X & "</b>")
                        If InStr(1, UCase(X), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & X & "</b>")
                                If InStr(1, UCase(X), "#PENDING") Then RAG = UCase("<b style='background-color:  BLUE;'>" & X & "</b>")
                                        If InStr(1, UCase(X), "#OTHER") Then RAG = UCase("<b style='background-color:  BLUE;'>" & X & "</b>")
                                                If InStr(1, UCase(x), "#GREEN") Then rag = UCase("<b style='background-color:  GREEN;'>" & x & "</b>")
End Function
Attribute VB_Name = "PMO_report"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub word_report_pmo()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "Query1"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 10pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
#############################
X = X & "<h1> " & UCase("List of Projects") & " </h1>"
X = X & vbCrLf & "<P> " & Format(Now, "DD/MMM/YYYY")
X = X & " Commercial and Confidential"
X = X & vbCrLf & "<BR/> "
X = X & vbCrLf & "<h3>TABLE OF CONTENTS <a name=TOC></h3>"
#############################
xtext = xtext & X
rs1.MoveFirst
xtext = xtext & "<table width=900>"
xtext = xtext & "<table>"
Do While Not rs1.EOF
        fieldnox = 0
        xc = xc + 1
        xtext = xtext & "<p/> " & UCase(rs1.Fields(fieldnox).Value)
        
        
        xtext = xtext & "<tr><td>" & Format(xc, "00") & " " & "<a href=#" & UCase(rs1.Fields(fieldnox).Value) & "> " & UCase(rs1.Fields(fieldnox).Value)
        
        
        xtext = xtext & " <td>  " & Left(rs1.Fields(2).Value, 50) & "  </td> "
        xtext = xtext & " </a></td><td>  [" & RAG(rs1.Fields(4).Value) & "] </td>"
        xtext = xtext & " <td>  " & Left(rs1.Fields(5).Value, 50) & " ... </td> "
        xtext = xtext & " <td>  " & (rs1.Fields(11).Value) & "  </td> "
        xtext = xtext & " <td>  " & (rs1.Fields(12).Value) & "  </td> "
        xtext = xtext & " <td>  " & (rs1.Fields(13).Value) & "  </td> "
        
        xtext = xtext & " </tr>"
        Debug.Print X
        
        rs1.MoveNext
        Loop
        xtext = xtext & "</table>"
        
        xtext = xtext & "<br/>"
        xtext = xtext & "<BR/> If there are any errors, omissions or necessary update or changes please contact <a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud>Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051"
        xtext = xtext & "<hr/>"
        xtext = xtext & "<br/>"
        
        ###loop 2 get data
        
        rs1.MoveFirst
        xc = 0
        Do While Not rs1.EOF
                fieldnox = 0
                xc = xc + 1
                xtext = xtext & "<h1> " & Format(xc, "00") & " " & UCase(rs1.Fields(fieldnox).Value) & "</h1>"
                xtext = xtext & "<p/><a name=" & UCase(rs1.Fields(fieldnox).Value) & ">"
                
                
                xtext = xtext & "<table border width=900>"
                For X = 0 To rs1.Fields.Count - 1
                        xtext = xtext & "<tr><td width=100><b>" & UCase(rs1.Fields(X).name) & "</b></td><td>" & RAG((rs1.Fields(X).Value)) & "</td> </tr>"
                        xtext = xtext
                Next X
                xtext = xtext & "</table>"
                xsubject = Replace(UCase(rs1.Fields(fieldnox).Value), " ", "%20")
                
                '  xtext = xtext & "<b><p style='color: red;'> Use this link to send an update to Project Manager... "
                
                ' xtext = xtext & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xsubject & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                
                'xtext = xtext & "<P/><a href=#TOC>Go Top Table of Contents</a><HR/>"
                
                Debug.Print X
                
                rs1.MoveNext
                Loop
                
                FNAME = CurrentProject.path & "\XZXZXZ_PROJECT_LIST.html"
                Call PRINT_INFO(xtext, FNAME)
                
                
                ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function RAG(X)
RAG = X
If InStr(1, UCase(X), "#UNSURE") Then RAG = UCase("<b style='background-color:  #669999;'>" & X & "</b>")
        If InStr(1, UCase(X), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & X & "</b>")
                If InStr(1, UCase(X), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & X & "</b>")
                        If InStr(1, UCase(X), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & X & "</b>")
                                If InStr(1, UCase(X), "#PENDING") Then RAG = UCase("<b style='background-color:  BLUE;'>" & X & "</b>")
                                        If InStr(1, UCase(X), "#OTHER") Then RAG = UCase("<b style='background-color:  BLUE;'>" & X & "</b>")
                                                If InStr(1, UCase(x), "#GREEN") Then rag = UCase("<b style='background-color:  GREEN;'>" & x & "</b>")
End Function
Attribute VB_Name = "PMO_web_form"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub web_form_pmo()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "List of Projects Query"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 10pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
#############################
X = X & "<h1> " & UCase("List of Projects") & " </h1>"
X = X & vbCrLf & "<P> " & Format(Now, "DD/MMM/YYYY")
X = X & vbCrLf & "<BR/> Commercial and Confidential"
X = X & vbCrLf & "<BR/> If there are any errors, omissions or necessary update or changes please contact <a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud>Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051"
X = X & vbCrLf & "<BR/> "
X = X & vbCrLf & "<h3>TABLE OF CONTENTS <a name=TOC></h3>"
#############################
xtext = xtext & X
rs1.MoveFirst
xtext = xtext & "<table width=900>"
xtext = xtext & "<table>"
Do While Not rs1.EOF
        fieldnox = 0
        xc = xc + 1
        xtext = xtext & "<p/> " & UCase(rs1.Fields(fieldnox).Value)
        
        
        xtext = xtext & "<tr><td>" & Format(xc, "00") & " " & "<a href=#" & UCase(rs1.Fields(fieldnox).Value) & "> " & UCase(rs1.Fields(fieldnox).Value)
        
        
        xtext = xtext & " <td>  " & Left(rs1.Fields(2).Value, 50) & "  </td> "
        xtext = xtext & " </a></td><td>  [" & RAG(rs1.Fields(4).Value) & "] </td>"
        xtext = xtext & " <td>  " & Left(rs1.Fields(5).Value, 50) & " ... </td> "
        xtext = xtext & " <td>  " & (rs1.Fields(11).Value) & "  </td> "
        xtext = xtext & " <td>  " & (rs1.Fields(12).Value) & "  </td> "
        xtext = xtext & " <td>  " & (rs1.Fields(13).Value) & "  </td> "
        
        xtext = xtext & " </tr>"
        Debug.Print X
        
        rs1.MoveNext
        Loop
        xtext = xtext & "</table>"
        
        xtext = xtext & "<br/>"
        xtext = xtext & "<hr/>"
        xtext = xtext & "<br/>"
        
        ###loop 2 get data
        
        rs1.MoveFirst
        
        Do While Not rs1.EOF
                fieldnox = 0
                xtext = xtext & "<h1> " & UCase(rs1.Fields(fieldnox).Value) & "</h1>"
                xtext = xtext & "<p/><a name=" & UCase(rs1.Fields(fieldnox).Value) & ">"
                
                
                xtext = xtext & "<table border width=900>"
                For X = 0 To rs1.Fields.Count - 1
                        xtext = xtext & "<tr><td width=100><b>" & UCase(rs1.Fields(X).name) & "</b></td><td>" & RAG((rs1.Fields(X).Value)) & "</td> </tr>"
                        xtext = xtext
                Next X
                xtext = xtext & "</table>"
                xsubject = Replace(UCase(rs1.Fields(fieldnox).Value), " ", "%20")
                xtext = xtext & "<b><p style='color: red;'> Use this link to send an update to Project Manager... "
                
                xtext = xtext & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xsubject & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                
                xtext = xtext & "<P/><a href=#TOC>Go Top Table of Contents</a><HR/>"
                
                Debug.Print X
                
                rs1.MoveNext
                Loop
                
                FNAME = CurrentProject.path & "\XZXZXZ_PROJECT_LIST.html"
                Call PRINT_INFO(xtext, FNAME)
                
                
                ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function RAG(X)
RAG = X
If InStr(1, UCase(X), "#UNSURE") Then RAG = UCase("<b style='background-color:  #669999;'>" & X & "</b>")
        If InStr(1, UCase(X), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & X & "</b>")
                If InStr(1, UCase(X), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & X & "</b>")
                        If InStr(1, UCase(X), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & X & "</b>")
                                If InStr(1, UCase(X), "#PENDING") Then RAG = UCase("<b style='background-color:  BLUE;'>" & X & "</b>")
                                        If InStr(1, UCase(X), "#OTHER") Then RAG = UCase("<b style='background-color:  BLUE;'>" & X & "</b>")
                                                If InStr(1, UCase(x), "#GREEN") Then rag = UCase("<b style='background-color:  GREEN;'>" & x & "</b>")
End Function
Attribute VB_Name = "PMO_web_form"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub web_form_pmo()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "Query1"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 10pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
#############################
X = X & "<h1> " & UCase("List of Projects") & " </h1>"
X = X & vbCrLf & "<P> " & Format(Now, "DD/MMM/YYYY")
X = X & vbCrLf & "<BR/> Commercial and Confidential"
X = X & vbCrLf & "<BR/> If there are any errors, omissions or necessary update or changes please contact <a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud>Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051"
X = X & vbCrLf & "<BR/> "
X = X & vbCrLf & "<h3>TABLE OF CONTENTS <a name=TOC></h3>"
#############################
xtext = xtext & X
rs1.MoveFirst
xtext = xtext & "<table width=900>"
xtext = xtext & "<table>"
Do While Not rs1.EOF
        fieldnox = 0
        xc = xc + 1
        xtext = xtext & "<p/> " & UCase(rs1.Fields(fieldnox).Value)
        
        
        xtext = xtext & "<tr><td>" & Format(xc, "00") & " " & "<a href=#" & UCase(rs1.Fields(fieldnox).Value) & "> " & UCase(rs1.Fields(fieldnox).Value)
        
        
        xtext = xtext & " <td>  " & Left(rs1.Fields(2).Value, 50) & "  </td> "
        xtext = xtext & " </a></td><td>  [" & RAG(rs1.Fields(4).Value) & "] </td>"
        xtext = xtext & " <td>  " & Left(rs1.Fields(5).Value, 50) & " ... </td> "
        xtext = xtext & " <td>  " & (rs1.Fields(11).Value) & "  </td> "
        xtext = xtext & " <td>  " & (rs1.Fields(12).Value) & "  </td> "
        xtext = xtext & " <td>  " & (rs1.Fields(13).Value) & "  </td> "
        
        xtext = xtext & " </tr>"
        Debug.Print X
        
        rs1.MoveNext
        Loop
        xtext = xtext & "</table>"
        
        xtext = xtext & "<br/>"
        xtext = xtext & "<hr/>"
        xtext = xtext & "<br/>"
        
        ###loop 2 get data
        
        rs1.MoveFirst
        
        Do While Not rs1.EOF
                fieldnox = 0
                xtext = xtext & "<h1> " & UCase(rs1.Fields(fieldnox).Value) & "</h1>"
                xtext = xtext & "<p/><a name=" & UCase(rs1.Fields(fieldnox).Value) & ">"
                
                
                xtext = xtext & "<table border width=900>"
                For X = 0 To rs1.Fields.Count - 1
                        xtext = xtext & "<tr><td width=100><b>" & UCase(rs1.Fields(X).name) & "</b></td><td>" & RAG((rs1.Fields(X).Value)) & "</td> </tr>"
                        xtext = xtext
                Next X
                xtext = xtext & "</table>"
                xsubject = Replace(UCase(rs1.Fields(fieldnox).Value), " ", "%20")
                xtext = xtext & "<b><p style='color: red;'> Use this link to send an update to Project Manager... "
                
                xtext = xtext & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xsubject & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                
                xtext = xtext & "<P/><a href=#TOC>Go Top Table of Contents</a><HR/>"
                
                Debug.Print X
                
                rs1.MoveNext
                Loop
                
                FNAME = CurrentProject.path & "\XZXZXZ_PROJECT_LIST.html"
                Call PRINT_INFO(xtext, FNAME)
                
                
                ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function RAG(X)
RAG = X
If InStr(1, UCase(X), "#UNSURE") Then RAG = UCase("<b style='background-color:  #669999;'>" & X & "</b>")
        If InStr(1, UCase(X), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & X & "</b>")
                If InStr(1, UCase(X), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & X & "</b>")
                        If InStr(1, UCase(X), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & X & "</b>")
                                If InStr(1, UCase(X), "#PENDING") Then RAG = UCase("<b style='background-color:  BLUE;'>" & X & "</b>")
                                        If InStr(1, UCase(X), "#OTHER") Then RAG = UCase("<b style='background-color:  BLUE;'>" & X & "</b>")
                                                If InStr(1, UCase(x), "#GREEN") Then rag = UCase("<b style='background-color:  GREEN;'>" & x & "</b>")
End Function
Attribute VB_Name = "PMO_web_report"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub web_report_pmo()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "query1"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
#############################
xtext = xtext & "<h1> List of Projects </h1>"
#############################
###loop 2 get data
xtext = xtext & "<table border>"
rs1.MoveFirst
xtext = xtext & "<tr>"
For x = 0 To rs1.Fields.Count - 1
        xtext = xtext & "<br/>" & UCase(rs1.Fields(x).name)  '"</td>"
        xtext = xtext
Next x
  xtext = xtext & "</tr>"
Do While Not rs1.EOF
        
        
        
        
        
        xtext = xtext & "<tr>"
        For X = 0 To rs1.Fields.Count - 1
                xtext = xtext & "<br/><b>" & RAG(rs1.Fields(X).name) & " </b> " & RAG(rs1.Fields(X).Value) '& "</td>"
                xtext = xtext
        Next X
        'xtext = xtext & "</tr>"
        xtext = xtext & "<p/><hr/>"
        
        rs1.MoveNext
        Loop
        
        xtext = xtext & "</table>"
        xtext = xtext & "<p/><hr/>"
        Debug.Print X
        FNAME = CurrentProject.path & "\TEMP.html"
        Call PRINT_INFO(xtext, FNAME)
        
        
        ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function RAG(X)
RAG = X
If InStr(1, UCase(X), "#GREY") Then RAG = UCase("<b style='background-color:  #669999;'>" & X & "</b>")
        If InStr(1, UCase(X), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & X & "</b>")
                If InStr(1, UCase(X), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & X & "</b>")
                        If InStr(1, UCase(X), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & X & "</b>")
                                
End Function
Attribute VB_Name = "print_infox"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function PRINT_INFO(ByVal PARAM_TEXT As String, ByVal xoutput As String) 'vba_excel report cells, create file, print file, notepad
Dim FILENUMBER1 As Integer
Dim xpath As String
Dim xfilename As String
xpath = ActiveWorkbook.Path & "\"
xfilename = "TEMP" & Format(Now(), "yymmdd") & "-" & Format(Now(), "HHMM") & ".txt"
xfilename = xoutput
FILENUMBER1 = FreeFile
Open xpath & xfilename For Output As #FILENUMBER1 '
Print #FILENUMBER1, PARAM_TEXT
Close #FILENUMBER1
Call open_file(xpath & xfilename)
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function open_file(xfilename As String)
vba_excel report cells, create file, print file, notepad
Dim ReturnValue, I
ReturnValue = Shell("notepad.EXE " & xfilename, 1)  ' Run Calculator.
AppActivate ReturnValue
End Function
Attribute VB_Name = "table2report"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2report()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
rs1.MoveFirst
For X = 0 To rs1.Fields.Count - 1
        Debug.Print X, rs1.Fields(X).name, rs1.Fields(X).Value
Next X
Do While Not rs1.EOF
        
        
        xtext = xtext & vbCrLf
        xtext = xtext & "=============================="
        For X = 0 To rs1.Fields.Count - 1
                xtext = xtext & vbCrLf & UCase(rs1.Fields(X).name) & ": " & rs1.Fields(X).Value
                xtext = xtext & vbCrLf
        Next X
        
        
        
        
        'rs1.Edit
        'rs1!Detail = xtext
        'rs1.Update
        
        
        
        
        rs1.MoveNext
        Loop
        
        
        Debug.Print X
        FNAME = CurrentProject.path & "\TEMP.TXT"
        Call PRINT_INFO(xtext, FNAME)
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, X)
padd = Left(xtext & "                                                                                                                ", X) & vbTab
End Function
Attribute VB_Name = "update_dowhile01"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub update_dowhile()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "List of Projects"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        
        rs1.Edit
        rs1!Priority = 3
        If IsNull(rs1!Cost) Then rs1!Cost = 5000
                If IsNull(rs1!Stakeholders) Then rs1!Stakeholders = "TBC"
                        
                        
                        rs1!OpenClosed = UCase(rs1!OpenClosed)
                        rs1!Status = UCase(rs1!Status)
                        rs1.Update
                        
                        
                        rs1.MoveNext
                        Loop
                        
                        
                        rs1.Close
                        Set rs1 = Nothing
                        rs2.Close
                        Set rs2 = Nothing
                        db.Close
                        Set db = Nothing
                        
End Sub
Attribute VB_Name = "vba_export_modulex"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub vba_export_modules()
#http://www.cpearson.com/Excel/VBE.aspx
 reference to extensibility library
xprefix = "C:\Users\Tim\Documents\Data2017\VBA\VBAAccess\vba_"
Dim objMyProj As VBProject
Dim objVBComp As VBComponent
Set objMyProj = Application.VBE.ActiveVBProject
For Each objVBComp In objMyProj.VBComponents
        If objVBComp.Type = vbext_ct_StdModule Then
                Debug.Print "Exporting " & xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".txt"
                
                objVBComp.Export xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".bas"
                objVBComp.Export xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".txt"
                
        End If
        Next
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function PRINT_INFO1(ByVal PARAM_TEXT As String, ByVal xoutput As String) 'vba_excel report cells, create file, print file, notepad
Dim FILENUMBER1 As Integer
Dim xpath As String
Dim xfilename As String
xpath = ActiveWorkbook.Path & "\"
xfilename = "TEMP" & Format(Now(), "yymmdd") & "-" & Format(Now(), "HHMM") & ".txt"
xfilename = xoutput
FILENUMBER1 = FreeFile
Open xpath & xfilename For Output As #FILENUMBER1 '
Print #FILENUMBER1, PARAM_TEXT
Close #FILENUMBER1
Call open_file(xpath & xfilename)
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function open_file(xfilename As String)
vba_excel report cells, create file, print file, notepad
Dim ReturnValue, I
ReturnValue = Shell("notepad.EXE " & xfilename, 1)  ' Run Calculator.
AppActivate ReturnValue
End Function
Attribute VB_Name = "vba_export_modulex"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub vba_export_modules()
#http://www.cpearson.com/Excel/VBE.aspx
 reference to extensibility library
xprefix = "C:\Users\Tim\Documents\Data2017\VBA\VBAAccess\vba_"
Dim objMyProj As VBProject
Dim objVBComp As VBComponent
Set objMyProj = Application.VBE.ActiveVBProject
For Each objVBComp In objMyProj.VBComponents
        If objVBComp.Type = vbext_ct_StdModule Then
                Debug.Print "Exporting " & xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".txt"
                
                objVBComp.Export xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".bas"
                objVBComp.Export xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".txt"
                
        End If
        Next
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function PRINT_INFO1(ByVal PARAM_TEXT As String, ByVal xoutput As String) 'vba_excel report cells, create file, print file, notepad
Dim FILENUMBER1 As Integer
Dim xpath As String
Dim xfilename As String
xpath = ActiveWorkbook.Path & "\"
xfilename = "TEMP" & Format(Now(), "yymmdd") & "-" & Format(Now(), "HHMM") & ".txt"
xfilename = xoutput
FILENUMBER1 = FreeFile
Open xpath & xfilename For Output As #FILENUMBER1 '
Print #FILENUMBER1, PARAM_TEXT
Close #FILENUMBER1
Call open_file(xpath & xfilename)
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function open_file(xfilename As String)
vba_excel report cells, create file, print file, notepad
Dim ReturnValue, I
ReturnValue = Shell("notepad.EXE " & xfilename, 1)  ' Run Calculator.
AppActivate ReturnValue
End Function
Attribute VB_Name = "vlookupxx"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub test()
answer = vlookup("Deliverables", 1, "Legal&Contracts", 3)
answer = vlookup("Workstreams", 8, "Legal&Contracts", 5)
Debug.Print answer
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function vlookup(TABLENAME, column2match, data2match, column2get)
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = TABLENAME
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
rs1.MoveFirst
Do While Not rs1.EOF
        
        
        If rs1.Fields(column2match).Value = data2match Then
                
                
                '  For x = 0 To rs1.Fields.Count - 1
                
                xtext = xtext & (rs1.Fields(column2get).Value) & ";"
                
                
        End If
        rs1.MoveNext
        Loop
        
        
        vlookup = xtext
        rs1.Close
        
        Set rs1 = Nothing
        
        
        db.Close
        Set db = Nothing
        
End Function
Attribute VB_Name = "xbutton01"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub button01()
xto = "XZXZXZ@XZXZXZ.com"
xcc = "XZXZXZ@XZXZXZ.com"
xbody = "XZXZXZ@XZXZXZ.com"
xbody = [Forms].[XZXZXZ_HRdBase]![Name]
xbody = Forms!XZXZXZ_HRdBase!name
xsubject = "XZXZXZ@XZXZXZ.com"
Call access2outlook(xto, xcc, xbody, xsubject)
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function access2outlook(xto, xcc, xbody, xsubject)
outlook from excel
Dim olApp As Outlook.Application
Dim olMail As MailItem
Dim CurrFile As String
Set olApp = New Outlook.Application
Set olMail = olApp.CreateItem(olMailItem)
ActiveWorkbook.Save
CurrFile = ActiveWorkbook.Path & "\" & ActiveWorkbook.Name
With olMail
.To = xto
.CC = xcc
.Subject = xsubject
.Body = xbody
.Attachments.Add CurrFile
.Attachments.Add "c:\My Documents\book.doc"
.Display '.Send
End With
Set olMail = Nothing
Set olApp = Nothing
End Function
Attribute VB_Name = "blogger"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub pagesetup()
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
newline = vbCrLf & "<br/>"
tx = tx & vbCrLf & "<html><head><style>"
tx = tx & vbCrLf & "BODY { color: BLACK; margin-left: 500px; margin-right: 500px; text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "table { border-collapse: collapse; border: 1px solid black;}"
https://www.w3schools.com/colors/colors_picker.asp
http://www.hitmill.com/html/pastels.html
tx = tx & vbCrLf & "H1.banner {  padding: 10px;   line-height: 90px; height: 100px;   color: #293d3d;  text-align: center; font-size: 18pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "H1.bannerb {  padding: 10px;   line-height: 90px; height: 100px; background-color: #8CD1E6;  color: #293d3d;  text-align: center; font-size: 18pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "H1.bannerg {  padding: 10px;   line-height: 90px; height: 100px; background-color: #A3FEBA;  color: #293d3d;  text-align: center; font-size: 18pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "H1.bannery {  padding: 10px;   line-height: 90px; height: 100px; background-color: #EEF093;  color: #293d3d;  text-align: center; font-size: 18pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "H3.banner {     padding: 30px; padding-left: 90px;  padding-right: 90px;  line-height: 50px; height: 100px;  background-color: silver;  color: black;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "p.banner {     padding: 30px; padding-left: 90px;  padding-right: 90px;  line-height: 50px; height: 100px;  background-color: silver;  color: black;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & ".banner {     padding: 30px; padding-left: 90px;  padding-right: 90px;  line-height: 50px; height: 100px;  background-color: silver;  color: black;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & ".buttonbar {     line-height: 50px;  background-color: orange;  color: black;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & "a.button {     line-height: 50px; height: 100px; padding-left: 10px; padding-right: 10px; background-color: orange;  text-decoration: none; color: white;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
tx = tx & vbCrLf & ".svgclass {      height: 10px;   width: 10px;}"
tx = tx & vbCrLf & " .navbar {"
tx = tx & vbCrLf & "  overflow: hidden;"
tx = tx & vbCrLf & "  background-color: #333;"
tx = tx & vbCrLf & "  background-color: orange;"
tx = tx & vbCrLf & "  position: fixed;"
tx = tx & vbCrLf & "  bottom: 0;" ' bottom menu
tx = tx & vbCrLf & "  top: 0;" ' top menu
tx = tx & vbCrLf & "  left: 10;" ' top menu
tx = tx & vbCrLf & "  width: 100%;"
tx = tx & vbCrLf & "  width: 1030px;"
tx = tx & vbCrLf & "  width: 400px;"
tx = tx & vbCrLf & "}"
tx = tx & vbCrLf & ""
tx = tx & vbCrLf & ".navbar a {"
tx = tx & vbCrLf & "  float: left;"
tx = tx & vbCrLf & "  display: block;"
tx = tx & vbCrLf & "  color: #f2f2f2;"
tx = tx & vbCrLf & "    color: white;"
tx = tx & vbCrLf & "  text-align: center;"
tx = tx & vbCrLf & "  padding: 14px 16px;"
tx = tx & vbCrLf & "  padding: 14px;"
tx = tx & vbCrLf & "  text-decoration: none;"
tx = tx & vbCrLf & "  font-size: 17px;"
tx = tx & vbCrLf & "}"
tx = tx & vbCrLf & " .navbar2 {"
tx = tx & vbCrLf & "  overflow: hidden;"
tx = tx & vbCrLf & "  position: fixed;"
tx = tx & vbCrLf & "  bottom: 0;" ' bottom menu
tx = tx & vbCrLf & "  top: 0;" ' top menu
tx = tx & vbCrLf & "  left: 10;" ' top menu
tx = tx & vbCrLf & "  width: 400px;"
tx = tx & vbCrLf & "}"
tx = tx & vbCrLf & ""
tx = tx & vbCrLf & ".navbar2 a {"
tx = tx & vbCrLf & "  float: left;"
tx = tx & vbCrLf & "  display: block;"
tx = tx & vbCrLf & "    color: BLACK;"
tx = tx & vbCrLf & "  text-align: center;"
tx = tx & vbCrLf & "  padding: 14px 16px;"
tx = tx & vbCrLf & "  padding: 0px;"
tx = tx & vbCrLf & "  text-decoration: none;"
tx = tx & vbCrLf & "  font-size: 14px;"
tx = tx & vbCrLf & "}"
tx = tx & vbCrLf & "</style></head><body>"
tx = tx & "<a name=TOC></a>"
tx = tx & sub_routine_header
tx = tx & vbCrLf & "<div class='navbar'>"
tx = tx & makeindex("query1")
tx = tx & vbCrLf & "</div>"
tx = tx & vbCrLf & "<div class='navbar2'>"  '' side menu
tx = tx & "&nbsp" & "Table of Contents"
tx = tx & makeindex2("query1")
tx = tx & vbCrLf & "</div>"
X = X & newline
X = X & newline
xtext2 = text2blog("query1")
Debug.Print xtext2
##############################
composite_text = tx & xtext2 & X
##############################
XDATE = Format(Now, "DDD-DD-MMM-YYYY")
fname = CurrentProject.path & "\PROJECT_SKY_CONFLUENCE_" & XDATE & ".html"
fname = CurrentProject.path & "\PROJECT_SKY_CONFLUENCE_" & ".html"
Call PRINT_INFO(composite_text, fname)
ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function text2blog(xsql1)
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
newline = vbCrLf & "<br/>"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Dim xcol As Integer
rs1.MoveFirst
For X = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next X
Do While Not rs1.EOF
        xtext = xtext & "<a name=" & rs1!ID & ">"
        
        ############################################
        If xcol > 3 Then xcol = 0
                xcol = xcol + 1
                If xcol = 1 Then XHEADER = "<h1 class='banner' style='background-color: #00ccff;'>" & rs1!header & "</h1>"
                        If xcol = 2 Then XHEADER = "<h1 class='banner' style='background-color: #8CD1E6;'>" & rs1!header & "</h1>"
                                If xcol = 3 Then XHEADER = "<h1 class='banner' style='background-color: #A3FEBA;'>" & rs1!header & "</h1>"
                                        If xcol = 4 Then XHEADER = "<h1 class='banner' style='background-color: #EEF093;'>" & rs1!header & "</h1>"
                                                
                                                
                                                
                                                xtext = xtext & XHEADER
                                                
                                                ####http://vanseodesign.com/web-design/svg-viewbox/
                                                xtext = xtext & "<p width=100 height=100>" & rs1!info3 & "</p>"
                                                
                                                svgdata = ""
                                                xsvgacolor = "#00ccff"
                                                If Not IsNull(rs1!info3) Then
                                                        svgdata = rs1!info3
                                                        If xcol = 1 Then xsvgacolor = "#00ccff"
                                                                If xcol = 2 Then xsvgacolor = "#8CD1E6"
                                                                        If xcol = 3 Then xsvgacolor = "#A3FEBA"
                                                                                If xcol = 4 Then xsvgacolor = "#EEF093"
                                                                                        svgdata = Replace(svgdata, "cyan", xsvgacolor)
                                                                                        svgdata = Replace(svgdata, "Information", rs1!Title)
                                                                                        svgdata = Replace(svgdata, "Weekly", "")
                                                                                End If
                                                                                
                                                                                xtext = xtext & "<center><svg width=200 height=200 " & svgdata & " viewBox='900 0 99 99'> </center>"
                                                                                xtext = xtext & "<svg xmlns=" & rs1!info3 & " viewBox='10 10 909 1286'> <p>"
                                                                                xtext = xtext & "<svg xmlns=" & rs1!info3 & " viewBox='10 10 500 200'> <p>"
                                                                                xcontent = "Blah" & vbCrLf & "Blah" & vbCrLf
                                                                                If Not IsNull(rs1!content) Then
                                                                                        xcontent = rs1!content
                                                                                End If
                                                                                xarray = Split(xcontent, vbCrLf)
                                                                                
                                                                                
                                                                                For q = LBound(xarray) To UBound(xarray)
                                                                                        newtext = xarray(q)
                                                                                        'If (StrComp(newtext, UCase(newtext), vbTextCompare) = 0) Then
                                                                                        If (StrComp(newtext, UCase(newtext), vbBinaryCompare) = 0) Then
                                                                                                If Len(Trim(newtext)) > 1 Then newtext = "<b>" & newtext & "</b>"
                                                                                                        Else
                                                                                                        ' skip
                                                                                                End If
                                                                                                xtext = xtext & "<br/>" & newtext & vbCrLf
                                                                                                Next
                                                                                                
                                                                                                ############################################
                                                                                                xfooter = "<p class='banner'>" & rs1!footer & "</p><a href=#TOC>GoTop</a>"
                                                                                                xtext = xtext & xfooter
                                                                                                xtext = xtext & "<hr/>"
                                                                                                rs1.MoveNext
                                                                                                Loop
                                                                                                rs1.Close
                                                                                                Set rs1 = Nothing
                                                                                                db.Close
                                                                                                Set db = Nothing
                                                                                                text2blog = xtext
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function makeindex(xsql1)
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
newline = vbCrLf & "<br/>"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
rs1.MoveFirst
For X = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next X
xtext = xtext & "<div class=buttonbar> <center>"
Do While Not rs1.EOF
        xtext = xtext & " <a class=button href=#" & rs1!ID & ">" & rs1!Title & "</a> "
        xtext = xtext & "<a href=#" & rs1!ID & ">" & rs1!Title & "</a> "
        rs1.MoveNext
        Loop
        xtext = xtext & "</center></div>"
        
        
        
        rs1.Close
        Set rs1 = Nothing
        db.Close
        Set db = Nothing
        makeindex = xtext
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function makeindex2(xsql1)
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
newline = vbCrLf & "<br/>"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
rs1.MoveFirst
For X = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next X
xtext = xtext & "<div class=buttonbar> <center>"
Do While Not rs1.EOF
        xtext = xtext & " <a class=button href=#" & rs1!ID & ">" & rs1!Title & "</a> "
        xtext = xtext & "<BR/><a href=#" & rs1!ID & ">" & rs1!Title & "</a> "
        rs1.MoveNext
        Loop
        xtext = xtext & "</center></div>"
        
        
        
        rs1.Close
        Set rs1 = Nothing
        db.Close
        Set db = Nothing
        makeindex2 = xtext
End Function
Attribute VB_Name = "db_backup"
Option Compare Database
Public Function db_backup()
Dim sourceFile As String, destinationFile As String
Dim aFSO As Variant
Dim path As String, name As String
sourceFile = CurrentProject.FullName
path = CurrentProject.path
name = CurrentProject.name
xname_without_suffix = Left(name, Len(name) - 6)
xtime = xf(Hour(Now)) & xf(Minute(Now)) '& xf(Second(Now))
XDATE = Year(Now) & "" & Format(Month(Now), "00") & "" & Format(Day(Now), "00")
destinationFile = path & "\" & xname_without_suffix & "_bkup" & XDATE & "-" & xtime & ".accdb"
Debug.Print path
this removes a file created on the same day
If Dir(destinationFile) <> "" Then
        Kill destinationFile
End If
this creates a backup into destination path
If Dir(destinationFile) = "" Then
        
        Set aFSO = CreateObject("Scripting.FileSystemObject")
        aFSO.CopyFile sourceFile, destinationFile, True
        
        MsgBox "A database backup has been stored under " & destinationFile
        
        X = destinationFile
        X = InputBox(X, X, X)
End If
End Function
Attribute VB_Name = "do_while_update"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_update()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "list of projects"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        If IsNull(rs1!Memo) Then
                skip
                Else
                ' xtext = rs1!Memo
                'xtext = Replace(xtext, vbCrLf, "//")
                
                rs1.Edit
                rs1!prince2compliant = "No - Not being managed as a project. Would however recommed that there is an agreement (what will be done) a plan (when) and a budget (how much) with regular reporting (on progress, issues and tasks)"
                rs1!doc_approval = "N"
                rs1!doc_pid = "N"
                rs1!doc_plan = "N"
                rs1!doc_design = "N"
                ' rs1!doc_budget = "N"
                rs1!doc_raidd = "N"
                rs1!doc_acceptance = "N"
                
                For q = 20 To rs1.Fields.Count - 1
                        rs1.Fields(q) = "N"
                Next q
                rs1.Update
                
                
                
                rs1.MoveNext
                Loop
                
                
                rs1.Close
                Set rs1 = Nothing
                rs2.Close
                Set rs2 = Nothing
                db.Close
                Set db = Nothing
                
End Sub
Attribute VB_Name = "INTRANET"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub INTRANET_SIMPLE()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "query2"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
xnewline = "<br/>" & vbCrLf
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
X = X & vbCrLf & "<html><head><style>"
X = X & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "TD { text-align: top; valign: top; text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "</style></head><body>"
##########################################################################
###looop 1 get index
##########################################################################
XMAXCOL = 5
rs1.MoveFirst
X = X & vbCrLf & "<h1>TABLE OF CONTENTS <a name=TOC></h1>"
X = X & vbCrLf & "<table border WIDTH=1200>"
X = X & vbCrLf & "<tr>"
For z = 0 To XMAXCOL ' rs1.Fields.Count - 1
        X = X & vbCrLf & "<th>" & rs1.Fields(z).name & "</th>"     ' rs1.Fields(x).name,
Next z
X = X & vbCrLf & "</tr>"
Do While Not rs1.EOF
        
        X = X & vbCrLf & "<tr>"
        xaname = rs1.Fields(0).Value
        X = X & vbCrLf & "<TD valign=top><a HREF=#" & xaname & ">" & xaname & "</td>"    ' rs1.Fields(x).name,
        
        
        For z = 1 To XMAXCOL ' rs1.Fields.Count - 1
                X = X & vbCrLf & "<td valign=top>" & ragg(rs1.Fields(z).Value) & "</td>"     ' rs1.Fields(x).name,
        Next z
        X = X & vbCrLf & "</tr>"
        
        
        rs1.MoveNext
        Loop
        
        X = X & vbCrLf & "</table border>"
        X = X & xnewline
        X = X & xnewline
        ##########################################################################
        ###looop 2 get detail
        ##########################################################################
        
        
        rs1.MoveFirst
        X = X & vbCrLf & "<h1>DETAILED BREAKDOWN <a name=TOC></h1>"
        X = X & "<br/><a href=#TOC>Go Top Table of Contents</a>"
        Do While Not rs1.EOF
                xaname = rs1.Fields(0).Value
                X = X & vbCrLf & "<p/><a name=" & xaname & ">" & xaname & "</A>"
                
                
                X = X & vbCrLf & "<TABLE BORDER WIDTH=1200>"
                For z = 1 To rs1.Fields.Count - 1
                        X = X & vbCrLf & "<TR>"
                        X = X & vbCrLf & "<td WIDTH=300 valign=top><B>" & rs1.Fields(z).name & "</B></td>"
                        X = X & vbCrLf & "<td valign=top>" & ragg(rs1.Fields(z).Value) & "</td>"     ' rs1.Fields(x).name,
                        X = X & vbCrLf & "</TR>"
                Next z
                
                X = X & vbCrLf & "</TABLE>"
                X = X & "<br/><a href=#TOC>Go Top Table of Contents</a>"
                rs1.MoveNext
                Loop
                
                X = X & xnewline
                X = X & xnewline
                
                
                
                
                FNAME = CurrentProject.path & "\TEMPFILE.html"
                Call PRINT_INFO(X, FNAME)
                ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function ragg(X)
ragg = X
If InStr(1, UCase(X), "#GREEN") Then X = Replace(X, "#GREEN", "<SPAN style='BACKGROUND-color: GREEN;'>#GREEN</SPAN>")
        If InStr(1, UCase(X), "#RED") Then X = Replace(X, "#RED", "<SPAN style='BACKGROUND-color: RED;'>#RED</SPAN>")
                If InStr(1, UCase(X), "#BLUE") Then X = Replace(X, "#BLUE", "<SPAN style='BACKGROUND-COLOR: BLUE;'>#BLUE</SPAN>")
                        If InStr(1, UCase(X), "#AMBER") Then X = Replace(X, "#AMBER", "<SPAN style='BACKGROUND-color: ORANGE;'>#AMBER</SPAN>")
                                If InStr(1, UCase(X), "#UNSURE") Then X = Replace(X, "#UNSURE", "<SPAN style='BACKGROUND-color: BLUE;'>#UNSURE</SPAN>")
                                        
                                        
                                        If UCase(X) = "Y" Then X = "<SPAN style='BACKGROUND-color: GREEN;'>Y</SPAN>"
                                                If UCase(X) = "N" Then X = "<SPAN style='BACKGROUND-color: RED;'>N</SPAN>"
                                                        
                                                        
                                                        ragg = X
End Function
Attribute VB_Name = "dowhile_deliver"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub do_while_loop()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "deliverables"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        
        xtext = rs1!ShortName
        
        If InStr(1, xtext, "Legal") Then
                
                rs1.Edit
                ' rs1!STATUS = "#GREY"
                rs1!PHASE = "P2-Aquisition"
                rs1.Update
                
        End If
        
        
        rs1.MoveNext
        Loop
        
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "email_update_report"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub email_update_report()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "html_deliverables_update"
xsql2 = ""
xsql3 = ""
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
xtext = xtext & vbCrLf & "Hello"
xtext = xtext & vbCrLf & "I have done a trim of the deliverables and tried to batch them together in order to make this list of things to do a bit shorter. Let's meet to discuss so that I can have a quality update for the next steering XZXZXZ on Tuesday at 3pm"
xtext = xtext & vbCrLf & " "
xtext = xtext & vbCrLf & "I 've included  Andrew for info only (not attendance)"
xprevious = ""
Do While Not rs1.EOF
        If xprevious <> rs1.Fields(0).Value Then 'header info
                xtext = xtext & vbCrLf
                xtext = xtext & vbCrLf
                xtext = xtext & UCase(Trim(rs1.Fields(0).Value)) & " "
                xtext = xtext & vbCrLf
                xtext = xtext & vbCrLf
                xprevious = rs1.Fields(0).Value
                xc = 0
        End If
        
        
        xc = xc + 1
        xtext = xtext & Format(xc, "000  ") & (rs1.Fields(1).Value) & "  ---  "
        xtext = xtext & (rs1.Fields(2).Value)
        xtext = xtext & vbCrLf & "     PM Comment >>>   " & (rs1.Fields(3).Value) & " "
        xtext = xtext & vbCrLf
        xtext = xtext & vbCrLf
        rs1.MoveNext
        Loop
        
        
        
        XDATE = Format(Now, "DDD-DD-MMM-YYYY")
        fname = CurrentProject.path & "\PROJECT_SKY_LONG_" & XDATE & ".html"
        Call PRINT_INFO(xtext, fname)
        
        ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        ReturnValue = Shell("notepad.EXE " & fname, 1)  ' Run Calculator.
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "eventscal_indexHTML"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub eventscal_indexHTML()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "eventcalendar"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
X = X & vbCrLf & "<html><head><style>"
X = X & vbCrLf & "BODY {  color: black;  text-align: left; font-size: 12pt; font-family: verdana; arial; position: absolute; z-index: -1; }"
X = X & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H3 { background-color: cyan;  color: cyan; width=100% text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "TD {   z-index: 0; text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "table { z-index: 0; border-collapse: collapse; border: 1px solid black;}"
X = X & vbCrLf & "table.timclass td {  width: 350;  }"
X = X & vbCrLf & ".newbutton:link { background-color: black; color: white;  text-decoration: none; font-size: 8pt; }"
X = X & vbCrLf & "a.newbutton { background-color: red; color: white;  text-decoration: none; font-size: 8pt; }"
X = X & vbCrLf & ".banner { background-color: red; color: white;  text-decoration: none; font-size: 8pt; }"
X = X & vbCrLf & "</style></head>"
########## DATA LOOP ######################################################
xfieldstoinclude = ",1,2,3,4,"
xfieldstoinclude = ",1,2,3,4,5,6,7,8,9,10,11"
Dim array_project1(100)
Dim array_project2(100)
Dim array_project3(100)
rs1.MoveFirst
xindexno = xindexno + 1
For zrecordno = 1 To 35 ' number of records
Do While Not rs1.EOF
        xfieldinfo = ""
        'For zfieldno = 1 To 8 ' number of fieldss
        For zfieldno = 0 To rs1.Fields.Count - 1
                If InStr(1, xfieldstoinclude, "," & zfieldno & ",") Then
                        xfieldinfo = xfieldinfo & "<br/>" & UCase(rs1.Fields(zfieldno).name) & ": </B>" & ASCII2HTML(rs1.Fields(zfieldno).Value) ' & vbCrLf & "<hr/>"
                End If
        Next zfieldno
        
        ' which project is it???
        If rs1!acquisition = "s" Then array_project1(rs1!periodno) = array_project1(rs1!periodno) & xfieldinfo
                If rs1!acquisition = "g" Then array_project2(rs1!periodno) = array_project2(rs1!periodno) & xfieldinfo
                        If rs1!acquisition = "l" Then array_project3(rs1!periodno) = array_project3(rs1!periodno) & xfieldinfo
                                rs1.MoveNext
                                'Next zrecordno
                                Loop
                                
                                
                                
                                ######### PLACE DATA #####################################################################
                                start_of_periods = 5
                                xnumber_of_periods = 13
                                
                                X = X & "<TABLE BORDER>"
                                
                                X = X & "<TR >"
                                For COLS = start_of_periods To xnumber_of_periods
                                        StartDate = #8/1/2017#
                                        XHEADER = "PERIOD <BR/>" & DateAdd("D", COLS * 7, StartDate)
                                        X = X & "<TD>" & XHEADER & "</TD>"
                                Next COLS
                                X = X & "</TR>"
                                
                                X = X & "<TR style='background-color: #B8E2EF;'>"
                                For COLS = start_of_periods To xnumber_of_periods
                                        XDATA = array_project1(COLS)
                                        X = X & "<TD>" & XDATA & "</TD>"
                                Next COLS
                                X = X & "</TR>"
                                
                                X = X & "<TR style='background-color: #8BFEA8;'>"
                                For COLS = start_of_periods To xnumber_of_periods
                                        XDATA = array_project2(COLS)
                                        X = X & "<TD>" & XDATA & "</TD>"
                                Next COLS
                                X = X & "</TR>"
                                
                                X = X & "<TR style='background-color: #F2F4B3;'>"
                                For COLS = start_of_periods To xnumber_of_periods
                                        XDATA = array_project3(COLS)
                                        X = X & "<TD>" & XDATA & "</TD>"
                                Next COLS
                                X = X & "</TR>"
                                X = X & "</TABLE>"
                                
                                ############  END AND WRITE #############################################################################
                                fname = CurrentProject.path & "\TEMP.HTML"
                                Call PRINT_INFO(X, fname)
                                ReturnValue = Shell("EXPLORER.EXE " & fname, 1)  ' Run Calculator.
                                rs1.Close
                                rs2.Close
                                rs3.Close
                                Set rs1 = Nothing
                                Set rs2 = Nothing
                                Set rs3 = Nothing
                                
                                db.Close
                                Set db = Nothing
                                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function ASCII2HTML(X)
If Not IsNull(X) Then
        X = Replace(X, vbCrLf, "<BR>")
        Else
        X = " "
End If
ASCII2HTML = X
End Function
Attribute VB_Name = "INTRANET_SIMPLEx"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub INTRANET_SIMPLE()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "query1"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
xnewline = "<br/>" & vbCrLf
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
X = X & vbCrLf & "<html><head><style>"
X = X & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "TD { text-align: top; valign: top; text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "</style></head><body>"
##########################################################################
###looop 1 get index
##########################################################################
XMAXCOL = 7
XLISTOFCOLS = ",0,1,2,3,10,15,16,"
rs1.MoveFirst
X = X & vbCrLf & "<h1>TABLE OF CONTENTS <a name=TOC></h1>"
X = X & vbCrLf & "<table border WIDTH=1200>"
X = X & vbCrLf & "<tr>"
For z = 0 To rs1.Fields.Count - 1
        If InStr(1, XLISTOFCOLS, "," & z & ",") Then ' INCLUDE THIS FIELD NO IN INDEX
                X = X & vbCrLf & "<th>" & rs1.Fields(z).name & "</th>"     ' rs1.Fields(x).name,
        End If
Next z
X = X & vbCrLf & "</tr>"
Do While Not rs1.EOF
        
        X = X & vbCrLf & "<tr>"
        xaname = rs1.Fields(0).Value
        X = X & vbCrLf & "<TD valign=top><a HREF=#" & xaname & ">" & xaname & "</td>"    ' rs1.Fields(x).name,
        
        
        For z = 1 To rs1.Fields.Count - 1
                If InStr(1, XLISTOFCOLS, "," & z & ",") Then ' INCLUDE THIS FIELD NO IN INDEX
                        X = X & vbCrLf & "<td valign=top>" & ragg(rs1.Fields(z).Value) & "</td>"     ' rs1.Fields(x).name,
                End If
        Next z
        X = X & vbCrLf & "</tr>"
        
        
        rs1.MoveNext
        Loop
        
        X = X & vbCrLf & "</table border>"
        X = X & xnewline
        X = X & xnewline
        ##########################################################################
        ###looop 2 get detail
        ##########################################################################
        
        
        rs1.MoveFirst
        X = X & vbCrLf & "<h1>DETAILED BREAKDOWN <a name=TOC></h1>"
        X = X & "<br/><a href=#TOC>Go Top Table of Contents</a>"
        Do While Not rs1.EOF
                xaname = rs1.Fields(0).Value
                X = X & vbCrLf & "<p/><a name=" & xaname & ">" & xaname & "</A>"
                
                
                X = X & vbCrLf & "<TABLE BORDER WIDTH=1200>"
                For z = 1 To rs1.Fields.Count - 1
                        X = X & vbCrLf & "<TR>"
                        X = X & vbCrLf & "<td WIDTH=300 valign=top><B>" & rs1.Fields(z).name & "</B></td>"
                        X = X & vbCrLf & "<td valign=top>" & ragg(rs1.Fields(z).Value) & "</td>"     ' rs1.Fields(x).name,
                        X = X & vbCrLf & "</TR>"
                Next z
                
                X = X & vbCrLf & "</TABLE>"
                X = X & "<br/><a href=#TOC>Go Top Table of Contents</a>"
                rs1.MoveNext
                Loop
                
                X = X & xnewline
                X = X & xnewline
                
                
                
                
                FNAME = CurrentProject.path & "\TEMPFILE.html"
                Call PRINT_INFO(X, FNAME)
                ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function ragg(X)
ragg = X
If InStr(1, UCase(X), "#GREEN") Then X = Replace(X, "#GREEN", "<SPAN style='BACKGROUND-color: GREEN;'>#GREEN</SPAN>")
        If InStr(1, UCase(X), "#RED") Then X = Replace(X, "#RED", "<SPAN style='BACKGROUND-color: RED;'>#RED</SPAN>")
                If InStr(1, UCase(X), "#BLUE") Then X = Replace(X, "#BLUE", "<SPAN style='BACKGROUND-COLOR: BLUE;'>#BLUE</SPAN>")
                        If InStr(1, UCase(X), "#AMBER") Then X = Replace(X, "#AMBER", "<SPAN style='BACKGROUND-color: ORANGE;'>#AMBER</SPAN>")
                                If InStr(1, UCase(X), "#UNSURE") Then X = Replace(X, "#UNSURE", "<SPAN style='BACKGROUND-color: BLUE;'>#UNSURE</SPAN>")
                                        
                                        
                                        If UCase(X) = "Y" Then X = "<SPAN style='BACKGROUND-color: GREEN;'>Y</SPAN>"
                                                If UCase(X) = "N" Then X = "<SPAN style='BACKGROUND-color: RED;'>N</SPAN>"
                                                        
                                                        
                                                        ragg = X
End Function
Attribute VB_Name = "PMO_IanGoddardLogic"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub PMO_IanGoddard()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "Query2"
xnewline = "<br/>" & vbCrLf
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
X = X & vbCrLf & "<html><head><style>"
X = X & vbCrLf & "BODY {  color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial; position: absolute; z-index: -1; }"
X = X & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "TD { width: 500;  z-index: 0; text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "table { z-index: 0; border-collapse: collapse; border: 1px solid black;}"
X = X & vbCrLf & "table.timclass td {  width: 90;  }"
X = X & vbCrLf & ".newbutton:link { background-color: black; color: white;  text-decoration: none; font-size: 8pt; }"
https://stackoverflow.com/questions/36814921/90-degree-text-rotation-in-a-table
x = x & vbCrLf & "th, td, table{"
x = x & vbCrLf & "  border:solid 1px;"
x = x & vbCrLf & "}"
x = x & vbCrLf & ""
X = X & vbCrLf & "div.vertical{"
x = x & vbCrLf & "  margin-left: -85px;"
x = x & vbCrLf & "  position: absolute;"
x = x & vbCrLf & "  width: 215px;"
x = x & vbCrLf & "  height: 5px;"
x = x & vbCrLf & "   font-size: 9pt; "
X = X & vbCrLf & "   text-align: center; "
X = X & vbCrLf & "  transform: rotate(-90deg);"
X = X & vbCrLf & "  -webkit-transform: rotate(-90deg); /* Safari/Chrome */"
X = X & vbCrLf & "  -moz-transform: rotate(-90deg);    /* Firefox */"
X = X & vbCrLf & "  -o-transform: rotate(-90deg);      /* Opera */"
X = X & vbCrLf & "  -ms-transform: rotate(-90deg);     /* IE 9 */"
X = X & vbCrLf & "}"
X = X & vbCrLf & ""
X = X & vbCrLf & "th.vertical{"
x = x & vbCrLf & "  max-width: 50px;"
x = x & vbCrLf & "  height: 100px;"
x = x & vbCrLf & "  line-height: 14px;"
x = x & vbCrLf & "  padding-bottom: 2px;"
x = x & vbCrLf & "  text-align: inherit;"
X = X & vbCrLf & "}"
X = X & vbCrLf & ""
X = X & vbCrLf & "#DivForHoverItem {"
X = X & vbCrLf & "    /*just so we can see it*/"
x = x & vbCrLf & "    height: 16px;"
x = x & vbCrLf & "    width: 16px;"
x = x & vbCrLf & "    background-color: red;"
X = X & vbCrLf & "}"
X = X & vbCrLf & ""
X = X & vbCrLf & "#HiddenText {"
X = X & vbCrLf & "    display: none;"
x = x & vbCrLf & "    z-index: 1;"
x = x & vbCrLf & "    position: absolute;"
x = x & vbCrLf & "    width: 100%;"
X = X & vbCrLf & "}"
X = X & vbCrLf & ""
X = X & vbCrLf & "#DivForHoverItem:hover #HiddenText {"
x = x & vbCrLf & "    display:block;"
X = X & vbCrLf & "    display:inline;"
X = X & vbCrLf & "    background-color: yellow;"
X = X & vbCrLf & "    color: black;"
X = X & vbCrLf & "    position: absolute;"
X = X & vbCrLf & "    width: 250;"
X = X & vbCrLf & "    margin: 20;"
X = X & vbCrLf & "    height: 250;"
X = X & vbCrLf & "    z-index: 100;"
X = X & vbCrLf & "}"
X = X & vbCrLf & "</style></head><body>"
X = X & vbCrLf & "<script>"
X = X & vbCrLf & "function myFunction(param) {"
X = X & vbCrLf & "    var w = window.open('yourpage.htm','pagename','resizable,height=260,width=370');"
X = X & vbCrLf & "    w.document.open();"
X = X & vbCrLf & "    w.document.write(  param );"
X = X & vbCrLf & "    w.document.close();"
X = X & vbCrLf & "}"
X = X & vbCrLf & "</script>"
xno_cols = 5
###loop 1 get index
rs1.MoveFirst
X = X & "<table border valign=top >"
X = X & "<tr height=200>"
For q = 0 To xno_cols ' rs1.Fields.Count - 1
        '   x = x & "<td class='risk-th' > <div class='vertical'>" & rs1.Fields(q).name & "</div></td>" ' & rs1.Fields(q).Value
        'x = x & "<td  >  <div class='vertical'>" & rs1.Fields(q).name & "</div>  </td>" ' & rs1.Fields(q).Value
        
        X = X & "<td> " & rs1.Fields(q).name & "</td>" ' & rs1.Fields(q).Value
Next q
X = X & "</tr>"
Dim xarray(100)
Do While Not rs1.EOF
        ########################################
        
        For q = 0 To xno_cols ' rs1.Fields.Count - 1
                xarray(q) = rs1.Fields(q).Value
        Next q
        
        ########################################
        X = X & "<tr>"
        For q = 0 To xno_cols ' rs1.Fields.Count - 1
                xtext1 = Left(rs1.Fields(q).Value, 20)
                'xtext2 = postit(xtext1, xarray)
                xtext2 = showmore(xtext1, rs1.Fields(q).Value)
                X = X & "<td >" & xtext2 & "</td>" ' & rs1.Fields(q).Value
        Next q
        X = X & "</tr>"
        
        
        
        rs1.MoveNext
        Loop
        X = X & "</table border valign=top>"
        
        
        X = X & "<p/><hr/><p/>"
        
        
        ###loop 2 get body
        rs1.MoveFirst
        
        X = X & "<table border valign=top >"
        
        X = X & "<tr height=200>"
        For q = 0 To rs1.Fields.Count - 1
                '   x = x & "<td class='risk-th' > <div class='vertical'>" & rs1.Fields(q).name & "</div></td>" ' & rs1.Fields(q).Value
                X = X & "<td  >  <div class='vertical'>" & rs1.Fields(q).name & "</div>  </td>" ' & rs1.Fields(q).Value
                
                'x = x & "<td> " & rs1.Fields(q).name & "</td>" ' & rs1.Fields(q).Value
        Next q
        X = X & "</tr>"
        
        Dim xarray(100)
        Do While Not rs1.EOF
                ########################################
                
                For q = 0 To rs1.Fields.Count - 1
                        xarray(q) = rs1.Fields(q).Value
                Next q
                
                ########################################
                X = X & "<tr>"
                For q = 0 To rs1.Fields.Count - 1
                        xtext1 = Left(rs1.Fields(q).Value, 20)
                        'xtext2 = postit(xtext1, xarray)
                        xtext2 = showmore(xtext1, rs1.Fields(q).Value)
                        X = X & "<td >" & xtext2 & "</td>" ' & rs1.Fields(q).Value
                Next q
                X = X & "</tr>"
                
                
                
                rs1.MoveNext
                Loop
                X = X & "</table border valign=top>"
                
                
                
                
                xfilename = "PMO Report.html"
                xfilename = Replace(xfilename, " ", "")
                xfilename = Replace(xfilename, "\", "")
                xfilename = Replace(xfilename, "&", "")
                xfilename = Replace(xfilename, ")", "")
                xfilename = Replace(xfilename, "(", "")
                
                Call PRINT_INFO(X, xfilename)
                ReturnValue = Shell("explorer.EXE " & xfilename, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function showmore(shorttext, longtext)
showmore = "<div id='DivForHoverItem'>" & shorttext & " " & "<div id='HiddenText'>" & longtext & "</div></div>"
showmore = "<div id='DivForHoverItem'>" & shorttext & " " & "<div id='HiddenText' style='font-size: 9;'>" & longtext & "</div></div>"
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function postit(diplaytext, arrayinfo)
For q = LBound(arrayinfo) To UBound(arrayinfo)
        If Len(arrayinfo(q)) > 1 Then hiddentext = hiddentext & "<br/>" & arrayinfo(q)
        Next q
        postit = "<div id='DivForHoverItem'>" & diplaytext & " " & "<div id='HiddenText'>" & hiddentext & "</div></div>"
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function RAG(X)
If InStr(1, UCase(X), "#GREY") Then RAG = UCase("<b style='background-color:  #669999;'>" & X & "</b>")
        If InStr(1, UCase(X), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & X & "</b>")
                If InStr(1, UCase(X), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & X & "</b>")
                        If InStr(1, UCase(X), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & X & "</b>")
                                
End Function
Attribute VB_Name = "PMO_IanGoddardLogic"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub PMO_IanGoddard()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "Query1"
xnewline = "<br/>" & vbCrLf
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
X = X & vbCrLf & "<html><head><style>"
X = X & vbCrLf & "BODY {  color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial; position: absolute; z-index: -1; }"
X = X & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "TD { width: 500;  z-index: 0; text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "table { z-index: 0; border-collapse: collapse; border: 1px solid black;}"
X = X & vbCrLf & "table.timclass td {  width: 90;  }"
X = X & vbCrLf & ".newbutton:link { background-color: black; color: white;  text-decoration: none; font-size: 8pt; }"
https://stackoverflow.com/questions/36814921/90-degree-text-rotation-in-a-table
x = x & vbCrLf & "th, td, table{"
x = x & vbCrLf & "  border:solid 1px;"
x = x & vbCrLf & "}"
x = x & vbCrLf & ""
X = X & vbCrLf & "div.vertical{"
x = x & vbCrLf & "  margin-left: -85px;"
x = x & vbCrLf & "  position: absolute;"
x = x & vbCrLf & "  width: 215px;"
x = x & vbCrLf & "  height: 5px;"
x = x & vbCrLf & "   font-size: 9pt; "
X = X & vbCrLf & "   text-align: center; "
X = X & vbCrLf & "  transform: rotate(-90deg);"
X = X & vbCrLf & "  -webkit-transform: rotate(-90deg); /* Safari/Chrome */"
X = X & vbCrLf & "  -moz-transform: rotate(-90deg);    /* Firefox */"
X = X & vbCrLf & "  -o-transform: rotate(-90deg);      /* Opera */"
X = X & vbCrLf & "  -ms-transform: rotate(-90deg);     /* IE 9 */"
X = X & vbCrLf & "}"
X = X & vbCrLf & ""
X = X & vbCrLf & "th.vertical{"
x = x & vbCrLf & "  max-width: 50px;"
x = x & vbCrLf & "  height: 100px;"
x = x & vbCrLf & "  line-height: 14px;"
x = x & vbCrLf & "  padding-bottom: 2px;"
x = x & vbCrLf & "  text-align: inherit;"
X = X & vbCrLf & "}"
X = X & vbCrLf & ""
X = X & vbCrLf & "#DivForHoverItem {"
X = X & vbCrLf & "    /*just so we can see it*/"
x = x & vbCrLf & "    height: 16px;"
x = x & vbCrLf & "    width: 16px;"
x = x & vbCrLf & "    background-color: red;"
X = X & vbCrLf & "}"
X = X & vbCrLf & ""
X = X & vbCrLf & "#HiddenText {"
X = X & vbCrLf & "    display: none;"
x = x & vbCrLf & "    z-index: 1;"
x = x & vbCrLf & "    position: absolute;"
x = x & vbCrLf & "    width: 100%;"
X = X & vbCrLf & "}"
X = X & vbCrLf & ""
X = X & vbCrLf & "#DivForHoverItem:hover #HiddenText {"
x = x & vbCrLf & "    display:block;"
X = X & vbCrLf & "    display:inline;"
X = X & vbCrLf & "    background-color: yellow;"
X = X & vbCrLf & "    color: black;"
X = X & vbCrLf & "    position: absolute;"
X = X & vbCrLf & "    width: 250;"
X = X & vbCrLf & "    margin: 20;"
X = X & vbCrLf & "    height: 250;"
X = X & vbCrLf & "    z-index: 100;"
X = X & vbCrLf & "}"
X = X & vbCrLf & "</style></head><body>"
X = X & vbCrLf & "<script>"
X = X & vbCrLf & "function myFunction(param) {"
X = X & vbCrLf & "    var w = window.open('yourpage.htm','pagename','resizable,height=260,width=370');"
X = X & vbCrLf & "    w.document.open();"
X = X & vbCrLf & "    w.document.write(  param );"
X = X & vbCrLf & "    w.document.close();"
X = X & vbCrLf & "}"
X = X & vbCrLf & "</script>"
xno_cols = 5
###loop 1 get index
rs1.MoveFirst
X = X & "<table border valign=top >"
X = X & "<tr height=200>"
For q = 0 To xno_cols ' rs1.Fields.Count - 1
        '   x = x & "<td class='risk-th' > <div class='vertical'>" & rs1.Fields(q).name & "</div></td>" ' & rs1.Fields(q).Value
        'x = x & "<td  >  <div class='vertical'>" & rs1.Fields(q).name & "</div>  </td>" ' & rs1.Fields(q).Value
        
        X = X & "<td> " & rs1.Fields(q).name & "</td>" ' & rs1.Fields(q).Value
Next q
X = X & "</tr>"
Dim xarray(100)
Do While Not rs1.EOF
        ########################################
        
        For q = 0 To xno_cols ' rs1.Fields.Count - 1
                xarray(q) = rs1.Fields(q).Value
        Next q
        
        ########################################
        X = X & "<tr>"
        For q = 0 To xno_cols ' rs1.Fields.Count - 1
                xtext1 = Left(rs1.Fields(q).Value, 20)
                'xtext2 = postit(xtext1, xarray)
                xtext2 = showmore(xtext1, rs1.Fields(q).Value)
                X = X & "<td >" & xtext2 & "</td>" ' & rs1.Fields(q).Value
        Next q
        X = X & "</tr>"
        
        
        
        rs1.MoveNext
        Loop
        X = X & "</table border valign=top>"
        
        
        X = X & "<p/><hr/><p/>"
        
        
        ###loop 2 get body
        rs1.MoveFirst
        
        X = X & "<table border valign=top >"
        
        X = X & "<tr height=200>"
        For q = 0 To rs1.Fields.Count - 1
                '   x = x & "<td class='risk-th' > <div class='vertical'>" & rs1.Fields(q).name & "</div></td>" ' & rs1.Fields(q).Value
                X = X & "<td  >  <div class='vertical'>" & rs1.Fields(q).name & "</div>  </td>" ' & rs1.Fields(q).Value
                
                'x = x & "<td> " & rs1.Fields(q).name & "</td>" ' & rs1.Fields(q).Value
        Next q
        X = X & "</tr>"
        
        Dim xarray(100)
        Do While Not rs1.EOF
                ########################################
                
                For q = 0 To rs1.Fields.Count - 1
                        xarray(q) = rs1.Fields(q).Value
                Next q
                
                ########################################
                X = X & "<tr>"
                For q = 0 To rs1.Fields.Count - 1
                        xtext1 = Left(rs1.Fields(q).Value, 20)
                        'xtext2 = postit(xtext1, xarray)
                        xtext2 = showmore(xtext1, rs1.Fields(q).Value)
                        X = X & "<td >" & xtext2 & "</td>" ' & rs1.Fields(q).Value
                Next q
                X = X & "</tr>"
                
                
                
                rs1.MoveNext
                Loop
                X = X & "</table border valign=top>"
                
                
                
                
                xfilename = "PMO Report.html"
                xfilename = Replace(xfilename, " ", "")
                xfilename = Replace(xfilename, "\", "")
                xfilename = Replace(xfilename, "&", "")
                xfilename = Replace(xfilename, ")", "")
                xfilename = Replace(xfilename, "(", "")
                
                Call PRINT_INFO(X, xfilename)
                ReturnValue = Shell("explorer.EXE " & xfilename, 1)  ' Run Calculator.
                
                
                
                rs1.Close
                rs2.Close
                rs3.Close
                Set rs1 = Nothing
                Set rs2 = Nothing
                Set rs3 = Nothing
                
                db.Close
                Set db = Nothing
                
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function showmore(shorttext, longtext)
showmore = "<div id='DivForHoverItem'>" & shorttext & " " & "<div id='HiddenText'>" & longtext & "</div></div>"
showmore = "<div id='DivForHoverItem'>" & shorttext & " " & "<div id='HiddenText' style='font-size: 9;'>" & longtext & "</div></div>"
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function postit(diplaytext, arrayinfo)
For q = LBound(arrayinfo) To UBound(arrayinfo)
        If Len(arrayinfo(q)) > 1 Then hiddentext = hiddentext & "<br/>" & arrayinfo(q)
        Next q
        postit = "<div id='DivForHoverItem'>" & diplaytext & " " & "<div id='HiddenText'>" & hiddentext & "</div></div>"
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function RAG(X)
If InStr(1, UCase(X), "#GREY") Then RAG = UCase("<b style='background-color:  #669999;'>" & X & "</b>")
        If InStr(1, UCase(X), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & X & "</b>")
                If InStr(1, UCase(X), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & X & "</b>")
                        If InStr(1, UCase(X), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & X & "</b>")
                                
End Function
Attribute VB_Name = "PMO_web_report"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub web_report_pmo()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "List of Projects Query"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
#############################
xtext = xtext & "<h1> List of Projects </h1>"
#############################
###loop 2 get data
xtext = xtext & "<table border>"
rs1.MoveFirst
xtext = xtext & "<tr>"
For x = 0 To rs1.Fields.Count - 1
        xtext = xtext & "<br/>" & UCase(rs1.Fields(x).name)  '"</td>"
        xtext = xtext
Next x
  xtext = xtext & "</tr>"
Do While Not rs1.EOF
        
        
        
        
        
        xtext = xtext & "<tr>"
        For X = 0 To rs1.Fields.Count - 1
                xtext = xtext & "<br/><b>" & RAG(rs1.Fields(X).name) & " </b> " & RAG(rs1.Fields(X).Value) '& "</td>"
                xtext = xtext
        Next X
        'xtext = xtext & "</tr>"
        xtext = xtext & "<p/><hr/>"
        
        rs1.MoveNext
        Loop
        
        xtext = xtext & "</table>"
        xtext = xtext & "<p/><hr/>"
        Debug.Print X
        FNAME = CurrentProject.path & "\TEMP.html"
        Call PRINT_INFO(xtext, FNAME)
        
        
        ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function RAG(X)
RAG = X
If InStr(1, UCase(X), "#GREY") Then RAG = UCase("<b style='background-color:  #669999;'>" & X & "</b>")
        If InStr(1, UCase(X), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & X & "</b>")
                If InStr(1, UCase(X), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & X & "</b>")
                        If InStr(1, UCase(X), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & X & "</b>")
                                
End Function
Attribute VB_Name = "PMO_web_table"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub web_table_pmo()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "List of Projects Query"
xsql1 = "HTML_ProjectRisks"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
xnewline = "<br/>" & vbCrLf
xtext = xtext & vbCrLf & "<html><head><style>"
xtext = xtext & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H1 { color: blue;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H2 { color: blue;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H3 { color: blue;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "H4 { background-color: red; color: blue;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
xtext = xtext & vbCrLf & "</style></head><body>"
#############################
xtext = xtext & "<h1> List of Projects </h1>"
#############################
###loop 2 get data
xtext = xtext & "<table border>"
rs1.MoveFirst
xtext = xtext & "<tr>"
For X = 0 To rs1.Fields.Count - 1
        xtext = xtext & "<td>" & UCase(rs1.Fields(X).name) & "</td>"
        xtext = xtext
Next X
xtext = xtext & "</tr>"
Do While Not rs1.EOF
        
        
        
        
        
        xtext = xtext & "<tr>"
        For X = 0 To rs1.Fields.Count - 1
                xtext = xtext & "<td>" & RAG(rs1.Fields(X).Value) & "</td>"
                xtext = xtext
        Next X
        xtext = xtext & "</tr>"
        
        
        rs1.MoveNext
        Loop
        
        xtext = xtext & "</table>"
        Debug.Print X
        FNAME = CurrentProject.path & "\TEMP.html"
        Call PRINT_INFO(xtext, FNAME)
        
        
        ReturnValue = Shell("explorer.EXE " & FNAME, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function RAG(X)
RAG = X
If InStr(1, UCase(X), "#GREY") Then RAG = UCase("<b style='background-color:  #669999;'>" & X & "</b>")
        If InStr(1, UCase(X), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & X & "</b>")
                If InStr(1, UCase(X), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & X & "</b>")
                        If InStr(1, UCase(X), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & X & "</b>")
                                
End Function
Attribute VB_Name = "print_infox"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function PRINT_INFO(ByVal PARAM_TEXT As String, ByVal xoutput As String) 'vba_excel report cells, create file, print file, notepad
Dim FILENUMBER1 As Integer
Dim xpath As String
Dim xfilename As String
xpath = ActiveWorkbook.Path & "\"
xfilename = "TEMP" & Format(Now(), "yymmdd") & "-" & Format(Now(), "HHMM") & ".txt"
xfilename = xoutput
FILENUMBER1 = FreeFile
Open xpath & xfilename For Output As #FILENUMBER1 '
Print #FILENUMBER1, PARAM_TEXT
Close #FILENUMBER1
Call open_file(xpath & xfilename)
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function open_file(xfilename As String)
vba_excel report cells, create file, print file, notepad
Dim ReturnValue, I
ReturnValue = Shell("notepad.EXE " & xfilename, 1)  ' Run Calculator.
AppActivate ReturnValue
End Function
Attribute VB_Name = "print_infox"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function PRINT_INFO(ByVal PARAM_TEXT As String, ByVal xoutput As String) 'vba_excel report cells, create file, print file, notepad
Dim FILENUMBER1 As Integer
Dim xpath As String
Dim xfilename As String
xpath = ActiveWorkbook.Path & "\"
xfilename = "TEMP" & Format(Now(), "yymmdd") & "-" & Format(Now(), "HHMM") & ".txt"
xfilename = xoutput
FILENUMBER1 = FreeFile
Open xpath & xfilename For Output As #FILENUMBER1 '
Print #FILENUMBER1, PARAM_TEXT
Close #FILENUMBER1
Call open_file(xpath & xfilename)
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function open_file(xfilename As String)
vba_excel report cells, create file, print file, notepad
Dim ReturnValue, I
ReturnValue = Shell("notepad.EXE " & xfilename, 1)  ' Run Calculator.
AppActivate ReturnValue
End Function
Attribute VB_Name = "reports_2notepad"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub reports02_2wkly2()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "query1"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
Do While Not rs1.EOF
        
        
        xshortname = rs1!ShortName
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        xContents = rs1!Contents
        xapproach = rs1!Approach
        xmemo = rs1!Memo
        xrisksummary = rs1!RiskSummary
        lprogress = rs1!wsProgress
        lrisk = rs1!wsRisks
        lnext = rs1!wsnext
        
        gprogress = rs1!gprogress
        grisk = rs1!grisk
        gnext = rs1!gnext
        
        
        
        If xtext1 <> prev_xtext1 Then
                X = X & vbCrLf & "WORK-STREAM " & UCase(xtext2) & vbCrLf
                X = X & "=============================================================================== " & vbCrLf
                X = X & vbCrLf & UCase("Work-Stream Owner: ") & (xtext1) & vbCrLf
                X = X & vbCrLf & UCase("Contents: ") & (xContents) & vbCrLf
                X = X & vbCrLf & UCase("Approach: ") & (xapproach) & vbCrLf
                X = X & vbCrLf & UCase("Memo: ") & (xmemo) & vbCrLf
                X = X & vbCrLf & UCase("Risk Summary: ") & (xrisksummary) & vbCrLf
                
                prev_xtext1 = xtext1
        End If
        
        
        
        
        
        
        
        If flag_listsky = "YES" Then '#########################
                xc = 0
                xc = xc + 1
                X = X & vbCrLf & "PROJECT SKY WORK" & vbCrLf
                
                X = X & vbCrLf & "Progress: " & (lprogress) & vbCrLf
                X = X & vbCrLf & "Risk: " & (lrisk) & vbCrLf
                X = X & vbCrLf & "Next: " & (lnext) & vbCrLf
                
        End If ''################################################
        
        
        
        ' flag_listbudgets = "YES"
        If flag_listbudgets = "YES" Then '#########################
                
                '### budgets ######
                rs2.MoveFirst
                xd = vbTab
                xsum = 0
                X = X & vbCrLf & "BUDGETS" & vbCrLf
                Do While Not rs2.EOF
                        
                        zshortname = rs2!ShortName
                        If zshortname = xshortname Then
                                X = X & vbCrLf & padd(rs2!Item, 10) & padd(rs2!desc, 20) & padd(rs2!capex, 10) & padd(rs2!notes, 20)
                                '  x = x & vbCrLf & rs2!Item & xd & rs2!desc & xd & rs2!capex & xd & rs2!revex & xd & rs2!notes
                                xsum = xsum + rs2!capex
                        End If
                        
                        rs2.MoveNext
                        Loop
                        X = X & vbCrLf & "TOTAL  " & Format(xsum, "0,000.00") & vbCrLf
                        
                End If 'flag_listbudgets = "YES" Then '#########################
                
                
                
                
                If FLAG = Deliverables = "YES" Then '#########################
                        '### deliverables ######
                        rs3.MoveFirst
                        xd = vbTab
                        xc = 0
                        X = X & vbCrLf & "DELIVERABLES (Tasks to do or documents to draft/approve)" & vbCrLf
                        Do While Not rs3.EOF
                                Dshortname = rs3!ShortName
                                XDELIVERABLE = rs3!PRODUCT_DELIVERABLE
                                XDESCRIPTION = rs3!DESCRIPTION
                                If Dshortname = xshortname Then
                                        xc = xc + 1
                                        X = X & vbCrLf & Format(xc, " 00 ") & XDELIVERABLE
                                        '  x = x & vbCrLf & rs2!Item & xd & rs2!desc & xd & rs2!capex & xd & rs2!revex & xd & rs2!notes
                                        
                                End If
                                
                                rs3.MoveNext
                                Loop
                                X = X & vbCrLf & vbCrLf
                                
                        End If 'flag = Deliverables = "YES" Then '#########################
                        
                        
                        
                        
                        If flag_listgreenhouse = "YES" Then '========================================================
                                X = X & vbCrLf & "PROJECT GREENHOUSE WORK " & vbCrLf
                                X = X & vbCrLf & "Progress: " & (gprogress) & vbCrLf
                                X = X & vbCrLf & "Risk: " & (grisk) & vbCrLf
                                X = X & vbCrLf & "Next: " & (grisk) & vbCrLf
                        End If '========================================================
                        
                        
                        
                        rs1.MoveNext
                        Loop
                        
                        Debug.Print X
                        fname = CurrentProject.path & "\TEMP.TXT"
                        Call PRINT_INFO(X, fname)
                        
                        rs1.Close
                        rs2.Close
                        rs3.Close
                        Set rs1 = Nothing
                        Set rs2 = Nothing
                        Set rs3 = Nothing
                        
                        db.Close
                        Set db = Nothing
                        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, X)
padd = Left(xtext & "                                                                                                                ", X) & vbTab
End Function
Attribute VB_Name = "table2report"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub table2report()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
rs1.MoveFirst
For X = 0 To rs1.Fields.Count - 1
        Debug.Print X, rs1.Fields(X).name, rs1.Fields(X).Value
Next X
Do While Not rs1.EOF
        
        
        xtext = xtext & vbCrLf
        xtext = xtext & "=============================="
        For X = 0 To rs1.Fields.Count - 1
                xtext = xtext & vbCrLf & UCase(rs1.Fields(X).name) & ": " & rs1.Fields(X).Value
                xtext = xtext & vbCrLf
        Next X
        
        
        
        
        'rs1.Edit
        'rs1!Detail = xtext
        'rs1.Update
        
        
        
        
        rs1.MoveNext
        Loop
        
        
        Debug.Print X
        FNAME = CurrentProject.path & "\TEMP.TXT"
        Call PRINT_INFO(xtext, FNAME)
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, X)
padd = Left(xtext & "                                                                                                                ", X) & vbTab
End Function
Attribute VB_Name = "update_dowhile01"
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub update_dowhile()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "workstreams"
xsql2 = Query
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
Do While Not rs1.EOF
        If IsNull(rs1!Memo) Then
                skip
                Else
                xtext = rs1!Memo
                xtext = Replace(xtext, vbCrLf, "//")
                
                rs1.Edit
                rs1!Memo = xtext
                
                rs1.Update
        End If
        
        
        rs1.MoveNext
        Loop
        
        
        rs1.Close
        Set rs1 = Nothing
        rs2.Close
        Set rs2 = Nothing
        db.Close
        Set db = Nothing
        
End Sub
Attribute VB_Name = "vba_export_modulx"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub vba_export_modules()
#http://www.cpearson.com/Excel/VBE.aspx
 reference to extensibility library
xprefix = "C:\Users\Tim\Documents\Data2017\VBA\VBAAccess\vba_"
Dim objMyProj As VBProject
Dim objVBComp As VBComponent
Set objMyProj = Application.VBE.ActiveVBProject
For Each objVBComp In objMyProj.VBComponents
        If objVBComp.Type = vbext_ct_StdModule Then
                Debug.Print "Exporting " & xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".txt"
                
                objVBComp.Export xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".bas"
                objVBComp.Export xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".txt"
                
        End If
        Next
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function PRINT_INFO1(ByVal PARAM_TEXT As String, ByVal xoutput As String) 'vba_excel report cells, create file, print file, notepad
Dim FILENUMBER1 As Integer
Dim xpath As String
Dim xfilename As String
xpath = ActiveWorkbook.Path & "\"
xfilename = "TEMP" & Format(Now(), "yymmdd") & "-" & Format(Now(), "HHMM") & ".txt"
xfilename = xoutput
FILENUMBER1 = FreeFile
Open xpath & xfilename For Output As #FILENUMBER1 '
Print #FILENUMBER1, PARAM_TEXT
Close #FILENUMBER1
Call open_file(xpath & xfilename)
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function open_file(xfilename As String)
vba_excel report cells, create file, print file, notepad
Dim ReturnValue, I
ReturnValue = Shell("notepad.EXE " & xfilename, 1)  ' Run Calculator.
AppActivate ReturnValue
End Function
Attribute VB_Name = "vba_export_modulx"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub vba_export_modules()
#http://www.cpearson.com/Excel/VBE.aspx
 reference to extensibility library
xprefix = "C:\Users\Tim\Documents\Data2017\VBA\VBAAccess\vba_"
Dim objMyProj As VBProject
Dim objVBComp As VBComponent
Set objMyProj = Application.VBE.ActiveVBProject
For Each objVBComp In objMyProj.VBComponents
        If objVBComp.Type = vbext_ct_StdModule Then
                Debug.Print "Exporting " & xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".txt"
                
                objVBComp.Export xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".bas"
                objVBComp.Export xprefix & objVBComp.name & Format(Date, "yyyymmdd-") & ".txt"
                
        End If
        Next
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function PRINT_INFO1(ByVal PARAM_TEXT As String, ByVal xoutput As String) 'vba_excel report cells, create file, print file, notepad
Dim FILENUMBER1 As Integer
Dim xpath As String
Dim xfilename As String
xpath = ActiveWorkbook.Path & "\"
xfilename = "TEMP" & Format(Now(), "yymmdd") & "-" & Format(Now(), "HHMM") & ".txt"
xfilename = xoutput
FILENUMBER1 = FreeFile
Open xpath & xfilename For Output As #FILENUMBER1 '
Print #FILENUMBER1, PARAM_TEXT
Close #FILENUMBER1
Call open_file(xpath & xfilename)
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function open_file(xfilename As String)
vba_excel report cells, create file, print file, notepad
Dim ReturnValue, I
ReturnValue = Shell("notepad.EXE " & xfilename, 1)  ' Run Calculator.
AppActivate ReturnValue
End Function
Attribute VB_Name = "vlookup_gettable_intoarray"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub test()
qfieldsarray = vlookup2array("Deliverables", 1, "Legal&Contracts")
For z = LBound(qfieldsarray) To UBound(qfieldsarray)
        If Len(qfieldsarray(z)) > 1 Then
                Debug.Print qfieldsarray(z)
        End If
Next z
For t = 0 To 0
        Debug.Print t, "---------------------------------------"
        qfieldsarray = vlookup2array("workstreams", 8, "Legal&Contracts")
        For z = LBound(qfieldsarray) To UBound(qfieldsarray)
                If Len(qfieldsarray(z)) > 1 Then
                        ' Debug.Print qfieldsarray(z)
                End If
        Next z
Next t
qfieldsarray = vlookup2array("workstreams", 8, "Legal&Contracts")
For z = LBound(qfieldsarray) To UBound(qfieldsarray)
        If Len(qfieldsarray(z)) > 1 Then
                Debug.Print qfieldsarray(z)
        End If
Next z
Debug.Print answer
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function vlookup2array(TABLENAME, column2match, data2match)
Dim xfieldsarray(100)
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = TABLENAME
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
rs1.MoveFirst
Do While Not rs1.EOF
        
        
        If rs1.Fields(column2match).Value = data2match Then
                
                
                For X = 0 To rs1.Fields.Count - 1
                        ' Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
                        xfieldsarray(X) = rs1.Fields(X).Value
                        
                Next X
                
                
                
        End If
        
        rs1.MoveNext
        Loop
        
        
        vlookup2array = xfieldsarray
        rs1.Close
        
        Set rs1 = Nothing
        
        
        db.Close
        Set db = Nothing
        
End Function
Attribute VB_Name = "word_long_reportx"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub word_long_report()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, x, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
xnewline = "<br/>" & vbCrLf
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
x = x & vbCrLf & "<html><head><style>"
x = x & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H1 { color: BROWN;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H2 { color: BROWN;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H3 { color: BROWN;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "H4 { background-color: red; color: BROWN;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
x = x & vbCrLf & "table { border-collapse: collapse; border: 1px solid black;}"
x = x & vbCrLf & "@media print {"
x = x & vbCrLf & "    h1 {page-break-before: always;}"
x = x & vbCrLf & "}"
x = x & vbCrLf & "</style></head><body>"
x = x & xnewline & "PROJECT SKY " & Now()
x = x & xnewline & "Please look at this report and let me know any changes (updates) necessary to the scope, tasks, RAG-setting or budgets. Once I have all the feedback I will update and circulate with the Agenda and Report for the next Steering XZXZXZ which will be attended by Julian. If you have anything you need to present for Julian to review or approve, please give me copies by the end of the week and I can circulate with the Progress Report and an Agenda ahead of the meeting."
INDEXF = 2 ' E2ND FIELD IS THE INDEX
xaname = UCase(rs1.Fields(INDEXF).Value)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
topheaderdata = x ' hold this in a variable that we will call later to add to the top
Do While Not rs1.EOF
        x = "" ' now start blank for each work-stream
        xaname = UCase(rs1.Fields(INDEXF).Value)
        xtitle = UCase(rs1.Fields(INDEXF).Value)
        x = x & vbCrLf & "<p/><a name=" & xaname & ">"
        
        
        xshortname = rs1!ShortName
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        xContents = rs1!Contents
        xapproach = rs1!Approach
        xmemo = rs1!Memo
        xrisksummary = rs1!RiskSummary
        
        
        
        
        x = x & xnewline & "<h1>" & tCase("WORK-STREAM " & xtext2) & "</h1>" & xnewline
        ' x = x & "=============================================================================== " & xnewline
        x = x & xnewline & tCase("Work-Stream Owner: ") & (xtext1) & xnewline
        x = x & xnewline & tCase("Contents: ") & (xContents) & xnewline
        x = x & xnewline & tCase("Approach: ") & (xapproach) & xnewline
        x = x & xnewline & tCase("Memo: ") & (xmemo) & xnewline
        x = x & xnewline & tCase("Risk Summary: ") & (xrisksummary) & xnewline
        
        x = x & xnewline & tCase("RAG: ") & RAG(UCase(rs1.Fields(7).Value)) & " " & rs1.Fields(8).Value & xnewline
        
        
        
        
        flag_listprogress = "YES"
        If flag_listprogress = "YES" Then '#########################
                TABLENAME = "HTML_progress"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                x = x & xnewline & tCase("PROGRESS REPORTS") & xnewline
                x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If ''################################################
        
        
        
        If FLAG_SEEKFEEDBACK = "yes" Then
                
                x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
                xlink = xshortname
                xlink = Replace(xlink, "&", "_")
                xlink = Replace(xlink, " ", "_")
                xlink = Replace(xlink, " ", "%20")
                x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                
        End If
        
        
        
        
        flag_listbudgets = "YES"
        If flag_listbudgets = "YES" Then '#########################
                TABLENAME = "HTML_Budgets"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                x = x & xnewline & tCase("BUDGETS") & xnewline
                
                x = x & xnewline & "With the various acquisition streams ongoing, this is just a reminder to advise that various invoices for professional services, travel, accommodation etc should be coded to nominal code 7740 for now, at least until such time as we own any new XZXZXZ and, from there, separate cost centres/nominal codes will be opened in due course."
                x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If 'flag_listbudgets = "YES" Then '#########################
        
        
        
        flagxDeliverables = "YES"
        If flagxDeliverables = "YES" Then  '#########################
                TABLENAME = "HTML_DELIVERABLES"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                x = x & xnewline & tCase("DELIVERABLES") & xnewline
                x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If 'flag = Deliverables = "YES" Then '#########################
        
        
        
        '   x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
        xlink = xshortname
        xlink = Replace(xlink, "&", "_")
        xlink = Replace(xlink, " ", "_")
        xlink = Replace(xlink, " ", "%20")
        ' x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
        
        
        
        x = x & xnewline
        '  x = x & "<br/><a href=#TOC>Go Top Table of Contents</a><HR/>"
        
        
        ################################
        
        wscount = wscount + 1
        xfilename = xshortname
        xfilename = Replace(xfilename, " ", "")
        xfilename = Replace(xfilename, "\", "")
        xfilename = Replace(xfilename, "&", "")
        xfilename = Replace(xfilename, ")", "")
        xfilename = Replace(xfilename, "(", "")
        If xflag = "ws" Then
                fname = CurrentProject.path & "\WORK-STREAM " & xfilename & ".html"
                Call PRINT_INFO(xtext, fname)
                ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        End If
        
        fulltext = fulltext & x
        x = ""
        ################################
        
        
        
        rs1.MoveNext
        Loop
        
        fulltext = topheaderdata & fulltext ' add header data to the front!
        
        
        XDATE = Format(Now, "DDD-DD-MMM-YYYY")
        fname = CurrentProject.path & "\PROJECT_SKY_LONG_" & XDATE & ".html"
        fname = CurrentProject.path & "\PROJECT_SKY_LONG_" & XDATE & ".docx"
        Call PRINT_INFO(fulltext, fname)
        
        
        ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, x)
padd = Left(xtext & "...............................................................", x) & vbTab
padd = xtext
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function tCase(x)
tCase = UCase("<b style='color:  #1ac6ff;'>" & x & "</b>")
tCase = UCase("<b style='color: BLUE;'>" & x & "</b>")
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function XRAG(x)
If InStr(1, UCase(x), "#GREY") Then RAG = UCase("<b style='background-color:  #669999;'>" & x & "</b>")
        If InStr(1, UCase(x), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & x & "</b>")
                If InStr(1, UCase(x), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & x & "</b>")
                        If InStr(1, UCase(x), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & x & "</b>")
                                
End Function
Attribute VB_Name = "word_long_reportx"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub word_long_report()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
xnewline = "<br/>" & vbCrLf
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
X = X & vbCrLf & "<html><head><style>"
X = X & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H1 { color: BROWN;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H2 { color: BROWN;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H3 { color: BROWN;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H4 { background-color: red; color: BROWN;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "table { border-collapse: collapse; border: 1px solid black;}"
X = X & vbCrLf & "@media print {"
X = X & vbCrLf & "    h1 {page-break-before: always;}"
X = X & vbCrLf & "}"
X = X & vbCrLf & "</style></head><body>"
X = X & xnewline & "PROJECT SKY " & Now()
X = X & xnewline & "Please look at this report and let me know any changes (updates) necessary to the scope, tasks, RAG-setting or budgets. Once I have all the feedback I will update and circulate with the Agenda and Report for the next Steering XZXZXZ which will be attended by Julian. If you have anything you need to present for Julian to review or approve, please give me copies by the end of the week and I can circulate with the Progress Report and an Agenda ahead of the meeting."
INDEXF = 2 ' E2ND FIELD IS THE INDEX
xaname = UCase(rs1.Fields(INDEXF).Value)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
topheaderdata = X ' hold this in a variable that we will call later to add to the top
Do While Not rs1.EOF
        X = "" ' now start blank for each work-stream
        xaname = UCase(rs1.Fields(INDEXF).Value)
        xtitle = UCase(rs1.Fields(INDEXF).Value)
        X = X & vbCrLf & "<p/><a name=" & xaname & ">"
        
        
        xshortname = rs1!ShortName
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        xContents = rs1!Contents
        xapproach = rs1!Approach
        xmemo = rs1!Memo
        xrisksummary = rs1!RiskSummary
        xissues = rs1!PMCommentConcern
        
        
        
        
        X = X & xnewline & "<h1>" & tCase("WORK-STREAM " & xtext2) & "</h1>" & xnewline
        ' x = x & "=============================================================================== " & xnewline
        X = X & xnewline & tCase("Work-Stream Owner: ") & (xtext1) & xnewline
        X = X & xnewline & tCase("RAG: ") & RAG(UCase(rs1.Fields(7).Value)) & " " & rs1.Fields(8).Value & xnewline
        X = X & xnewline & tCase("Scope / Contents: ") & (xContents) & xnewline
        X = X & xnewline & tCase("Approach: ") & (xapproach) & xnewline
        X = X & xnewline & tCase("Memo / Decisions: ") & ragmemo(xmemo) & xnewline
        X = X & xnewline & tCase("Risk Summary: ") & (xrisksummary) & xnewline
        X = X & xnewline & tCase("dISCUSSION Issues: ") & (xissues) & xnewline
        
        
        
        
        
        
        
        flag_listprogress = "no"
        If flag_listprogress = "YES" Then '#########################
                TABLENAME = "HTML_progress"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                X = X & xnewline & tCase("PROGRESS REPORTS") & xnewline
                'x = x & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
                X = X & GETTABLE_2HTML_top3(TABLENAME, FIRSTCOLUMNMATCH)
                
        End If ''################################################
        
        
        
        If FLAG_SEEKFEEDBACK = "yes" Then
                
                X = X & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
                xlink = xshortname
                xlink = Replace(xlink, "&", "_")
                xlink = Replace(xlink, " ", "_")
                xlink = Replace(xlink, " ", "%20")
                X = X & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                
        End If
        
        
        
        
        flag_listbudgets = "YES"
        If flag_listbudgets = "YES" Then '#########################
                TABLENAME = "HTML_Budgets"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                X = X & xnewline & tCase("BUDGETS") & xnewline
                
                X = X & xnewline & "With the various acquisition streams ongoing, this is just a reminder to advise that various invoices for professional services, travel, accommodation etc should be coded to nominal code 7740 for now, at least until such time as we own any new XZXZXZ and, from there, separate cost centres/nominal codes will be opened in due course."
                X = X & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If 'flag_listbudgets = "YES" Then '#########################
        
        
        
        flagxDeliverables = "YES"
        If flagxDeliverables = "YES" Then  '#########################
                TABLENAME = "HTML_DELIVERABLES"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                X = X & xnewline & tCase("DELIVERABLES") & xnewline
                X = X & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If 'flag = Deliverables = "YES" Then '#########################
        
        
        
        '   x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
        xlink = xshortname
        xlink = Replace(xlink, "&", "_")
        xlink = Replace(xlink, " ", "_")
        xlink = Replace(xlink, " ", "%20")
        ' x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
        
        
        
        X = X & xnewline
        '  x = x & "<br/><a href=#TOC>Go Top Table of Contents</a><HR/>"
        
        
        ################################
        
        wscount = wscount + 1
        xfilename = xshortname
        xfilename = Replace(xfilename, " ", "")
        xfilename = Replace(xfilename, "\", "")
        xfilename = Replace(xfilename, "&", "")
        xfilename = Replace(xfilename, ")", "")
        xfilename = Replace(xfilename, "(", "")
        If XFLAG = "ws" Then
                fname = CurrentProject.path & "\WORK-STREAM " & xfilename & ".html"
                Call PRINT_INFO(xtext, fname)
                ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        End If
        
        fulltext = fulltext & X
        X = ""
        ################################
        
        
        
        rs1.MoveNext
        Loop
        
        fulltext = topheaderdata & fulltext ' add header data to the front!
        
        
        XDATE = Format(Now, "DDD-DD-MMM-YYYY")
        fname = CurrentProject.path & "\PROJECT_SKY_LONG_" & XDATE & ".html"
        fname = CurrentProject.path & "\PROJECT_SKY_LONG_" & XDATE & ".docx"
        Call PRINT_INFO(fulltext, fname)
        
        
        ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function padd(xtext, X)
padd = Left(xtext & "...............................................................", x) & vbTab
padd = xtext
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function tCase(X)
tCase = UCase("<b style='color:  #1ac6ff;'>" & X & "</b>")
tCase = UCase("<b style='color: BLUE;'>" & X & "</b>")
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function XRAG(X)
If InStr(1, UCase(X), "#GREY") Then RAG = UCase("<b style='background-color:  #669999;'>" & X & "</b>")
        If InStr(1, UCase(X), "#RED") Then RAG = UCase("<b style='background-color:  RED;'>" & X & "</b>")
                If InStr(1, UCase(X), "#AMBER") Then RAG = UCase("<b style='background-color:  #ff6600;'>" & X & "</b>")
                        If InStr(1, UCase(X), "#GREEN") Then RAG = UCase("<b style='background-color:  GREEN;'>" & X & "</b>")
                                XRAG = RAG
End Function
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function ragmemo(X)
If InStr(1, (x), "ANSWER") Then x = Replace(x, "ANSWER", "<b style='background-color:  RED;'>ANSWER</b>")
        If InStr(1, (X), "ANSWER:") Then X = Replace(X, "ANSWER:", "<b style='color:  RED;'>ANSWER:</b>")
                If InStr(1, (X), "QUESTION:") Then X = Replace(X, "QUESTION:", "<b style='color:  GREEN;'>QUESTION:</b>")
                        ragmemo = X
End Function
Attribute VB_Name = "word_short_reportx"
Option Compare Database
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Sub word_short_report()
http://www.everythingaccess.com/tutorials.asp?ID=VBA-Traps%3A-Working-with-Recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
http://bytes.com/topic/access/insights/582742-access-vba-dao-recordset-loop-using-two-recordsets
use dao
Dim db As Database
Dim rs1, rs2 As Recordset
Dim n, X, y, z As Integer
Dim xsql1, xsql2 As String
Dim xprevious, xtext As String
xsql1 = "2wklyreport"
xsql2 = "BudgetsQ"
xsql3 = "dELIVERABLES"
xnewline = "<br/>" & vbCrLf
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1, dbOpenDynaset)
Set rs2 = db.OpenRecordset(xsql2, dbOpenDynaset)
Set rs1 = CurrentDb.OpenRecordset(xsql1)
Set rs2 = CurrentDb.OpenRecordset(xsql2)
Dim db As DAO.Database
Dim rs1 As DAO.Recordset
Dim rs2 As DAO.Recordset
Set db = CurrentDb()
Set rs1 = db.OpenRecordset(xsql1)
Set rs2 = db.OpenRecordset(xsql2)
Set rs3 = db.OpenRecordset(xsql3)
X = X & vbCrLf & "<html><head><style>"
X = X & vbCrLf & "BODY { color: BLACK;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H1 { color: BROWN;  text-align: left; font-size: 13pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H2 { color: BROWN;  text-align: left; font-size: 12pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H3 { color: BROWN;  text-align: left; font-size: 11pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "TD { text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "H4 { background-color: red; color: BROWN;  text-align: left; font-size: 9pt; font-family: verdana; arial;  }"
X = X & vbCrLf & "table { border-collapse: collapse; border: 1px solid black;}"
X = X & vbCrLf & "@media print {"
X = X & vbCrLf & "    h1 {page-break-before: always;}"
X = X & vbCrLf & "}"
X = X & vbCrLf & "</style></head><body>"
INDEXF = 2 ' E2ND FIELD IS THE INDEX
xaname = UCase(rs1.Fields(INDEXF).Value)
rs1.MoveFirst
For x = 0 To rs1.Fields.Count - 1
        Debug.Print x, rs1.Fields(x).name, rs1.Fields(x).Value
Next x
prev_xtext1 = ""
prev_xtext2 = ""
topheaderdata = X ' hold this in a variable that we will call later to add to the top
Do While Not rs1.EOF
        X = "" ' now start blank for each work-stream
        xaname = UCase(rs1.Fields(INDEXF).Value)
        xtitle = UCase(rs1.Fields(INDEXF).Value)
        X = X & vbCrLf & "<p/><a name=" & xaname & ">"
        
        
        xshortname = rs1!ShortName
        xtext1 = rs1!OWNER
        xtext2 = rs1!WORKSTREAM
        xContents = rs1!Contents
        xapproach = rs1!Approach
        xmemo = rs1!Memo
        xrisksummary = rs1!RiskSummary
        
        
        
        
        X = X & xnewline & "<h1>" & UCase("WORK-STREAM " & xtext2) & "</h1>" & xnewline
        ' x = x & "=============================================================================== " & xnewline
        X = X & xnewline & tCase("Work-Stream Owner: ") & (xtext1) & xnewline
        X = X & xnewline & tCase("Contents: ") & (xContents) & xnewline
        X = X & xnewline & tCase("Approach: ") & (xapproach) & xnewline
        X = X & xnewline & tCase("Memo: ") & (xmemo) & xnewline
        X = X & xnewline & tCase("Risk Summary: ") & (xrisksummary) & xnewline
        
        X = X & xnewline & tCase("RAG: ") & RAG(UCase(rs1.Fields(7).Value)) & " " & rs1.Fields(8).Value & xnewline
        
        
        If FLAG_SEEKFEEDBACK = "NO" Then
                
                X = X & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
                xlink = xshortname
                xlink = Replace(xlink, "&", "_")
                xlink = Replace(xlink, " ", "_")
                xlink = Replace(xlink, " ", "%20")
                X = X & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
                
        End If
        
        
        
        
        flag_listbudgets = "no"
        If flag_listbudgets = "YES" Then '#########################
                TABLENAME = "HTML_Budgets"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                X = X & xnewline & tCase("BUDGETS") & xnewline
                
                X = X & xnewline & "With the various acquisition streams ongoing, this is just a reminder to advise that various invoices for professional services, travel, accommodation etc should be coded to nominal code 7740 for now, at least until such time as we own any new XZXZXZ and, from there, separate cost centres/nominal codes will be opened in due course."
                X = X & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If 'flag_listbudgets = "YES" Then '#########################
        
        
        
        flagxDeliverables = "no"
        If flagxDeliverables = "YES" Then  '#########################
                TABLENAME = "HTML_DELIVERABLES"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                X = X & xnewline & tCase("DELIVERABLES") & xnewline
                X = X & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If 'flag = Deliverables = "YES" Then '#########################
        
        
        flag_listsky = "no"
        If flag_listsky = "YES" Then '#########################
                TABLENAME = "HTML_progress"
                FIRSTCOLUMNMATCH = xshortname ' "Legal&Contracts"
                X = X & xnewline & tCase("PROGRESS") & xnewline
                X = X & GETTABLE_2HTML(TABLENAME, FIRSTCOLUMNMATCH)
        End If ''################################################
        
        '   x = x & "<b><p style='color: red; font-size: 15px;'> Use this link to send an update to Project Manager... "
        xlink = xshortname
        xlink = Replace(xlink, "&", "_")
        xlink = Replace(xlink, " ", "_")
        xlink = Replace(xlink, " ", "%20")
        ' x = x & "<a href=mailto:Tim.XZXZXZ@XZXZXZ.Cloud?subject='PROJECTUPDATE_" & xlink & "'> Tim.XZXZXZ@XZXZXZ.Cloud</a> 0XZXZXZXZXZXZ051 </b></p>"
        
        
        
        X = X & xnewline
        '  x = x & "<br/><a href=#TOC>Go Top Table of Contents</a><HR/>"
        
        
        ################################
        
        wscount = wscount + 1
        xfilename = xshortname
        xfilename = Replace(xfilename, " ", "")
        xfilename = Replace(xfilename, "\", "")
        xfilename = Replace(xfilename, "&", "")
        xfilename = Replace(xfilename, ")", "")
        xfilename = Replace(xfilename, "(", "")
        If XFLAG = "ws" Then
                fname = CurrentProject.path & "\WORK-STREAM " & xfilename & ".html"
                Call PRINT_INFO(xtext, fname)
                ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        End If
        
        fulltext = fulltext & X
        X = ""
        ################################
        
        
        
        rs1.MoveNext
        Loop
        
        fulltext = topheaderdata & fulltext ' add header data to the front!
        
        
        XDATE = Format(Now, "DDD-DD-MMM-YYYY")
        fname = CurrentProject.path & "\PROJECT_LOGAN_SHORT_" & XDATE & ".html"
        Call PRINT_INFO(fulltext, fname)
        
        
        ReturnValue = Shell("explorer.EXE " & fname, 1)  ' Run Calculator.
        
        
        
        rs1.Close
        rs2.Close
        rs3.Close
        Set rs1 = Nothing
        Set rs2 = Nothing
        Set rs3 = Nothing
        
        db.Close
        Set db = Nothing
        
End Sub
 
 
########################################
The code is provided "as is", without warranty of any kind, express or implied, 
In no event shall the author be responsible for loss or damages arising from the installation or use of the code.
The entire risk as to the quality and performance of the code is borne by you.
You are obliged to review, test and generally assert that the code is OK.
########################################
Function tCase(X)
tCase = UCase("<b style='color:  #1ac6ff;'>" & X & "</b>")
tCase = UCase("<b style='color: BROWN;'>" & X & "</b>")
End Function
Attribute VB_Name = "button_adddate"
Option Compare Database
Private Sub Commandxx_Click()
screen.activeForm.recordset.fields(myFieldname).value
Screen.ActiveForm.Controls(myControl).Value
Screen.ActiveForm.name
value = Forms![NameOfForm]![NameOfTextbox]
x = Forms![NameOfForm]![NameOfTextbox]
x = Forms![workstreamstabs]![Memo]
x = Me.Memo.Value
x = InputBox(x, x, x)
xdate = Format(Now, "ddd dd/mmm/yy")
Me.Memo.Value = xdate & vbCrLf & x
End Sub
